import{s as xe,r as Ht,v as Bt,w as Lt,x as Nt,j as me,l as Pe,i as z,d as h,S as Gl,T as $t,U as Hn,B as _e,e as v,c as b,a as w,a1 as Wt,W as Sl,u as ce,F as zt,I as dl,n as De,G as el,q as wl,t as ge,k as Z,b as pe,o as q,f as u,g,h as ye,A as qe,y as Ne,z as ze,E as Me,p as bt,H as xt,Z as Mt,N as Be,L as nl,C as Zt,D as Bn,J as Wl,K as ds,X as ls,m as Zn}from"./scheduler.zIJcXxfw.js";import{S as Je,i as Ge,t as N,a as O,g as Re,c as Fe,j as Ln,h as Yl,k as Ql,f as He,b as ee,d as te,m as le,e as se}from"./index.AJ44Rmxa.js";import{g as qn}from"./globals.D0QH3NT1.js";import{e as it}from"./each.HbMn3P7n.js";import{t as Ce}from"./Toaster.svelte_svelte_type_style_lang.DWI_AZqd.js";import{ar as Nn,as as xl,M as xn,at as Jn}from"./Messages.BThsWIgy.js";import"./dayjs.min.CnqrW7zs.js";import{g as es}from"./entry.HyZcGm8Y.js";import{p as Gn}from"./stores.LxjvcvTP.js";import{d as Tl,j as Xt,s as Kl,p as Qn,n as Kn,m as Ol,t as zn,u as Ul,k as Yn,g as zl,F as Cl,b as Xn,S as $n,y as er,W as On,h as bl,E as tr,f as lr,r as vl,l as sr,e as nr,z as rr,v as Il}from"./index.BlPo-5sI.js";import{i as ss,m as Un,r as Jl,n as hs,v as ms,p as gs,s as or,o as Zl,h as ps,a as ar}from"./index.1jiXGYy7.js";import{i as ir}from"./index.BuGb5Ku-.js";import{A as cr,F as _s,z as fr,h as Dl,G as vs,u as ql,i as ur,b as dr}from"./index.KWDESXdp.js";import{g as hr}from"./index.DRRuDB0c.js";import{j as mr,k as gr,u as pr,p as _r,l as vr}from"./index.BsdtdtZU.js";import{T as br,S as wr,U as kr,q as yr}from"./ShareChatModal.BsH6n_Rj.js";import{r as Er,s as Ir,t as Dr,v as Cr,w as Sr,x as Tr}from"./index.D-TpH5T8.js";import{f as bs,a as Vr,s as Mr}from"./index.BbHaT6Pr.js";import{t as ns,s as Hr}from"./index.D2fPfxeh.js";import{T as qt}from"./create.BkENi-Q3.js";import{D as Xl,M as ul}from"./Dropdown.Bsd5GRU4.js";import{s as Br,c as Lr,u as Nr,d as zr,b as $l}from"./menu-trigger.d_cHHEjg.js";import{f as Al}from"./index.DMdt0oYD.js";import{S as An}from"./Switch.Bz8CV0ru.js";import{A as Or}from"./AddFilesPlaceholder.CjWnPv-f.js";import{S as Ur}from"./Selector.-MACWkeu.js";import{d as Ar}from"./index.CPPrZiJ5.js";import{g as Vl}from"./spread.CgU5AtxT.js";import{c as Pn,d as Pr}from"./updater.C94odJM1.js";import{f as jr}from"./FileSaver.min.CimDdHIv.js";import{b as Rr}from"./index.DWf48Tvu.js";import{M as Fr}from"./MenuLines.BbMCYX1Y.js";import{M as Wr}from"./Modal.Q0e3-D_j.js";import{A as Zr}from"./AdvancedParams.C38V2gu_.js";import{i as qr,j as xr,k as Jr}from"./index.BirtWV16.js";import{j as Gr,k as Qr,l as Kr}from"./index.CzhksGSZ.js";import{S as Yr}from"./Spinner.DEe0YHJH.js";import{V as Xr}from"./Valves.D0fH_Vdb.js";import{C as $r}from"./ConfirmDialog.DCTASMsl.js";const eo=n=>({subIds:n&1}),ws=n=>({subIds:n[0]});function to(n){let e;const t=n[6].default,l=Ht(t,n,n[5],ws);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,[o]){l&&l.p&&(!e||o&33)&&Bt(l,t,s,s[5],e?Nt(t,s[5],o,eo):Lt(s[5]),ws)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function lo(n,e,t){let l,{$$slots:s={},$$scope:o}=e,{disabled:r=void 0}=e,{open:i=void 0}=e,{onOpenChange:a=void 0}=e;const{updateOption:c,ids:f,states:{subOpen:d}}=Br({disabled:r,onOpenChange:({next:p})=>(i!==p&&(a==null||a(p),t(2,i=p)),p)}),m=Ar([f.menu,f.trigger],([p,k])=>({menu:p,trigger:k}));return me(n,m,p=>t(0,l=p)),n.$$set=p=>{"disabled"in p&&t(3,r=p.disabled),"open"in p&&t(2,i=p.open),"onOpenChange"in p&&t(4,a=p.onOpenChange),"$$scope"in p&&t(5,o=p.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&i!==void 0&&d.set(i),n.$$.dirty&8&&c("disabled",r)},[l,m,i,r,a,o,s]}class so extends Je{constructor(e){super(),Ge(this,e,lo,to,xe,{disabled:3,open:2,onOpenChange:4})}}const no=n=>({builder:n[0]&256}),ks=n=>({builder:n[8]}),ro=n=>({builder:n[0]&256}),ys=n=>({builder:n[8]}),oo=n=>({builder:n[0]&256}),Es=n=>({builder:n[8]}),ao=n=>({builder:n[0]&256}),Is=n=>({builder:n[8]}),io=n=>({builder:n[0]&256}),Ds=n=>({builder:n[8]}),co=n=>({builder:n[0]&256}),Cs=n=>({builder:n[8]});function fo(n){let e,t,l,s;const o=n[28].default,r=Ht(o,n,n[27],ks);let i=[n[8],n[13]],a={};for(let c=0;c<i.length;c+=1)a=$t(a,i[c]);return{c(){e=v("div"),r&&r.c(),this.h()},l(c){e=b(c,"DIV",{});var f=w(e);r&&r.l(f),f.forEach(h),this.h()},h(){Wt(e,a)},m(c,f){z(c,e,f),r&&r.m(e,null),n[33](e),t=!0,l||(s=[Sl(n[8].action(e)),ce(e,"m-focusout",n[12]),ce(e,"m-keydown",n[12]),ce(e,"m-pointermove",n[12])],l=!0)},p(c,f){r&&r.p&&(!t||f[0]&134217984)&&Bt(r,o,c,c[27],t?Nt(o,c[27],f,no):Lt(c[27]),ks),Wt(e,a=Vl(i,[f[0]&256&&c[8],f[0]&8192&&c[13]]))},i(c){t||(N(r,c),t=!0)},o(c){O(r,c),t=!1},d(c){c&&h(e),r&&r.d(c),n[33](null),l=!1,zt(s)}}}function uo(n){let e,t,l,s,o;const r=n[28].default,i=Ht(r,n,n[27],ys);let a=[n[8],n[13]],c={};for(let f=0;f<a.length;f+=1)c=$t(c,a[f]);return{c(){e=v("div"),i&&i.c(),this.h()},l(f){e=b(f,"DIV",{});var d=w(e);i&&i.l(d),d.forEach(h),this.h()},h(){Wt(e,c)},m(f,d){z(f,e,d),i&&i.m(e,null),n[32](e),l=!0,s||(o=[Sl(n[8].action(e)),ce(e,"m-focusout",n[12]),ce(e,"m-keydown",n[12]),ce(e,"m-pointermove",n[12])],s=!0)},p(f,d){n=f,i&&i.p&&(!l||d[0]&134217984)&&Bt(i,r,n,n[27],l?Nt(r,n[27],d,ro):Lt(n[27]),ys),Wt(e,c=Vl(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(f){l||(N(i,f),t&&t.end(1),l=!0)},o(f){O(i,f),f&&(t=Ln(e,n[5],n[6])),l=!1},d(f){f&&h(e),i&&i.d(f),n[32](null),f&&t&&t.end(),s=!1,zt(o)}}}function ho(n){let e,t,l,s,o;const r=n[28].default,i=Ht(r,n,n[27],Es);let a=[n[8],n[13]],c={};for(let f=0;f<a.length;f+=1)c=$t(c,a[f]);return{c(){e=v("div"),i&&i.c(),this.h()},l(f){e=b(f,"DIV",{});var d=w(e);i&&i.l(d),d.forEach(h),this.h()},h(){Wt(e,c)},m(f,d){z(f,e,d),i&&i.m(e,null),n[31](e),l=!0,s||(o=[Sl(n[8].action(e)),ce(e,"m-focusout",n[12]),ce(e,"m-keydown",n[12]),ce(e,"m-pointermove",n[12])],s=!0)},p(f,d){n=f,i&&i.p&&(!l||d[0]&134217984)&&Bt(i,r,n,n[27],l?Nt(r,n[27],d,oo):Lt(n[27]),Es),Wt(e,c=Vl(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(f){l||(N(i,f),f&&(t||dl(()=>{t=Yl(e,n[3],n[4]),t.start()})),l=!0)},o(f){O(i,f),l=!1},d(f){f&&h(e),i&&i.d(f),n[31](null),s=!1,zt(o)}}}function mo(n){let e,t,l,s,o,r;const i=n[28].default,a=Ht(i,n,n[27],Is);let c=[n[8],n[13]],f={};for(let d=0;d<c.length;d+=1)f=$t(f,c[d]);return{c(){e=v("div"),a&&a.c(),this.h()},l(d){e=b(d,"DIV",{});var m=w(e);a&&a.l(m),m.forEach(h),this.h()},h(){Wt(e,f)},m(d,m){z(d,e,m),a&&a.m(e,null),n[30](e),s=!0,o||(r=[Sl(n[8].action(e)),ce(e,"m-focusout",n[12]),ce(e,"m-keydown",n[12]),ce(e,"m-pointermove",n[12])],o=!0)},p(d,m){n=d,a&&a.p&&(!s||m[0]&134217984)&&Bt(a,i,n,n[27],s?Nt(i,n[27],m,ao):Lt(n[27]),Is),Wt(e,f=Vl(c,[m[0]&256&&n[8],m[0]&8192&&n[13]]))},i(d){s||(N(a,d),d&&dl(()=>{s&&(l&&l.end(1),t=Yl(e,n[3],n[4]),t.start())}),s=!0)},o(d){O(a,d),t&&t.invalidate(),d&&(l=Ln(e,n[5],n[6])),s=!1},d(d){d&&h(e),a&&a.d(d),n[30](null),d&&l&&l.end(),o=!1,zt(r)}}}function go(n){let e,t,l,s,o;const r=n[28].default,i=Ht(r,n,n[27],Ds);let a=[n[8],n[13]],c={};for(let f=0;f<a.length;f+=1)c=$t(c,a[f]);return{c(){e=v("div"),i&&i.c(),this.h()},l(f){e=b(f,"DIV",{});var d=w(e);i&&i.l(d),d.forEach(h),this.h()},h(){Wt(e,c)},m(f,d){z(f,e,d),i&&i.m(e,null),n[29](e),l=!0,s||(o=[Sl(n[8].action(e)),ce(e,"m-focusout",n[12]),ce(e,"m-keydown",n[12]),ce(e,"m-pointermove",n[12])],s=!0)},p(f,d){n=f,i&&i.p&&(!l||d[0]&134217984)&&Bt(i,r,n,n[27],l?Nt(r,n[27],d,io):Lt(n[27]),Ds),Wt(e,c=Vl(a,[d[0]&256&&n[8],d[0]&8192&&n[13]]))},i(f){l||(N(i,f),f&&dl(()=>{l&&(t||(t=Ql(e,n[1],n[2],!0)),t.run(1))}),l=!0)},o(f){O(i,f),f&&(t||(t=Ql(e,n[1],n[2],!1)),t.run(0)),l=!1},d(f){f&&h(e),i&&i.d(f),n[29](null),f&&t&&t.end(),s=!1,zt(o)}}}function po(n){let e;const t=n[28].default,l=Ht(t,n,n[27],Cs);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o[0]&134217984)&&Bt(l,t,s,s[27],e?Nt(t,s[27],o,co):Lt(s[27]),Cs)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function _o(n){let e,t,l,s;const o=[po,go,mo,ho,uo,fo],r=[];function i(a,c){return a[7]&&a[9]?0:a[1]&&a[9]?1:a[3]&&a[5]&&a[9]?2:a[3]&&a[9]?3:a[5]&&a[9]?4:a[9]?5:-1}return~(e=i(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),l=Pe()},l(a){t&&t.l(a),l=Pe()},m(a,c){~e&&r[e].m(a,c),z(a,l,c),s=!0},p(a,c){let f=e;e=i(a),e===f?~e&&r[e].p(a,c):(t&&(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe()),~e?(t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l)):t=null)},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),~e&&r[e].d(a)}}}function vo(n,e,t){let l;const s=["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"];let o=Gl(e,s),r,i,{$$slots:a={},$$scope:c}=e,{transition:f=void 0}=e,{transitionConfig:d=void 0}=e,{inTransition:m=void 0}=e,{inTransitionConfig:p=void 0}=e,{outTransition:k=void 0}=e,{outTransitionConfig:D=void 0}=e,{asChild:_=!1}=e,{id:S=void 0}=e,{side:E="right"}=e,{align:B="start"}=e,{sideOffset:y=0}=e,{alignOffset:L=0}=e,{collisionPadding:V=8}=e,{avoidCollisions:U=!0}=e,{collisionBoundary:M=void 0}=e,{sameWidth:I=!1}=e,{fitViewport:C=!1}=e,{strategy:W="absolute"}=e,{overlap:R=!1}=e,{el:A=void 0}=e;const{elements:{subMenu:j},states:{subOpen:G},ids:x,getAttrs:F}=Lr();me(n,j,J=>t(26,r=J)),me(n,G,J=>t(9,i=J));const ie=Pn(),be=F("sub-content");function Ie(J){_e[J?"unshift":"push"](()=>{A=J,t(0,A)})}function Y(J){_e[J?"unshift":"push"](()=>{A=J,t(0,A)})}function oe(J){_e[J?"unshift":"push"](()=>{A=J,t(0,A)})}function lt(J){_e[J?"unshift":"push"](()=>{A=J,t(0,A)})}function Ue(J){_e[J?"unshift":"push"](()=>{A=J,t(0,A)})}return n.$$set=J=>{e=$t($t({},e),Hn(J)),t(13,o=Gl(e,s)),"transition"in J&&t(1,f=J.transition),"transitionConfig"in J&&t(2,d=J.transitionConfig),"inTransition"in J&&t(3,m=J.inTransition),"inTransitionConfig"in J&&t(4,p=J.inTransitionConfig),"outTransition"in J&&t(5,k=J.outTransition),"outTransitionConfig"in J&&t(6,D=J.outTransitionConfig),"asChild"in J&&t(7,_=J.asChild),"id"in J&&t(14,S=J.id),"side"in J&&t(15,E=J.side),"align"in J&&t(16,B=J.align),"sideOffset"in J&&t(17,y=J.sideOffset),"alignOffset"in J&&t(18,L=J.alignOffset),"collisionPadding"in J&&t(19,V=J.collisionPadding),"avoidCollisions"in J&&t(20,U=J.avoidCollisions),"collisionBoundary"in J&&t(21,M=J.collisionBoundary),"sameWidth"in J&&t(22,I=J.sameWidth),"fitViewport"in J&&t(23,C=J.fitViewport),"strategy"in J&&t(24,W=J.strategy),"overlap"in J&&t(25,R=J.overlap),"el"in J&&t(0,A=J.el),"$$scope"in J&&t(27,c=J.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&S&&x.menu.set(S),n.$$.dirty[0]&67108864&&t(8,l=r),n.$$.dirty[0]&256&&Object.assign(l,be),n.$$.dirty[0]&67076096&&Nr({side:E,align:B,sideOffset:y,alignOffset:L,collisionPadding:V,avoidCollisions:U,collisionBoundary:M,sameWidth:I,fitViewport:C,strategy:W,overlap:R})},[A,f,d,m,p,k,D,_,l,i,j,G,ie,o,S,E,B,y,L,V,U,M,I,C,W,R,r,c,a,Ie,Y,oe,lt,Ue]}class bo extends Je{constructor(e){super(),Ge(this,e,vo,_o,xe,{transition:1,transitionConfig:2,inTransition:3,inTransitionConfig:4,outTransition:5,outTransitionConfig:6,asChild:7,id:14,side:15,align:16,sideOffset:17,alignOffset:18,collisionPadding:19,avoidCollisions:20,collisionBoundary:21,sameWidth:22,fitViewport:23,strategy:24,overlap:25,el:0},null,[-1,-1])}}const wo=n=>({builder:n&4}),Ss=n=>({builder:n[2]}),ko=n=>({builder:n&4}),Ts=n=>({builder:n[2]});function yo(n){let e,t,l,s;const o=n[13].default,r=Ht(o,n,n[12],Ss);let i=[n[2],n[6]],a={};for(let c=0;c<i.length;c+=1)a=$t(a,i[c]);return{c(){e=v("div"),r&&r.c(),this.h()},l(c){e=b(c,"DIV",{});var f=w(e);r&&r.l(f),f.forEach(h),this.h()},h(){Wt(e,a)},m(c,f){z(c,e,f),r&&r.m(e,null),n[14](e),t=!0,l||(s=[Sl(n[2].action(e)),ce(e,"m-click",n[5]),ce(e,"m-focusin",n[5]),ce(e,"m-focusout",n[5]),ce(e,"m-keydown",n[5]),ce(e,"m-pointerleave",n[5]),ce(e,"m-pointermove",n[5])],l=!0)},p(c,f){r&&r.p&&(!t||f&4100)&&Bt(r,o,c,c[12],t?Nt(o,c[12],f,wo):Lt(c[12]),Ss),Wt(e,a=Vl(i,[f&4&&c[2],f&64&&c[6]]))},i(c){t||(N(r,c),t=!0)},o(c){O(r,c),t=!1},d(c){c&&h(e),r&&r.d(c),n[14](null),l=!1,zt(s)}}}function Eo(n){let e;const t=n[13].default,l=Ht(t,n,n[12],Ts);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&4100)&&Bt(l,t,s,s[12],e?Nt(t,s[12],o,ko):Lt(s[12]),Ts)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function Io(n){let e,t,l,s;const o=[Eo,yo],r=[];function i(a,c){return a[1]?0:1}return e=i(n),t=r[e]=o[e](n),{c(){t.c(),l=Pe()},l(a){t.l(a),l=Pe()},m(a,c){r[e].m(a,c),z(a,l,c),s=!0},p(a,[c]){let f=e;e=i(a),e===f?r[e].p(a,c):(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l))},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),r[e].d(a)}}}function Do(n,e,t){let l,s;const o=["disabled","asChild","id","el"];let r=Gl(e,o),i,a,{$$slots:c={},$$scope:f}=e,{disabled:d=!1}=e,{asChild:m=!1}=e,{id:p=void 0}=e,{el:k=void 0}=e;const{elements:{subTrigger:D},ids:_,getAttrs:S,options:E}=zr();me(n,D,V=>t(11,a=V));const{disabled:B}=E;me(n,B,V=>t(10,i=V));const y=Pn();function L(V){_e[V?"unshift":"push"](()=>{k=V,t(0,k)})}return n.$$set=V=>{e=$t($t({},e),Hn(V)),t(6,r=Gl(e,o)),"disabled"in V&&t(7,d=V.disabled),"asChild"in V&&t(1,m=V.asChild),"id"in V&&t(8,p=V.id),"el"in V&&t(0,k=V.el),"$$scope"in V&&t(12,f=V.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&p&&_.trigger.set(p),n.$$.dirty&2048&&t(2,l=a),n.$$.dirty&1152&&t(9,s={...S("sub-trigger"),...Pr(d||i)}),n.$$.dirty&516&&Object.assign(l,s)},[k,m,l,D,B,y,r,d,p,s,i,a,f,c,L]}class Co extends Je{constructor(e){super(),Ge(this,e,Do,Io,xe,{disabled:7,asChild:1,id:8,el:0})}}function So(n){let e,t,l,s,o,r,i;return a(),{feed:c,reset:a};function a(){e=!0,t="",l=0,s=-1,o=void 0,r=void 0,i=""}function c(d){t=t?t+d:d,e&&To(t)&&(t=t.slice(jn.length)),e=!1;const m=t.length;let p=0,k=!1;for(;p<m;){k&&(t[p]===`
`&&++p,k=!1);let D=-1,_=s,S;for(let E=l;D<0&&E<m;++E)S=t[E],S===":"&&_<0?_=E-p:S==="\r"?(k=!0,D=E-p):S===`
`&&(D=E-p);if(D<0){l=m-p,s=_;break}else l=0,s=-1;f(t,p,_,D),p+=D+1}p===m?t="":p>0&&(t=t.slice(p))}function f(d,m,p,k){if(k===0){i.length>0&&(n({type:"event",id:o,event:r||void 0,data:i.slice(0,-1)}),i="",o=void 0),r=void 0;return}const D=p<0,_=d.slice(m,m+(D?k:p));let S=0;D?S=k:d[m+p+1]===" "?S=p+2:S=p+1;const E=m+S,B=k-S,y=d.slice(E,E+B).toString();if(_==="data")i+=y?"".concat(y,`
`):`
`;else if(_==="event")r=y;else if(_==="id"&&!y.includes("\0"))o=y;else if(_==="retry"){const L=parseInt(y,10);Number.isNaN(L)||n({type:"reconnect-interval",value:L})}}}const jn=[239,187,191];function To(n){return jn.every((e,t)=>n.charCodeAt(t)===e)}class Vo extends TransformStream{constructor(){let e;super({start(t){e=So(l=>{l.type==="event"&&t.enqueue(l)})},transform(t){e.feed(t)}})}}async function Vs(n,e){const t=n.pipeThrough(new TextDecoderStream).pipeThrough(new Vo).getReader();let l=Mo(t);return e&&(l=Ho(l)),l}async function*Mo(n){var e,t,l;for(;;){const{value:s,done:o}=await n.read();if(o){yield{done:!0,value:""};break}if(!s)continue;const r=s.data;if(r.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const i=JSON.parse(r);if(console.log(i),i.error){yield{done:!0,value:"",error:i.error};break}if(i.citations){yield{done:!1,value:"",citations:i.citations};continue}yield{done:!1,value:((l=(t=(e=i.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:l.content)??"",usage:i.usage}}catch(i){console.error("Error extracting delta from SSE event:",i)}}}async function*Ho(n){for await(const e of n){if(e.done){yield e;return}if(e.citations){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const l=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,l)},(document==null?void 0:document.visibilityState)!=="hidden"&&await Bo(5),t=t.slice(l)}}}const Bo=n=>new Promise(e=>setTimeout(e,n));function Ms(n){let e,t=n[2]&&Hs(n);return{c(){t&&t.c(),e=Pe()},l(l){t&&t.l(l),e=Pe()},m(l,s){t&&t.m(l,s),z(l,e,s)},p(l,s){l[2]?t?(t.p(l,s),s&4&&N(t,1)):(t=Hs(l),t.c(),N(t,1),t.m(e.parentNode,e)):t&&(Re(),O(t,1,1,()=>{t=null}),Fe())},d(l){l&&h(e),t&&t.d(l)}}}function Hs(n){let e,t,l,s,o=n[1].type+"",r,i,a,c,f,d=n[1].content+"",m,p,k,D,_,S,E=n[1].url&&Bs(),B=n[1].url&&Ls(),y=n[1].dismissible&&Ns(n);return{c(){e=v("div"),t=v("div"),l=v("div"),s=v("div"),r=ge(o),a=Z(),E&&E.c(),c=Z(),f=v("div"),m=ge(d),p=Z(),B&&B.c(),k=Z(),D=v("div"),y&&y.c(),this.h()},l(L){e=b(L,"DIV",{class:!0});var V=w(e);t=b(V,"DIV",{class:!0});var U=w(t);l=b(U,"DIV",{class:!0});var M=w(l);s=b(M,"DIV",{class:!0});var I=w(s);r=pe(I,o),I.forEach(h),a=q(M),E&&E.l(M),M.forEach(h),c=q(U),f=b(U,"DIV",{class:!0});var C=w(f);m=pe(C,d),C.forEach(h),U.forEach(h),p=q(V),B&&B.l(V),k=q(V),D=b(V,"DIV",{class:!0});var W=w(D);y&&y.l(W),W.forEach(h),V.forEach(h),this.h()},h(){u(s,"class",i="text-xs font-bold "+(n[3][n[1].type]??n[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"),u(l,"class","flex justify-between self-start"),u(f,"class","flex-1 text-xs text-gray-700 dark:text-white"),u(t,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),u(D,"class","flex self-start"),u(e,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30")},m(L,V){z(L,e,V),g(e,t),g(t,l),g(l,s),g(s,r),g(l,a),E&&E.m(l,null),g(t,c),g(t,f),g(f,m),g(e,p),B&&B.m(e,null),g(e,k),g(e,D),y&&y.m(D,null),S=!0},p(L,V){(!S||V&2)&&o!==(o=L[1].type+"")&&ye(r,o),(!S||V&2&&i!==(i="text-xs font-bold "+(L[3][L[1].type]??L[3].info)+" w-fit px-2 rounded uppercase line-clamp-1 mr-0.5"))&&u(s,"class",i),L[1].url?E||(E=Bs(),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!S||V&2)&&d!==(d=L[1].content+"")&&ye(m,d),L[1].url?B||(B=Ls(),B.c(),B.m(e,k)):B&&(B.d(1),B=null),L[1].dismissible?y?y.p(L,V):(y=Ns(L),y.c(),y.m(D,null)):y&&(y.d(1),y=null)},i(L){S||(L&&dl(()=>{S&&(_||(_=Ql(e,bs,{delay:100,duration:300},!0)),_.run(1))}),S=!0)},o(L){L&&(_||(_=Ql(e,bs,{delay:100,duration:300},!1)),_.run(0)),S=!1},d(L){L&&h(e),E&&E.d(),B&&B.d(),y&&y.d(),L&&_&&_.end()}}}function Bs(n){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=v("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-o2pz5m"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex md:hidden group w-fit md:items-center")},m(l,s){z(l,e,s)},d(l){l&&h(e)}}}function Ls(n){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=v("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-1wr7se3"&&(e.innerHTML=t),this.h()},h(){u(e,"class","hidden md:flex group w-fit md:items-center")},m(l,s){z(l,e,s)},d(l){l&&h(e)}}}function Ns(n){let e,t="Ã—",l,s;return{c(){e=v("button"),e.textContent=t,this.h()},l(o){e=b(o,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-o8kh4p"&&(e.textContent=t),this.h()},h(){u(e,"class","-mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white")},m(o,r){z(o,e,r),l||(s=ce(e,"click",n[5]),l=!0)},p:De,d(o){o&&h(e),l=!1,s()}}}function Lo(n){let e,t=!n[0]&&Ms(n);return{c(){t&&t.c(),e=Pe()},l(l){t&&t.l(l),e=Pe()},m(l,s){t&&t.m(l,s),z(l,e,s)},p(l,[s]){l[0]?t&&(t.d(1),t=null):t?t.p(l,s):(t=Ms(l),t.c(),t.m(e.parentNode,e))},i:De,o:De,d(l){l&&h(e),t&&t.d(l)}}}function No(n,e,t){const l=el();let{banner:s={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=e,{dismissed:o=!1}=e,r=!1;const i={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=f=>{t(0,o=!0),l("dismiss",f)};wl(()=>{t(2,r=!0)});const c=()=>{a(s.id)};return n.$$set=f=>{"banner"in f&&t(1,s=f.banner),"dismissed"in f&&t(0,o=f.dismissed)},[o,s,r,i,a,c]}class zo extends Je{constructor(e){super(),Ge(this,e,No,Lo,xe,{banner:1,dismissed:0})}}function Oo(n){let e,t,l;return{c(){e=Ne("svg"),t=Ne("path"),l=Ne("path"),this.h()},l(s){e=ze(s,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=w(e);t=ze(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),l=ze(o,"path",{d:!0}),w(l).forEach(h),o.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z"),u(t,"clip-rule","evenodd"),u(l,"d","M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class",n[0])},m(s,o){z(s,e,o),g(e,t),g(e,l)},p(s,[o]){o&1&&u(e,"class",s[0])},i:De,o:De,d(s){s&&h(e)}}}function Uo(n,e,t){let{className:l="size-4"}=e;return n.$$set=s=>{"className"in s&&t(0,l=s.className)},[l]}class Ao extends Je{constructor(e){super(),Ge(this,e,Uo,Oo,xe,{className:0})}}function Po(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=w(e);t=ze(s,"path",{d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"d","M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function jo(n,e,t){let{className:l="size-4"}=e;return n.$$set=s=>{"className"in s&&t(0,l=s.className)},[l]}class Ro extends Je{constructor(e){super(),Ge(this,e,jo,Po,xe,{className:0})}}function Fo(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=w(e);t=ze(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M12 6.75a5.25 5.25 0 0 1 6.775-5.025.75.75 0 0 1 .313 1.248l-3.32 3.319c.063.475.276.934.641 1.299.365.365.824.578 1.3.64l3.318-3.319a.75.75 0 0 1 1.248.313 5.25 5.25 0 0 1-5.472 6.756c-1.018-.086-1.87.1-2.309.634L7.344 21.3A3.298 3.298 0 1 1 2.7 16.657l8.684-7.151c.533-.44.72-1.291.634-2.309A5.342 5.342 0 0 1 12 6.75ZM4.117 19.125a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75h-.008a.75.75 0 0 1-.75-.75v-.008Z"),u(t,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function Wo(n,e,t){let{className:l="size-4"}=e;return n.$$set=s=>{"className"in s&&t(0,l=s.className)},[l]}class Zo extends Je{constructor(e){super(),Ge(this,e,Wo,Fo,xe,{className:0})}}function zs(n,e,t){const l=n.slice();return l[17]=e[t],l[18]=e,l[19]=t,l}function qo(n){let e;const t=n[9].default,l=Ht(t,n,n[16],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&65536)&&Bt(l,t,s,s[16],e?Nt(t,s[16],o,null):Lt(s[16]),null)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function xo(n){let e,t;return e=new qt({props:{content:n[7].t("More"),$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s&128&&(o.content=l[7].t("More")),s&65536&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Os(n){let e,t,l,s,o=it(Object.keys(n[1])),r=[];for(let a=0;a<o.length;a+=1)r[a]=Us(zs(n,o,a));const i=a=>O(r[a],1,1,()=>{r[a]=null});return{c(){e=v("div");for(let a=0;a<r.length;a+=1)r[a].c();t=Z(),l=v("hr"),this.h()},l(a){e=b(a,"DIV",{class:!0});var c=w(e);for(let f=0;f<r.length;f+=1)r[f].l(c);c.forEach(h),t=q(a),l=b(a,"HR",{class:!0}),this.h()},h(){u(e,"class","max-h-28 overflow-y-auto scrollbar-hidden"),u(l,"class","border-gray-100 dark:border-gray-800 my-1")},m(a,c){z(a,e,c);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);z(a,t,c),z(a,l,c),s=!0},p(a,c){if(c&3){o=it(Object.keys(a[1]));let f;for(f=0;f<o.length;f+=1){const d=zs(a,o,f);r[f]?(r[f].p(d,c),N(r[f],1)):(r[f]=Us(d),r[f].c(),N(r[f],1),r[f].m(e,null))}for(Re(),f=o.length;f<r.length;f+=1)i(f);Fe()}},i(a){if(!s){for(let c=0;c<o.length;c+=1)N(r[c]);s=!0}},o(a){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)O(r[c]);s=!1},d(a){a&&(h(e),h(t),h(l)),xt(r,a)}}}function Jo(n){let e,t=n[1][n[17]].name+"",l;return{c(){e=v("div"),l=ge(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);l=pe(o,t),o.forEach(h),this.h()},h(){u(e,"class","line-clamp-1")},m(s,o){z(s,e,o),g(e,l)},p(s,o){o&2&&t!==(t=s[1][s[17]].name+"")&&ye(l,t)},d(s){s&&h(e)}}}function Us(n){var k;let e,t,l,s,o,r,i,a,c,f;l=new Zo({}),o=new qt({props:{content:((k=n[1][n[17]])==null?void 0:k.description)??"",className:"flex-1",$$slots:{default:[Jo]},$$scope:{ctx:n}}});function d(D){n[10](D,n[17])}function m(...D){return n[11](n[17],...D)}let p={};return n[1][n[17]].enabled!==void 0&&(p.state=n[1][n[17]].enabled),i=new An({props:p}),_e.push(()=>He(i,"state",d)),i.$on("change",m),{c(){e=v("div"),t=v("div"),ee(l.$$.fragment),s=Z(),ee(o.$$.fragment),r=Z(),ee(i.$$.fragment),c=Z(),this.h()},l(D){e=b(D,"DIV",{class:!0});var _=w(e);t=b(_,"DIV",{class:!0});var S=w(t);te(l.$$.fragment,S),s=q(S),te(o.$$.fragment,S),S.forEach(h),r=q(_),te(i.$$.fragment,_),c=q(_),_.forEach(h),this.h()},h(){u(t,"class","flex-1 flex items-center gap-2"),u(e,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(D,_){z(D,e,_),g(e,t),le(l,t,null),g(t,s),le(o,t,null),g(e,r),le(i,e,null),g(e,c),f=!0},p(D,_){var B;n=D;const S={};_&2&&(S.content=((B=n[1][n[17]])==null?void 0:B.description)??""),_&65538&&(S.$$scope={dirty:_,ctx:n}),o.$set(S);const E={};!a&&_&2&&(a=!0,E.state=n[1][n[17]].enabled,Me(()=>a=!1)),i.$set(E)},i(D){f||(N(l.$$.fragment,D),N(o.$$.fragment,D),N(i.$$.fragment,D),f=!0)},o(D){O(l.$$.fragment,D),O(o.$$.fragment,D),O(i.$$.fragment,D),f=!1},d(D){D&&h(e),se(l),se(o),se(i)}}}function As(n){let e,t,l,s,o,r=n[7].t("Web Search")+"",i,a,c,f,d,m,p;l=new Ro({});function k(_){n[12](_)}let D={};return n[2]!==void 0&&(D.state=n[2]),c=new An({props:D}),_e.push(()=>He(c,"state",k)),{c(){e=v("div"),t=v("div"),ee(l.$$.fragment),s=Z(),o=v("div"),i=ge(r),a=Z(),ee(c.$$.fragment),d=Z(),m=v("hr"),this.h()},l(_){e=b(_,"DIV",{class:!0});var S=w(e);t=b(S,"DIV",{class:!0});var E=w(t);te(l.$$.fragment,E),s=q(E),o=b(E,"DIV",{class:!0});var B=w(o);i=pe(B,r),B.forEach(h),E.forEach(h),a=q(S),te(c.$$.fragment,S),S.forEach(h),d=q(_),m=b(_,"HR",{class:!0}),this.h()},h(){u(o,"class","line-clamp-1"),u(t,"class","flex-1 flex items-center gap-2"),u(e,"class","flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl"),u(m,"class","border-gray-100 dark:border-gray-800 my-1")},m(_,S){z(_,e,S),g(e,t),le(l,t,null),g(t,s),g(t,o),g(o,i),g(e,a),le(c,e,null),z(_,d,S),z(_,m,S),p=!0},p(_,S){(!p||S&128)&&r!==(r=_[7].t("Web Search")+"")&&ye(i,r);const E={};!f&&S&4&&(f=!0,E.state=_[2],Me(()=>f=!1)),c.$set(E)},i(_){p||(N(l.$$.fragment,_),N(c.$$.fragment,_),p=!0)},o(_){O(l.$$.fragment,_),O(c.$$.fragment,_),p=!1},d(_){_&&(h(e),h(d),h(m)),se(l),se(c)}}}function Go(n){let e,t,l,s=n[7].t("Upload Files")+"",o,r;return e=new Ao({}),{c(){ee(e.$$.fragment),t=Z(),l=v("div"),o=ge(s),this.h()},l(i){te(e.$$.fragment,i),t=q(i),l=b(i,"DIV",{class:!0});var a=w(l);o=pe(a,s),a.forEach(h),this.h()},h(){u(l,"class","line-clamp-1")},m(i,a){le(e,i,a),z(i,t,a),z(i,l,a),g(l,o),r=!0},p(i,a){(!r||a&128)&&s!==(s=i[7].t("Upload Files")+"")&&ye(o,s)},i(i){r||(N(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){i&&(h(t),h(l)),se(e,i)}}}function Qo(n){var a,c;let e=Object.keys(n[1]).length>0,t,l,s,o,r=e&&Os(n),i=((c=(a=n[6])==null?void 0:a.features)==null?void 0:c.enable_web_search)&&As(n);return s=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl",$$slots:{default:[Go]},$$scope:{ctx:n}}}),s.$on("click",n[13]),{c(){r&&r.c(),t=Z(),i&&i.c(),l=Z(),ee(s.$$.fragment)},l(f){r&&r.l(f),t=q(f),i&&i.l(f),l=q(f),te(s.$$.fragment,f)},m(f,d){r&&r.m(f,d),z(f,t,d),i&&i.m(f,d),z(f,l,d),le(s,f,d),o=!0},p(f,d){var p,k;d&2&&(e=Object.keys(f[1]).length>0),e?r?(r.p(f,d),d&2&&N(r,1)):(r=Os(f),r.c(),N(r,1),r.m(t.parentNode,t)):r&&(Re(),O(r,1,1,()=>{r=null}),Fe()),(k=(p=f[6])==null?void 0:p.features)!=null&&k.enable_web_search?i?(i.p(f,d),d&64&&N(i,1)):(i=As(f),i.c(),N(i,1),i.m(l.parentNode,l)):i&&(Re(),O(i,1,1,()=>{i=null}),Fe());const m={};d&65664&&(m.$$scope={dirty:d,ctx:f}),s.$set(m)},i(f){o||(N(r),N(i),N(s.$$.fragment,f),o=!0)},o(f){O(r),O(i),O(s.$$.fragment,f),o=!1},d(f){f&&(h(t),h(l)),r&&r.d(f),i&&i.d(f),se(s,f)}}}function Ko(n){let e,t,l;return t=new $l({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:Al,$$slots:{default:[Qo]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{slot:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"slot","content")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&65743&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function Yo(n){let e,t,l;function s(r){n[14](r)}let o={$$slots:{content:[Ko],default:[xo]},$$scope:{ctx:n}};return n[5]!==void 0&&(o.show=n[5]),e=new Xl({props:o}),_e.push(()=>He(e,"show",s)),e.$on("change",n[15]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,[i]){const a={};i&65743&&(a.$$scope={dirty:i,ctx:r}),!t&&i&32&&(t=!0,a.show=r[5],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function Xo(n,e,t){let l,s;me(n,Tl,y=>t(6,l=y));let{$$slots:o={},$$scope:r}=e;const i=bt("i18n");me(n,i,y=>t(7,s=y));let{uploadFilesHandler:a}=e,{selectedToolIds:c=[]}=e,{webSearchEnabled:f}=e,{tools:d={}}=e,{onClose:m}=e,p=!1;function k(y,L){n.$$.not_equal(d[L].enabled,y)&&(d[L].enabled=y,t(1,d),t(0,c))}const D=(y,L)=>{t(0,c=L.detail?[...c,y]:c.filter(V=>V!==y))};function _(y){f=y,t(2,f)}const S=()=>{a()};function E(y){p=y,t(5,p)}const B=y=>{y.detail===!1&&m()};return n.$$set=y=>{"uploadFilesHandler"in y&&t(3,a=y.uploadFilesHandler),"selectedToolIds"in y&&t(0,c=y.selectedToolIds),"webSearchEnabled"in y&&t(2,f=y.webSearchEnabled),"tools"in y&&t(1,d=y.tools),"onClose"in y&&t(4,m=y.onClose),"$$scope"in y&&t(16,r=y.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&t(1,d=Object.fromEntries(Object.keys(d).map(y=>[y,{...d[y],enabled:c.includes(y)}])))},[c,d,f,a,m,p,l,s,i,o,k,D,_,S,E,B,r]}class $o extends Je{constructor(e){super(),Ge(this,e,Xo,Yo,xe,{uploadFilesHandler:3,selectedToolIds:0,webSearchEnabled:2,tools:1,onClose:4})}}function ea(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=ze(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),u(t,"clip-rule","evenodd"),u(e,"aria-hidden","true"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","currentColor"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width",n[1]),u(e,"stroke","currentColor"),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&2&&u(e,"stroke-width",l[1]),s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function ta(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="0"}=e;return n.$$set=o=>{"className"in o&&t(0,l=o.className),"strokeWidth"in o&&t(1,s=o.strokeWidth)},[l,s]}class la extends Je{constructor(e){super(),Ge(this,e,ta,ea,xe,{className:0,strokeWidth:1})}}function Ps(n,e,t){const l=n.slice();return l[29]=e[t],l}function js(n){let e,t;return{c(){e=v("div"),this.h()},l(l){e=b(l,"DIV",{class:!0,style:!0}),w(e).forEach(h),this.h()},h(){u(e,"class",t="w-[2px] "+(n[0]?" bg-gray-500 dark:bg-gray-400   ":"bg-indigo-500 dark:bg-indigo-400  ")+" inline-block h-full"),Mt(e,"height",Math.min(100,Math.max(14,n[29]*100))+"%")},m(l,s){z(l,e,s)},p(l,s){s[0]&1&&t!==(t="w-[2px] "+(l[0]?" bg-gray-500 dark:bg-gray-400   ":"bg-indigo-500 dark:bg-indigo-400  ")+" inline-block h-full")&&u(e,"class",t),s[0]&4&&Mt(e,"height",Math.min(100,Math.max(14,l[29]*100))+"%")},d(l){l&&h(e)}}}function sa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path></svg>',l,s;return{c(){e=v("button"),e.innerHTML=t,this.h()},l(o){e=b(o,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-1qzkal"&&(e.innerHTML=t),this.h()},h(){u(e,"type","button"),u(e,"class","p-1.5 bg-indigo-500 text-white dark:bg-indigo-500 dark:text-blue-950 rounded-full")},m(o,r){z(o,e,r),l||(s=ce(e,"click",n[10]),l=!0)},p:De,d(o){o&&h(e),l=!1,s()}}}function na(n){let e,t=`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><style>.spinner_OSmW {
							transform-origin: center;
							animation: spinner_T6mA 0.75s step-end infinite;
						}
						@keyframes spinner_T6mA {
							8.3% {
								transform: rotate(30deg);
							}
							16.6% {
								transform: rotate(60deg);
							}
							25% {
								transform: rotate(90deg);
							}
							33.3% {
								transform: rotate(120deg);
							}
							41.6% {
								transform: rotate(150deg);
							}
							50% {
								transform: rotate(180deg);
							}
							58.3% {
								transform: rotate(210deg);
							}
							66.6% {
								transform: rotate(240deg);
							}
							75% {
								transform: rotate(270deg);
							}
							83.3% {
								transform: rotate(300deg);
							}
							91.6% {
								transform: rotate(330deg);
							}
							100% {
								transform: rotate(360deg);
							}
						}
					</style><g class="spinner_OSmW"><rect x="11" y="1" width="2" height="5" opacity=".14"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(30 12 12)" opacity=".29"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(60 12 12)" opacity=".43"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(90 12 12)" opacity=".57"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(120 12 12)" opacity=".71"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(150 12 12)" opacity=".86"></rect><rect x="11" y="1" width="2" height="5" transform="rotate(180 12 12)"></rect></g></svg>`;return{c(){e=v("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-otpw2s"&&(e.innerHTML=t),this.h()},h(){u(e,"class","text-gray-500 rounded-full cursor-not-allowed")},m(l,s){z(l,e,s)},p:De,d(l){l&&h(e)}}}function ra(n){let e,t,l,s,o,r,i,a,c,f,d,m,p=n[5](n[1])+"",k,D,_,S,E,B,y,L=it(n[2].slice().reverse()),V=[];for(let C=0;C<L.length;C+=1)V[C]=js(Ps(n,L,C));function U(C,W){return C[0]?na:sa}let M=U(n),I=M(n);return{c(){e=v("div"),t=v("div"),l=v("button"),s=Ne("svg"),o=Ne("path"),i=Z(),a=v("div"),c=v("div");for(let C=0;C<V.length;C+=1)V[C].c();f=Z(),d=v("div"),m=v("div"),k=ge(p),_=Z(),S=v("div"),I.c(),this.h()},l(C){e=b(C,"DIV",{class:!0});var W=w(e);t=b(W,"DIV",{class:!0});var R=w(t);l=b(R,"BUTTON",{type:!0,class:!0});var A=w(l);s=ze(A,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var j=w(s);o=ze(j,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(o).forEach(h),j.forEach(h),A.forEach(h),R.forEach(h),i=q(W),a=b(W,"DIV",{class:!0,dir:!0});var G=w(a);c=b(G,"DIV",{class:!0});var x=w(c);for(let Ie=0;Ie<V.length;Ie+=1)V[Ie].l(x);x.forEach(h),G.forEach(h),f=q(W),d=b(W,"DIV",{class:!0});var F=w(d);m=b(F,"DIV",{class:!0});var ie=w(m);k=pe(ie,p),ie.forEach(h),F.forEach(h),_=q(W),S=b(W,"DIV",{class:!0});var be=w(S);I.l(be),be.forEach(h),W.forEach(h),this.h()},h(){u(o,"stroke-linecap","round"),u(o,"stroke-linejoin","round"),u(o,"d","M6 18 18 6M6 6l12 12"),u(s,"xmlns","http://www.w3.org/2000/svg"),u(s,"fill","none"),u(s,"viewBox","0 0 24 24"),u(s,"stroke-width","3"),u(s,"stroke","currentColor"),u(s,"class","size-4"),u(l,"type","button"),u(l,"class",r="p-1.5 "+(n[0]?" bg-gray-200 dark:bg-gray-700/50":"bg-indigo-400/20 text-indigo-600 dark:text-indigo-300 ")+" rounded-full"),u(t,"class","flex items-center mr-1"),u(c,"class","flex-1 flex items-center gap-0.5 h-6"),u(a,"class","flex flex-1 self-center items-center justify-between ml-2 mx-1 overflow-hidden h-6"),u(a,"dir","rtl"),u(m,"class",D="text-sm "+(n[0]?" text-gray-500  dark:text-gray-400  ":" text-indigo-400 ")+" font-medium flex-1 mx-auto text-center"),u(d,"class","mx-1.5 pr-1 flex justify-center items-center"),u(S,"class","flex items-center mr-1"),u(e,"class",E=(n[0]?" bg-gray-100/50 dark:bg-gray-850/50":"bg-indigo-300/10 dark:bg-indigo-500/10 ")+" rounded-full flex p-2.5")},m(C,W){z(C,e,W),g(e,t),g(t,l),g(l,s),g(s,o),g(e,i),g(e,a),g(a,c);for(let R=0;R<V.length;R+=1)V[R]&&V[R].m(c,null);g(e,f),g(e,d),g(d,m),g(m,k),g(e,_),g(e,S),I.m(S,null),B||(y=ce(l,"click",n[9]),B=!0)},p(C,W){if(W[0]&1&&r!==(r="p-1.5 "+(C[0]?" bg-gray-200 dark:bg-gray-700/50":"bg-indigo-400/20 text-indigo-600 dark:text-indigo-300 ")+" rounded-full")&&u(l,"class",r),W[0]&5){L=it(C[2].slice().reverse());let R;for(R=0;R<L.length;R+=1){const A=Ps(C,L,R);V[R]?V[R].p(A,W):(V[R]=js(A),V[R].c(),V[R].m(c,null))}for(;R<V.length;R+=1)V[R].d(1);V.length=L.length}W[0]&2&&p!==(p=C[5](C[1])+"")&&ye(k,p),W[0]&1&&D!==(D="text-sm "+(C[0]?" text-gray-500  dark:text-gray-400  ":" text-indigo-400 ")+" font-medium flex-1 mx-auto text-center")&&u(m,"class",D),M===(M=U(C))&&I?I.p(C,W):(I.d(1),I=M(C),I&&(I.c(),I.m(S,null))),W[0]&1&&E!==(E=(C[0]?" bg-gray-100/50 dark:bg-gray-850/50":"bg-indigo-300/10 dark:bg-indigo-500/10 ")+" rounded-full flex p-2.5")&&u(e,"class",E)},i:De,o:De,d(C){C&&h(e),xt(V,C),I.d(),B=!1,y()}}}const Rs=300;function oa(n,e,t){let l,s,o;me(n,Xt,G=>t(18,s=G)),me(n,Tl,G=>t(19,o=G));const r=bt("i18n");me(n,r,G=>t(17,l=G));const i=el();let{recording:a=!1}=e,c=!1,f=!1,d=0,m=null,p="";const k=()=>{m=setInterval(()=>{t(1,d++,d)},1e3)},D=()=>{clearInterval(m),t(1,d=0)},_=G=>{const x=Math.floor(G/60),F=G%60,ie=F<10?`0${F}`:F;return`${x}:${ie}`};let S,E,B=[];const y=-45;let L=Array(Rs).fill(0);const V=G=>{let x=0;for(let F=0;F<G.length;F++){const ie=(G[F]-128)/128;x+=ie*ie}return Math.sqrt(x/G.length)},U=G=>{G=G*10;const F=Math.pow(G,1.5);return Math.min(1,Math.max(.01,F))},M=G=>{const x=new AudioContext,F=x.createMediaStreamSource(G),ie=x.createAnalyser();ie.minDecibels=y,F.connect(ie);const be=ie.frequencyBinCount,Ie=new Uint8Array(be),Y=new Uint8Array(ie.fftSize);(()=>{const lt=()=>{if(!(!a||c)){if(a&&!c){ie.getByteTimeDomainData(Y),ie.getByteFrequencyData(Ie);const Ue=V(Y);L.push(U(Ue)),L.length>=Rs&&L.shift(),t(2,L)}window.requestAnimationFrame(lt)}};window.requestAnimationFrame(lt)})()},I=async G=>{await Be();const x=ss(G,"recording.wav"),F=await ns(localStorage.token,x).catch(ie=>(Ce.error(ie),null));F&&(console.log(F.text),i("confirm",F.text))},C=async()=>{var x,F;k();const G=await navigator.mediaDevices.getUserMedia({audio:!0});if(E=new MediaRecorder(G),E.onstart=()=>{console.log("Recording started"),B=[],M(G)},E.ondataavailable=ie=>B.push(ie.data),E.onstop=async()=>{var ie,be;if(console.log("Recording stopped"),(((be=(ie=s==null?void 0:s.audio)==null?void 0:ie.stt)==null?void 0:be.engine)??"")==="web")B=[];else{if(f){const Ie=new Blob(B,{type:"audio/wav"});await I(Ie),f=!1,t(0,c=!1)}B=[],t(8,a=!1)}},E.start(),(o.audio.stt.engine==="web"||(((F=(x=s==null?void 0:s.audio)==null?void 0:x.stt)==null?void 0:F.engine)??"")==="web")&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){S=new(window.SpeechRecognition||window.webkitSpeechRecognition),S.continuous=!0;const ie=2e3;let be;S.start(),S.onresult=async Ie=>{var oe;clearTimeout(be),console.log(Ie);const Y=Ie.results[Object.keys(Ie.results).length-1][0].transcript;p=`${p}${Y}`,await Be(),(oe=document.getElementById("chat-textarea"))==null||oe.focus(),be=setTimeout(()=>{console.log("Speech recognition turned off due to inactivity."),S.stop()},ie)},S.onend=function(){console.log("recognition ended"),R(),i("confirm",p),f=!1,t(0,c=!1)},S.onerror=function(Ie){console.log(Ie),Ce.error(l.t("Speech recognition error: {{error}}",{error:Ie.error})),i("cancel"),W()}}},W=async()=>{a&&E&&await E.stop(),D(),B=[]},R=async()=>{t(0,c=!0),f=!0,a&&E&&await E.stop(),clearInterval(m)},A=async()=>{i("cancel"),W()},j=async()=>{await R()};return n.$$set=G=>{"recording"in G&&t(8,a=G.recording)},n.$$.update=()=>{n.$$.dirty[0]&256&&(a?C():W())},[c,d,L,r,i,_,W,R,a,A,j]}class aa extends Je{constructor(e){super(),Ge(this,e,oa,ra,xe,{recording:8},null,[-1,-1])}}function Fs(n){let e,t,l,s,o,r,i;return o=new Or({}),{c(){e=v("div"),t=v("div"),l=v("div"),s=v("div"),ee(o.$$.fragment),this.h()},l(a){e=b(a,"DIV",{class:!0,id:!0,role:!0,"aria-label":!0});var c=w(e);t=b(c,"DIV",{class:!0});var f=w(t);l=b(f,"DIV",{class:!0});var d=w(l);s=b(d,"DIV",{class:!0});var m=w(s);te(o.$$.fragment,m),m.forEach(h),d.forEach(h),f.forEach(h),c.forEach(h),this.h()},h(){u(s,"class","max-w-md"),u(l,"class","m-auto pt-64 flex flex-col justify-center"),u(t,"class","absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center"),u(e,"class",r="fixed "+(n[2]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" fixed top-0 right-0 bottom-0 w-full h-full flex z-[9999] touch-none pointer-events-none"),u(e,"id","dropzone"),u(e,"role","region"),u(e,"aria-label","Drag and Drop Container")},m(a,c){z(a,e,c),g(e,t),g(t,l),g(l,s),le(o,s,null),n[3](e),i=!0},p(a,c){(!i||c&4&&r!==(r="fixed "+(a[2]?"left-0 md:left-[260px] md:w-[calc(100%-260px)]":"left-0")+" fixed top-0 right-0 bottom-0 w-full h-full flex z-[9999] touch-none pointer-events-none"))&&u(e,"class",r)},i(a){i||(N(o.$$.fragment,a),i=!0)},o(a){O(o.$$.fragment,a),i=!1},d(a){a&&h(e),se(o),n[3](null)}}}function ia(n){let e,t,l=n[0]&&Fs(n);return{c(){l&&l.c(),e=Pe()},l(s){l&&l.l(s),e=Pe()},m(s,o){l&&l.m(s,o),z(s,e,o),t=!0},p(s,[o]){s[0]?l?(l.p(s,o),o&1&&N(l,1)):(l=Fs(s),l.c(),N(l,1),l.m(e.parentNode,e)):l&&(Re(),O(l,1,1,()=>{l=null}),Fe())},i(s){t||(N(l),t=!0)},o(s){O(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function ca(n,e,t){let l;me(n,Kl,i=>t(2,l=i));let{show:s=!1}=e,o=null;function r(i){_e[i?"unshift":"push"](()=>{o=i,t(1,o)})}return n.$$set=i=>{"show"in i&&t(0,s=i.show)},n.$$.update=()=>{n.$$.dirty&3&&(s&&o?(document.body.appendChild(o),document.body.style.overflow="hidden"):o&&(document.body.removeChild(o),document.body.style.overflow="unset"))},[s,o,l,r]}class fa extends Je{constructor(e){super(),Ge(this,e,ca,ia,xe,{show:0})}}function Ws(n,e,t){const l=n.slice();return l[0]=e[t],l[14]=t,l}function Zs(n){let e,t,l,s='<div class="text-lg font-semibold mt-2">/</div>',o,r,i,a,c,f,d='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',m,p,k=n[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",D,_=it(n[2]),S=[];for(let E=0;E<_.length;E+=1)S[E]=qs(Ws(n,_,E));return{c(){e=v("div"),t=v("div"),l=v("div"),l.innerHTML=s,o=Z(),r=v("div"),i=v("div");for(let E=0;E<S.length;E+=1)S[E].c();a=Z(),c=v("div"),f=v("div"),f.innerHTML=d,m=Z(),p=v("div"),D=ge(k),this.h()},l(E){e=b(E,"DIV",{id:!0,class:!0});var B=w(e);t=b(B,"DIV",{class:!0});var y=w(t);l=b(y,"DIV",{class:!0,"data-svelte-h":!0}),qe(l)!=="svelte-17yak1f"&&(l.innerHTML=s),o=q(y),r=b(y,"DIV",{class:!0});var L=w(r);i=b(L,"DIV",{class:!0});var V=w(i);for(let I=0;I<S.length;I+=1)S[I].l(V);V.forEach(h),a=q(L),c=b(L,"DIV",{class:!0});var U=w(c);f=b(U,"DIV",{"data-svelte-h":!0}),qe(f)!=="svelte-cdi12d"&&(f.innerHTML=d),m=q(U),p=b(U,"DIV",{class:!0});var M=w(p);D=pe(M,k),M.forEach(h),U.forEach(h),L.forEach(h),y.forEach(h),B.forEach(h),this.h()},h(){u(l,"class","bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center"),u(i,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),u(p,"class","line-clamp-1"),u(c,"class","px-2 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-br-xl flex items-center space-x-1"),u(r,"class","max-h-60 flex flex-col w-full rounded-r-lg bg-white dark:bg-gray-900 dark:text-gray-100"),u(t,"class","flex w-full dark:border dark:border-gray-850 rounded-lg"),u(e,"id","commands-container"),u(e,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(E,B){z(E,e,B),g(e,t),g(t,l),g(t,o),g(t,r),g(r,i);for(let y=0;y<S.length;y+=1)S[y]&&S[y].m(i,null);g(r,a),g(r,c),g(c,f),g(c,m),g(c,p),g(p,D)},p(E,B){if(B&38){_=it(E[2]);let y;for(y=0;y<_.length;y+=1){const L=Ws(E,_,y);S[y]?S[y].p(L,B):(S[y]=qs(L),S[y].c(),S[y].m(i,null))}for(;y<S.length;y+=1)S[y].d(1);S.length=_.length}B&8&&k!==(k=E[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&ye(D,k)},d(E){E&&h(e),xt(S,E)}}}function qs(n){let e,t,l=n[0].command+"",s,o,r,i=n[0].title+"",a,c,f,d,m;function p(){return n[11](n[0])}function k(){return n[12](n[14])}return{c(){e=v("button"),t=v("div"),s=ge(l),o=Z(),r=v("div"),a=ge(i),c=Z(),this.h()},l(D){e=b(D,"BUTTON",{class:!0,type:!0});var _=w(e);t=b(_,"DIV",{class:!0});var S=w(t);s=pe(S,l),S.forEach(h),o=q(_),r=b(_,"DIV",{class:!0});var E=w(r);a=pe(E,i),E.forEach(h),c=q(_),_.forEach(h),this.h()},h(){u(t,"class","font-medium text-black dark:text-gray-100"),u(r,"class","text-xs text-gray-600 dark:text-gray-100"),u(e,"class",f="px-3 py-1.5 rounded-xl w-full text-left "+(n[14]===n[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),u(e,"type","button")},m(D,_){z(D,e,_),g(e,t),g(t,s),g(e,o),g(e,r),g(r,a),g(e,c),d||(m=[ce(e,"click",p),ce(e,"mousemove",k),ce(e,"focus",da)],d=!0)},p(D,_){n=D,_&4&&l!==(l=n[0].command+"")&&ye(s,l),_&4&&i!==(i=n[0].title+"")&&ye(a,i),_&2&&f!==(f="px-3 py-1.5 rounded-xl w-full text-left "+(n[14]===n[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&u(e,"class",f)},d(D){D&&h(e),d=!1,zt(m)}}}function ua(n){let e,t=n[2].length>0&&Zs(n);return{c(){t&&t.c(),e=Pe()},l(l){t&&t.l(l),e=Pe()},m(l,s){t&&t.m(l,s),z(l,e,s)},p(l,[s]){l[2].length>0?t?t.p(l,s):(t=Zs(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(l){l&&h(e),t&&t.d(l)}}}const da=()=>{};function ha(n,e,t){let l,s;me(n,Qn,_=>t(10,s=_));const o=bt("i18n");me(n,o,_=>t(3,l=_));let{files:r}=e,{prompt:i=""}=e,{command:a=""}=e,c=0,f=[];const d=()=>{t(1,c=Math.max(0,c-1))},m=()=>{t(1,c=Math.min(c+1,f.length-1))},p=async _=>{let S=_.content;if(_.content.includes("{{CLIPBOARD}}")){const y=await navigator.clipboard.readText().catch(U=>(Ce.error(l.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));console.log(y);const L=await navigator.clipboard.read();let V=null;for(const U of L)for(const M of U.types)if(M.startsWith("image/")){const I=await U.getType(M);V=URL.createObjectURL(I),console.log(`Image URL (${M}): ${V}`)}V&&t(6,r=[...r,{type:"image",url:V}]),S=_.content.replaceAll("{{CLIPBOARD}}",y)}t(0,i=S);const E=document.getElementById("chat-textarea");await Be(),E.style.height="",E.style.height=Math.min(E.scrollHeight,200)+"px",E==null||E.focus(),await Be();const B=Un(i);if(B.length>0){const y=B.at(0);E.setSelectionRange(y==null?void 0:y.startIndex,y.endIndex+1)}},k=_=>{p(_)},D=_=>{t(1,c=_)};return n.$$set=_=>{"files"in _&&t(6,r=_.files),"prompt"in _&&t(0,i=_.prompt),"command"in _&&t(7,a=_.command)},n.$$.update=()=>{n.$$.dirty&1152&&t(2,f=s.filter(_=>_.command.toLowerCase().includes(a.toLowerCase())).sort((_,S)=>_.title.localeCompare(S.title))),n.$$.dirty&128&&a&&t(1,c=0)},[i,c,f,l,o,p,r,a,d,m,s,k,D]}class ma extends Je{constructor(e){super(),Ge(this,e,ha,ua,xe,{files:6,prompt:0,command:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function xs(n,e,t){const l=n.slice();return l[21]=e[t],l[23]=t,l}function Js(n){let e,t,l,s='<div class="text-lg font-semibold mt-2">#</div>',o,r,i,a,c,f,d=it(n[3]),m=[];for(let _=0;_<d.length;_+=1)m[_]=Gs(xs(n,d,_));function p(_,S){var E,B;if(S&1&&(c=null),S&1&&(f=null),c==null&&(c=!!_[0].split(" ").some(wa)),c)return va;if(f==null&&(f=!!((B=(E=_[0].split(" "))==null?void 0:E.at(0))!=null&&B.substring(1).startsWith("http"))),f)return _a}let k=p(n,-1),D=k&&k(n);return{c(){e=v("div"),t=v("div"),l=v("div"),l.innerHTML=s,o=Z(),r=v("div"),i=v("div");for(let _=0;_<m.length;_+=1)m[_].c();a=Z(),D&&D.c(),this.h()},l(_){e=b(_,"DIV",{id:!0,class:!0});var S=w(e);t=b(S,"DIV",{class:!0});var E=w(t);l=b(E,"DIV",{class:!0,"data-svelte-h":!0}),qe(l)!=="svelte-1bz58rh"&&(l.innerHTML=s),o=q(E),r=b(E,"DIV",{class:!0});var B=w(r);i=b(B,"DIV",{class:!0});var y=w(i);for(let L=0;L<m.length;L+=1)m[L].l(y);a=q(y),D&&D.l(y),y.forEach(h),B.forEach(h),E.forEach(h),S.forEach(h),this.h()},h(){u(l,"class","bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center"),u(i,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden"),u(r,"class","max-h-60 flex flex-col w-full rounded-r-xl bg-white dark:bg-gray-900 dark:text-gray-100"),u(t,"class","flex w-full dark:border dark:border-gray-850 rounded-lg"),u(e,"id","commands-container"),u(e,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(_,S){z(_,e,S),g(e,t),g(t,l),g(t,o),g(t,r),g(r,i);for(let E=0;E<m.length;E+=1)m[E]&&m[E].m(i,null);g(i,a),D&&D.m(i,null)},p(_,S){if(S&46){d=it(_[3]);let E;for(E=0;E<d.length;E+=1){const B=xs(_,d,E);m[E]?m[E].p(B,S):(m[E]=Gs(B),m[E].c(),m[E].m(i,a))}for(;E<m.length;E+=1)m[E].d(1);m.length=d.length}k===(k=p(_,S))&&D?D.p(_,S):(D&&D.d(1),D=k&&k(_),D&&(D.c(),D.m(i,null)))},d(_){_&&h(e),xt(m,_),D&&D.d()}}}function ga(n){let e,t,l=n[21].name+"",s,o,r=n[21].filename+"",i,a,c,f,d=n[21].title+"",m;return{c(){e=v("div"),t=ge("#"),s=ge(l),o=ge(" ("),i=ge(r),a=ge(")"),c=Z(),f=v("div"),m=ge(d),this.h()},l(p){e=b(p,"DIV",{class:!0});var k=w(e);t=pe(k,"#"),s=pe(k,l),o=pe(k," ("),i=pe(k,r),a=pe(k,")"),k.forEach(h),c=q(p),f=b(p,"DIV",{class:!0});var D=w(f);m=pe(D,d),D.forEach(h),this.h()},h(){u(e,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),u(f,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1")},m(p,k){z(p,e,k),g(e,t),g(e,s),g(e,o),g(e,i),g(e,a),z(p,c,k),z(p,f,k),g(f,m)},p(p,k){k&8&&l!==(l=p[21].name+"")&&ye(s,l),k&8&&r!==(r=p[21].filename+"")&&ye(i,r),k&8&&d!==(d=p[21].title+"")&&ye(m,d)},d(p){p&&(h(e),h(c),h(f))}}}function pa(n){var a;let e,t=(((a=n[21])==null?void 0:a.title)??`#${n[21].name}`)+"",l,s,o,r=n[1].t("Collection")+"",i;return{c(){e=v("div"),l=ge(t),s=Z(),o=v("div"),i=ge(r),this.h()},l(c){e=b(c,"DIV",{class:!0});var f=w(e);l=pe(f,t),f.forEach(h),s=q(c),o=b(c,"DIV",{class:!0});var d=w(o);i=pe(d,r),d.forEach(h),this.h()},h(){u(e,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),u(o,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1")},m(c,f){z(c,e,f),g(e,l),z(c,s,f),z(c,o,f),g(o,i)},p(c,f){var d;f&8&&t!==(t=(((d=c[21])==null?void 0:d.title)??`#${c[21].name}`)+"")&&ye(l,t),f&2&&r!==(r=c[1].t("Collection")+"")&&ye(i,r)},d(c){c&&(h(e),h(s),h(o))}}}function Gs(n){let e,t,l,s;function o(f,d){return f[21].type==="collection"?pa:ga}let r=o(n),i=r(n);function a(){return n[15](n[21])}function c(){return n[16](n[23])}return{c(){e=v("button"),i.c(),this.h()},l(f){e=b(f,"BUTTON",{class:!0,type:!0});var d=w(e);i.l(d),d.forEach(h),this.h()},h(){u(e,"class",t="px-3 py-1.5 rounded-xl w-full text-left "+(n[23]===n[2]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":"")),u(e,"type","button")},m(f,d){z(f,e,d),i.m(e,null),l||(s=[ce(e,"click",a),ce(e,"mousemove",c),ce(e,"focus",ka)],l=!0)},p(f,d){n=f,r===(r=o(n))&&i?i.p(n,d):(i.d(1),i=r(n),i&&(i.c(),i.m(e,null))),d&4&&t!==(t="px-3 py-1.5 rounded-xl w-full text-left "+(n[23]===n[2]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":""))&&u(e,"class",t)},d(f){f&&h(e),i.d(),l=!1,zt(s)}}}function _a(n){var d,m;let e,t,l=((m=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:m.substring(1))+"",s,o,r,i=n[1].t("Web")+"",a,c,f;return{c(){e=v("button"),t=v("div"),s=ge(l),o=Z(),r=v("div"),a=ge(i),this.h()},l(p){e=b(p,"BUTTON",{class:!0,type:!0});var k=w(e);t=b(k,"DIV",{class:!0});var D=w(t);s=pe(D,l),D.forEach(h),o=q(k),r=b(k,"DIV",{class:!0});var _=w(r);a=pe(_,i),_.forEach(h),k.forEach(h),this.h()},h(){u(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),u(r,"class","text-xs text-gray-600 line-clamp-1"),u(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),u(e,"type","button")},m(p,k){z(p,e,k),g(e,t),g(t,s),g(e,o),g(e,r),g(r,a),c||(f=ce(e,"click",n[18]),c=!0)},p(p,k){var D,_;k&1&&l!==(l=((_=(D=p[0].split(" "))==null?void 0:D.at(0))==null?void 0:_.substring(1))+"")&&ye(s,l),k&2&&i!==(i=p[1].t("Web")+"")&&ye(a,i)},d(p){p&&h(e),c=!1,f()}}}function va(n){var d,m;let e,t,l=((m=(d=n[0].split(" "))==null?void 0:d.at(0))==null?void 0:m.substring(1))+"",s,o,r,i=n[1].t("Youtube")+"",a,c,f;return{c(){e=v("button"),t=v("div"),s=ge(l),o=Z(),r=v("div"),a=ge(i),this.h()},l(p){e=b(p,"BUTTON",{class:!0,type:!0});var k=w(e);t=b(k,"DIV",{class:!0});var D=w(t);s=pe(D,l),D.forEach(h),o=q(k),r=b(k,"DIV",{class:!0});var _=w(r);a=pe(_,i),_.forEach(h),k.forEach(h),this.h()},h(){u(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),u(r,"class","text-xs text-gray-600 line-clamp-1"),u(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),u(e,"type","button")},m(p,k){z(p,e,k),g(e,t),g(t,s),g(e,o),g(e,r),g(r,a),c||(f=ce(e,"click",n[17]),c=!0)},p(p,k){var D,_;k&1&&l!==(l=((_=(D=p[0].split(" "))==null?void 0:D.at(0))==null?void 0:_.substring(1))+"")&&ye(s,l),k&2&&i!==(i=p[1].t("Youtube")+"")&&ye(a,i)},d(p){p&&h(e),c=!1,f()}}}function ba(n){var s,o;let e=n[3].length>0||((o=(s=n[0].split(" "))==null?void 0:s.at(0))==null?void 0:o.substring(1).startsWith("http")),t,l=e&&Js(n);return{c(){l&&l.c(),t=Pe()},l(r){l&&l.l(r),t=Pe()},m(r,i){l&&l.m(r,i),z(r,t,i)},p(r,[i]){var a,c;i&9&&(e=r[3].length>0||((c=(a=r[0].split(" "))==null?void 0:a.at(0))==null?void 0:c.substring(1).startsWith("http"))),e?l?l.p(r,i):(l=Js(r),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},i:De,o:De,d(r){r&&h(t),l&&l.d(r)}}}const wa=n=>n.substring(1).startsWith("https://www.youtube.com")||n.substring(1).startsWith("https://youtu.be"),ka=()=>{};function ya(n,e,t){let l,s,o;me(n,Kn,M=>t(14,s=M));const r=bt("i18n");me(n,r,M=>t(1,o=M));let{prompt:i=""}=e,{command:a=""}=e;const c=el();let f=0,d=[],m=[],p=[];const k=(M,I)=>{var W,R;return M.name.toLowerCase().includes(((R=(W=I.toLowerCase().split(" "))==null?void 0:W.at(0))==null?void 0:R.substring(1))??"")},D=()=>{t(2,f=Math.max(0,f-1))},_=()=>{t(2,f=Math.min(f+1,d.length-1))},S=async M=>{c("select",M),t(0,i=Jl(i,a));const I=document.getElementById("chat-textarea");await Be(),I==null||I.focus(),await Be()},E=async M=>{c("url",M),t(0,i=Jl(i,a));const I=document.getElementById("chat-textarea");await Be(),I==null||I.focus(),await Be()},B=async M=>{c("youtube",M),t(0,i=Jl(i,a));const I=document.getElementById("chat-textarea");await Be(),I==null||I.focus(),await Be()},y=M=>{console.log(M),S(M)},L=M=>{t(2,f=M)},V=()=>{var I,C;const M=(C=(I=i.split(" "))==null?void 0:I.at(0))==null?void 0:C.substring(1);hs(M)?B(M):Ce.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},U=()=>{var I,C;const M=(C=(I=i.split(" "))==null?void 0:I.at(0))==null?void 0:C.substring(1);hs(M)?E(M):Ce.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return n.$$set=M=>{"prompt"in M&&t(0,i=M.prompt),"command"in M&&t(8,a=M.command)},n.$$.update=()=>{n.$$.dirty&16386&&t(12,p=[...s.length>0?[{name:"All Documents",type:"collection",title:o.t("All Documents"),collection_names:s.map(M=>M.collection_name)}]:[],...s.reduce((M,I,C,W)=>{var R;return[...new Set([...M,...(((R=I==null?void 0:I.content)==null?void 0:R.tags)??[]).map(A=>A.name)])]},[]).map(M=>({name:M,type:"collection",collection_names:s.filter(I=>{var C;return(((C=I==null?void 0:I.content)==null?void 0:C.tags)??[]).map(W=>W.name).includes(M)}).map(I=>I.collection_name)}))]),n.$$.dirty&4352&&t(13,l=p.filter(M=>k(M,a)).sort((M,I)=>M.name.localeCompare(I.name))),n.$$.dirty&16640&&t(11,m=s.filter(M=>k(M,a)).sort((M,I)=>M.title.localeCompare(I.title))),n.$$.dirty&10240&&t(3,d=[...l,...m]),n.$$.dirty&8448&&a&&(t(2,f=0),console.log(l))},[i,o,f,d,r,S,E,B,a,D,_,m,p,l,s,y,L,V,U]}class Ea extends Je{constructor(e){super(),Ge(this,e,ya,ba,xe,{prompt:0,command:8,selectUp:9,selectDown:10})}get selectUp(){return this.$$.ctx[9]}get selectDown(){return this.$$.ctx[10]}}function Qs(n,e,t){const l=n.slice();return l[11]=e[t],l[13]=t,l}function Ks(n){let e,t,l,s='<div class="text-lg font-semibold mt-2">@</div>',o,r,i,a=it(n[1]),c=[];for(let f=0;f<a.length;f+=1)c[f]=Ys(Qs(n,a,f));return{c(){e=v("div"),t=v("div"),l=v("div"),l.innerHTML=s,o=Z(),r=v("div"),i=v("div");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=b(f,"DIV",{id:!0,class:!0});var d=w(e);t=b(d,"DIV",{class:!0});var m=w(t);l=b(m,"DIV",{class:!0,"data-svelte-h":!0}),qe(l)!=="svelte-6hrplu"&&(l.innerHTML=s),o=q(m),r=b(m,"DIV",{class:!0});var p=w(r);i=b(p,"DIV",{class:!0});var k=w(i);for(let D=0;D<c.length;D+=1)c[D].l(k);k.forEach(h),p.forEach(h),m.forEach(h),d.forEach(h),this.h()},h(){u(l,"class","bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center"),u(i,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),u(r,"class","max-h-60 flex flex-col w-full rounded-r-lg bg-white dark:bg-gray-900 dark:text-gray-100"),u(t,"class","flex w-full dark:border dark:border-gray-850 rounded-lg"),u(e,"id","commands-container"),u(e,"class","pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(f,d){z(f,e,d),g(e,t),g(t,l),g(t,o),g(t,r),g(r,i);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(i,null)},p(f,d){if(d&7){a=it(f[1]);let m;for(m=0;m<a.length;m+=1){const p=Qs(f,a,m);c[m]?c[m].p(p,d):(c[m]=Ys(p),c[m].c(),c[m].m(i,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=a.length}},d(f){f&&h(e),xt(c,f)}}}function Ys(n){let e,t,l,s,o,r,i=n[11].name+"",a,c,f,d,m;function p(){return n[7](n[11])}function k(){return n[8](n[13])}return{c(){e=v("button"),t=v("div"),l=v("img"),r=Z(),a=ge(i),c=Z(),this.h()},l(D){e=b(D,"BUTTON",{class:!0,type:!0});var _=w(e);t=b(_,"DIV",{class:!0});var S=w(t);l=b(S,"IMG",{src:!0,alt:!0,class:!0}),r=q(S),a=pe(S,i),S.forEach(h),c=q(_),_.forEach(h),this.h()},h(){var D,_,S,E;nl(l.src,s=((S=(_=(D=n[11])==null?void 0:D.info)==null?void 0:_.meta)==null?void 0:S.profile_image_url)??"/static/13-Copy.png")||u(l,"src",s),u(l,"alt",o=((E=n[11])==null?void 0:E.name)??n[11].id),u(l,"class","rounded-full size-6 items-center mr-2"),u(t,"class","flex font-medium text-black dark:text-gray-100 line-clamp-1"),u(e,"class",f="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),u(e,"type","button")},m(D,_){z(D,e,_),g(e,t),g(t,l),g(t,r),g(t,a),g(e,c),d||(m=[ce(e,"click",p),ce(e,"mousemove",k),ce(e,"focus",Da)],d=!0)},p(D,_){var S,E,B,y;n=D,_&2&&!nl(l.src,s=((B=(E=(S=n[11])==null?void 0:S.info)==null?void 0:E.meta)==null?void 0:B.profile_image_url)??"/static/13-Copy.png")&&u(l,"src",s),_&2&&o!==(o=((y=n[11])==null?void 0:y.name)??n[11].id)&&u(l,"alt",o),_&2&&i!==(i=n[11].name+"")&&ye(a,i),_&1&&f!==(f="px-3 py-1.5 rounded-xl w-full text-left "+(n[13]===n[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&u(e,"class",f)},d(D){D&&h(e),d=!1,zt(m)}}}function Ia(n){let e,t=n[1].length>0&&Ks(n);return{c(){t&&t.c(),e=Pe()},l(l){t&&t.l(l),e=Pe()},m(l,s){t&&t.m(l,s),z(l,e,s)},p(l,[s]){l[1].length>0?t?t.p(l,s):(t=Ks(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(l){l&&h(e),t&&t.d(l)}}}const Da=()=>{};function Ca(n,e,t){let l;me(n,Ol,p=>t(6,l=p)),bt("i18n");const s=el();let{command:o=""}=e,r=0,i=[];const a=()=>{t(0,r=Math.max(0,r-1))},c=()=>{t(0,r=Math.min(r+1,i.length-1))},f=async p=>{t(3,o=""),s("select",p)};wl(async()=>{await Be();const p=document.getElementById("chat-textarea");await Be(),p==null||p.focus(),await Be()});const d=p=>{f(p)},m=p=>{t(0,r=p)};return n.$$set=p=>{"command"in p&&t(3,o=p.command)},n.$$.update=()=>{n.$$.dirty&72&&t(1,i=l.filter(p=>{var k,D;return p.name.toLowerCase().includes(((D=(k=o.toLowerCase().split(" "))==null?void 0:k.at(0))==null?void 0:D.substring(1))??"")}).sort((p,k)=>p.name.localeCompare(k.name))),n.$$.dirty&8&&o&&t(0,r=0)},[r,i,f,o,a,c,l,d,m]}class Sa extends Je{constructor(e){super(),Ge(this,e,Ca,Ia,xe,{command:3,selectUp:4,selectDown:5})}get selectUp(){return this.$$.ctx[4]}get selectDown(){return this.$$.ctx[5]}}function Xs(n){let e,t,l,s,o,r,i;const a=[Ma,Va,Ta],c=[];function f(d,m){var p,k,D;return m&8&&(e=null),m&8&&(t=null),m&8&&(l=null),e==null&&(e=((p=d[3])==null?void 0:p.charAt(0))==="/"),e?0:(t==null&&(t=((k=d[3])==null?void 0:k.charAt(0))==="#"),t?1:(l==null&&(l=((D=d[3])==null?void 0:D.charAt(0))==="@"),l?2:-1))}return~(s=f(n,-1))&&(o=c[s]=a[s](n)),{c(){o&&o.c(),r=Pe()},l(d){o&&o.l(d),r=Pe()},m(d,m){~s&&c[s].m(d,m),z(d,r,m),i=!0},p(d,m){let p=s;s=f(d,m),s===p?~s&&c[s].p(d,m):(o&&(Re(),O(c[p],1,1,()=>{c[p]=null}),Fe()),~s?(o=c[s],o?o.p(d,m):(o=c[s]=a[s](d),o.c()),N(o,1),o.m(r.parentNode,r)):o=null)},i(d){i||(N(o),i=!0)},o(d){O(o),i=!1},d(d){d&&h(r),~s&&c[s].d(d)}}}function Ta(n){let e,t,l={command:n[3]};return e=new Sa({props:l}),n[17](e),e.$on("select",n[18]),{c(){ee(e.$$.fragment)},l(s){te(e.$$.fragment,s)},m(s,o){le(e,s,o),t=!0},p(s,o){const r={};o&8&&(r.command=s[3]),e.$set(r)},i(s){t||(N(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){n[17](null),se(e,s)}}}function Va(n){let e,t,l;function s(r){n[13](r)}let o={command:n[3]};return n[0]!==void 0&&(o.prompt=n[0]),e=new Ea({props:o}),n[12](e),_e.push(()=>He(e,"prompt",s)),e.$on("youtube",n[14]),e.$on("url",n[15]),e.$on("select",n[16]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};i&8&&(a.command=r[3]),!t&&i&1&&(t=!0,a.prompt=r[0],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){n[12](null),se(e,r)}}}function Ma(n){let e,t,l,s;function o(a){n[10](a)}function r(a){n[11](a)}let i={command:n[3]};return n[0]!==void 0&&(i.prompt=n[0]),n[1]!==void 0&&(i.files=n[1]),e=new ma({props:i}),n[9](e),_e.push(()=>He(e,"prompt",o)),_e.push(()=>He(e,"files",r)),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,c){le(e,a,c),s=!0},p(a,c){const f={};c&8&&(f.command=a[3]),!t&&c&1&&(t=!0,f.prompt=a[0],Me(()=>t=!1)),!l&&c&2&&(l=!0,f.files=a[1],Me(()=>l=!1)),e.$set(f)},i(a){s||(N(e.$$.fragment,a),s=!0)},o(a){O(e.$$.fragment,a),s=!1},d(a){n[9](null),se(e,a)}}}function Ha(n){var o;let e=["/","#","@"].includes((o=n[3])==null?void 0:o.charAt(0)),t,l,s=e&&Xs(n);return{c(){s&&s.c(),t=Pe()},l(r){s&&s.l(r),t=Pe()},m(r,i){s&&s.m(r,i),z(r,t,i),l=!0},p(r,[i]){var a;i&8&&(e=["/","#","@"].includes((a=r[3])==null?void 0:a.charAt(0))),e?s?(s.p(r,i),i&8&&N(s,1)):(s=Xs(r),s.c(),N(s,1),s.m(t.parentNode,t)):s&&(Re(),O(s,1,1,()=>{s=null}),Fe())},i(r){l||(N(s),l=!0)},o(r){O(s),l=!1},d(r){r&&h(t),s&&s.d(r)}}}function Ba(n,e,t){const l=el();let{prompt:s=""}=e,{files:o=[]}=e,r=null;const i=()=>{r==null||r.selectUp()},a=()=>{r==null||r.selectDown()};let c="";const f=async V=>{console.log(V);const U={type:"doc",name:V,collection_name:"",status:!1,url:V,error:""};try{t(1,o=[...o,U]);const M=await mr(localStorage.token,"",V);M&&(U.status="processed",U.collection_name=M.collection_name,t(1,o))}catch(M){t(1,o=o.filter(I=>I.name!==V)),Ce.error(M)}},d=async V=>{console.log(V);const U={type:"doc",name:V,collection_name:"",status:!1,url:V,error:""};try{t(1,o=[...o,U]);const M=await gr(localStorage.token,V);M&&(U.status="processed",U.collection_name=M.collection_name,t(1,o))}catch(M){t(1,o=o.filter(I=>I.name!==V)),Ce.error(M)}};function m(V){_e[V?"unshift":"push"](()=>{r=V,t(2,r)})}function p(V){s=V,t(0,s)}function k(V){o=V,t(1,o)}function D(V){_e[V?"unshift":"push"](()=>{r=V,t(2,r)})}function _(V){s=V,t(0,s)}const S=V=>{console.log(V),d(V.detail)},E=V=>{console.log(V),f(V.detail)},B=V=>{var U;console.log(V),t(1,o=[...o,{type:((U=V==null?void 0:V.detail)==null?void 0:U.type)??"file",...V.detail,status:"processed"}]),l("select")};function y(V){_e[V?"unshift":"push"](()=>{r=V,t(2,r)})}const L=V=>{t(0,s=Jl(s,c)),l("select",{type:"model",data:V.detail})};return n.$$set=V=>{"prompt"in V&&t(0,s=V.prompt),"files"in V&&t(1,o=V.files)},n.$$.update=()=>{var V;n.$$.dirty&1&&t(3,c=((V=((s==null?void 0:s.trim())??"").split(" "))==null?void 0:V.at(-1))??"")},[s,o,r,c,l,f,d,i,a,m,p,k,D,_,S,E,B,y,L]}class La extends Je{constructor(e){super(),Ge(this,e,Ba,Ha,xe,{prompt:0,files:1,selectUp:7,selectDown:8})}get selectUp(){return this.$$.ctx[7]}get selectDown(){return this.$$.ctx[8]}}function Na(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=ze(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"d","M6 18 18 6M6 6l12 12"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width",n[1]),u(e,"stroke","currentColor"),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&2&&u(e,"stroke-width",l[1]),s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function za(n,e,t){let{className:l="size-3.5"}=e,{strokeWidth:s="2"}=e;return n.$$set=o=>{"className"in o&&t(0,l=o.className),"strokeWidth"in o&&t(1,s=o.strokeWidth)},[l,s]}class Rn extends Je{constructor(e){super(),Ge(this,e,za,Na,xe,{className:0,strokeWidth:1})}}function $s(n,e,t){const l=n.slice();return l[65]=e[t],l[67]=t,l}function en(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',s,o;return{c(){e=v("div"),t=v("button"),t.innerHTML=l,this.h()},l(r){e=b(r,"DIV",{class:!0});var i=w(e);t=b(i,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(t)!=="svelte-txgoc3"&&(t.innerHTML=l),i.forEach(h),this.h()},h(){u(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),u(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(r,i){z(r,e,i),g(e,t),s||(o=ce(t,"click",n[31]),s=!0)},p:De,d(r){r&&h(e),s=!1,o()}}}function tn(n){let e,t,l,s,o,r,i,a,c=n[0].name+"",f,d,m,p,k,D,_,S;return k=new Rn({}),{c(){e=v("div"),t=v("div"),l=v("img"),o=Z(),r=v("div"),i=ge("Talking to "),a=v("span"),f=ge(c),d=Z(),m=v("div"),p=v("button"),ee(k.$$.fragment),this.h()},l(E){e=b(E,"DIV",{class:!0});var B=w(e);t=b(B,"DIV",{class:!0});var y=w(t);l=b(y,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),o=q(y),r=b(y,"DIV",{});var L=w(r);i=pe(L,"Talking to "),a=b(L,"SPAN",{class:!0});var V=w(a);f=pe(V,c),V.forEach(h),L.forEach(h),y.forEach(h),d=q(B),m=b(B,"DIV",{});var U=w(m);p=b(U,"BUTTON",{class:!0});var M=w(p);te(k.$$.fragment,M),M.forEach(h),U.forEach(h),B.forEach(h),this.h()},h(){var E,B,y;u(l,"crossorigin","anonymous"),u(l,"alt","model profile"),u(l,"class","size-5 max-w-[28px] object-cover rounded-full"),nl(l.src,s=((y=(B=(E=n[13].find(n[32]))==null?void 0:E.info)==null?void 0:B.meta)==null?void 0:y.profile_image_url)??(n[21].language==="dg-DG"?"/doge.png":`${zl}/static/13-Copy.png`))||u(l,"src",s),u(a,"class","font-medium"),u(t,"class","flex items-center gap-2 text-sm dark:text-gray-500"),u(p,"class","flex items-center"),u(e,"class","px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0.5 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900 z-10")},m(E,B){z(E,e,B),g(e,t),g(t,l),g(t,o),g(t,r),g(r,i),g(r,a),g(a,f),g(e,d),g(e,m),g(m,p),le(k,p,null),D=!0,_||(S=ce(p,"click",n[33]),_=!0)},p(E,B){var y,L,V;(!D||B[0]&2105345&&!nl(l.src,s=((V=(L=(y=E[13].find(E[32]))==null?void 0:y.info)==null?void 0:L.meta)==null?void 0:V.profile_image_url)??(E[21].language==="dg-DG"?"/doge.png":`${zl}/static/13-Copy.png`)))&&u(l,"src",s),(!D||B[0]&1)&&c!==(c=E[0].name+"")&&ye(f,c)},i(E){D||(N(k.$$.fragment,E),D=!0)},o(E){O(k.$$.fragment,E),D=!1},d(E){E&&h(e),se(k),_=!1,S()}}}function Oa(n){let e,t,l,s,o,r,i,a,c,f,d,m,p,k=n[11].length==0||n[11].at(-1).done==!0,D,_,S,E,B,y,L,V,U,M=n[3].length>0&&ln(n);function I(x){n[50](x)}function C(x){n[51](x)}let W={tools:n[24].reduce(n[47],{}),uploadFilesHandler:n[48],onClose:n[49],$$slots:{default:[Ra]},$$scope:{ctx:n}};n[5]!==void 0&&(W.webSearchEnabled=n[5]),n[4]!==void 0&&(W.selectedToolIds=n[4]),r=new $o({props:W}),_e.push(()=>He(r,"webSearchEnabled",I)),_e.push(()=>He(r,"selectedToolIds",C));let R=k&&rn(n);const A=[Za,Wa],j=[];function G(x,F){return F[0]&2048&&(E=null),E==null&&(E=x[11].length==0||x[11].at(-1).done==!0),E?0:1}return B=G(n,[-1,-1,-1]),y=j[B]=A[B](n),{c(){e=v("form"),t=v("div"),M&&M.c(),l=Z(),s=v("div"),o=v("div"),ee(r.$$.fragment),c=Z(),f=v("textarea"),m=Z(),p=v("div"),R&&R.c(),_=Z(),S=v("div"),y.c(),this.h()},l(x){e=b(x,"FORM",{class:!0});var F=w(e);t=b(F,"DIV",{class:!0,dir:!0});var ie=w(t);M&&M.l(ie),l=q(ie),s=b(ie,"DIV",{class:!0});var be=w(s);o=b(be,"DIV",{class:!0});var Ie=w(o);te(r.$$.fragment,Ie),Ie.forEach(h),c=q(be),f=b(be,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),w(f).forEach(h),m=q(be),p=b(be,"DIV",{class:!0});var Y=w(p);R&&R.l(Y),Y.forEach(h),be.forEach(h),ie.forEach(h),_=q(F),S=b(F,"DIV",{class:!0});var oe=w(S);y.l(oe),oe.forEach(h),F.forEach(h),this.h()},h(){var x;u(o,"class","ml-0.5 self-end mb-1.5 flex space-x-1"),u(f,"id","chat-textarea"),u(f,"class","scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-1 rounded-xl resize-none h-[48px] svelte-141e0sl"),u(f,"placeholder",d=n[21].t("Send a Message")),u(f,"rows","1"),u(p,"class","self-end mb-2 flex space-x-1 mr-1"),u(s,"class","flex"),u(t,"class","flex-1 flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100"),u(t,"dir",D=((x=n[23])==null?void 0:x.chatDirection)??"LTR"),u(S,"class","flex items-end w-10"),u(e,"class","w-full flex gap-1.5")},m(x,F){z(x,e,F),g(e,t),M&&M.m(t,null),g(t,l),g(t,s),g(s,o),le(r,o,null),g(s,c),g(s,f),n[52](f),Zt(f,n[1]),g(s,m),g(s,p),R&&R.m(p,null),g(e,_),g(e,S),j[B].m(S,null),L=!0,V||(U=[ce(f,"input",n[53]),ce(f,"keypress",n[54]),ce(f,"keydown",n[55]),ce(f,"input",n[56]),ce(f,"focus",n[57]),ce(f,"paste",n[58]),ce(e,"submit",Bn(n[62]))],V=!0)},p(x,F){var Ie;x[3].length>0?M?(M.p(x,F),F[0]&8&&N(M,1)):(M=ln(x),M.c(),N(M,1),M.m(t,l)):M&&(Re(),O(M,1,1,()=>{M=null}),Fe());const ie={};F[0]&50332672&&(ie.tools=x[24].reduce(x[47],{})),F[0]&32768&&(ie.uploadFilesHandler=x[48]),F[0]&4096&&(ie.onClose=x[49]),F[2]&64&&(ie.$$scope={dirty:F,ctx:x}),!i&&F[0]&32&&(i=!0,ie.webSearchEnabled=x[5],Me(()=>i=!1)),!a&&F[0]&16&&(a=!0,ie.selectedToolIds=x[4],Me(()=>a=!1)),r.$set(ie),(!L||F[0]&2097152&&d!==(d=x[21].t("Send a Message")))&&u(f,"placeholder",d),F[0]&2&&Zt(f,x[1]),F[0]&2048&&(k=x[11].length==0||x[11].at(-1).done==!0),k?R?(R.p(x,F),F[0]&2048&&N(R,1)):(R=rn(x),R.c(),N(R,1),R.m(p,null)):R&&(Re(),O(R,1,1,()=>{R=null}),Fe()),(!L||F[0]&8388608&&D!==(D=((Ie=x[23])==null?void 0:Ie.chatDirection)??"LTR"))&&u(t,"dir",D);let be=B;B=G(x,F),B===be?j[B].p(x,F):(Re(),O(j[be],1,1,()=>{j[be]=null}),Fe(),y=j[B],y?y.p(x,F):(y=j[B]=A[B](x),y.c()),N(y,1),y.m(S,null))},i(x){L||(N(M),N(r.$$.fragment,x),N(R),N(y),L=!0)},o(x){O(M),O(r.$$.fragment,x),O(R),O(y),L=!1},d(x){x&&h(e),M&&M.d(),se(r),n[52](null),R&&R.d(),j[B].d(),V=!1,zt(U)}}}function Ua(n){let e,t,l;function s(r){n[41](r)}let o={};return n[14]!==void 0&&(o.recording=n[14]),e=new aa({props:o}),_e.push(()=>He(e,"recording",s)),e.$on("cancel",n[42]),e.$on("confirm",n[43]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};!t&&i[0]&16384&&(t=!0,a.recording=r[14],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function ln(n){let e,t,l=it(n[3]),s=[];for(let r=0;r<l.length;r+=1)s[r]=nn($s(n,l,r));const o=r=>O(s[r],1,1,()=>{s[r]=null});return{c(){e=v("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var i=w(e);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(h),this.h()},h(){u(e,"class","mx-1 mt-2.5 mb-1 flex flex-wrap gap-2")},m(r,i){z(r,e,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,i){if(i[0]&3146249){l=it(r[3]);let a;for(a=0;a<l.length;a+=1){const c=$s(r,l,a);s[a]?(s[a].p(c,i),N(s[a],1)):(s[a]=nn(c),s[a].c(),N(s[a],1),s[a].m(e,null))}for(Re(),a=l.length;a<s.length;a+=1)o(a);Fe()}},i(r){if(!t){for(let i=0;i<l.length;i+=1)N(s[i]);t=!0}},o(r){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)O(s[i]);t=!1},d(r){r&&h(e),xt(s,r)}}}function Aa(n){var s;let e,t;function l(){return n[46](n[67])}return e=new Nn({props:{name:n[65].name,type:n[65].type,size:(s=n[65])==null?void 0:s.size,status:n[65].status,dismissible:!0}}),e.$on("dismiss",l),{c(){ee(e.$$.fragment)},l(o){te(e.$$.fragment,o)},m(o,r){le(e,o,r),t=!0},p(o,r){var a;n=o;const i={};r[0]&8&&(i.name=n[65].name),r[0]&8&&(i.type=n[65].type),r[0]&8&&(i.size=(a=n[65])==null?void 0:a.size),r[0]&8&&(i.status=n[65].status),e.$set(i)},i(o){t||(N(e.$$.fragment,o),t=!0)},o(o){O(e.$$.fragment,o),t=!1},d(o){se(e,o)}}}function Pa(n){let e,t,l,s,o,r,i,a,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,d,m,p,k=(n[0]?n[20].length===0:n[9].length!==n[20].length)&&sn(n);function D(){return n[45](n[67])}return{c(){e=v("div"),t=v("div"),l=v("img"),o=Z(),k&&k.c(),r=Z(),i=v("div"),a=v("button"),a.innerHTML=c,f=Z(),this.h()},l(_){e=b(_,"DIV",{class:!0});var S=w(e);t=b(S,"DIV",{class:!0});var E=w(t);l=b(E,"IMG",{src:!0,alt:!0,class:!0}),o=q(E),k&&k.l(E),E.forEach(h),r=q(S),i=b(S,"DIV",{class:!0});var B=w(i);a=b(B,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),qe(a)!=="svelte-l5shih"&&(a.innerHTML=c),B.forEach(h),f=q(S),S.forEach(h),this.h()},h(){nl(l.src,s=n[65].url)||u(l,"src",s),u(l,"alt","input"),u(l,"class","h-16 w-16 rounded-xl object-cover"),u(t,"class","relative"),u(a,"class","bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition"),u(a,"type","button"),u(i,"class","absolute -top-1 -right-1"),u(e,"class","relative group")},m(_,S){z(_,e,S),g(e,t),g(t,l),g(t,o),k&&k.m(t,null),g(e,r),g(e,i),g(i,a),g(e,f),d=!0,m||(p=ce(a,"click",D),m=!0)},p(_,S){n=_,(!d||S[0]&8&&!nl(l.src,s=n[65].url))&&u(l,"src",s),(n[0]?n[20].length===0:n[9].length!==n[20].length)?k?(k.p(n,S),S[0]&1049089&&N(k,1)):(k=sn(n),k.c(),N(k,1),k.m(t,null)):k&&(Re(),O(k,1,1,()=>{k=null}),Fe())},i(_){d||(N(k),d=!0)},o(_){O(k),d=!1},d(_){_&&h(e),k&&k.d(),m=!1,p()}}}function sn(n){let e,t;return e=new qt({props:{className:" absolute top-1 left-1",content:n[21].t("{{ models }}",{models:[...n[0]?[n[0]]:n[9]].filter(n[44]).join(", ")}),$$slots:{default:[ja]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s[0]&3146241&&(o.content=l[21].t("{{ models }}",{models:[...l[0]?[l[0]]:l[9]].filter(l[44]).join(", ")})),s[2]&64&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function ja(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var s=w(e);t=ze(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),u(t,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class","size-4 fill-yellow-300")},m(l,s){z(l,e,s),g(e,t)},p:De,d(l){l&&h(e)}}}function nn(n){let e,t,l,s;const o=[Pa,Aa],r=[];function i(a,c){return a[65].type==="image"?0:1}return e=i(n),t=r[e]=o[e](n),{c(){t.c(),l=Pe()},l(a){t.l(a),l=Pe()},m(a,c){r[e].m(a,c),z(a,l,c),s=!0},p(a,c){let f=e;e=i(a),e===f?r[e].p(a,c):(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l))},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),r[e].d(a)}}}function Ra(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path d="M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"></path></svg>';return{c(){e=v("button"),e.innerHTML=t,this.h()},l(l){e=b(l,"BUTTON",{class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),qe(e)!=="svelte-d8rhv1"&&(e.innerHTML=t),this.h()},h(){u(e,"class","bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-2 outline-none focus:outline-none"),u(e,"type","button"),u(e,"aria-label","More")},m(l,s){z(l,e,s)},p:De,d(l){l&&h(e)}}}function rn(n){let e,t;return e=new qt({props:{content:n[21].t("Record voice"),$$slots:{default:[Fa]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s[0]&2097152&&(o.content=l[21].t("Record voice")),s[0]&2113536|s[2]&64&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Fa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',l,s;return{c(){e=v("button"),e.innerHTML=t,this.h()},l(o){e=b(o,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),qe(e)!=="svelte-l9ga2d"&&(e.innerHTML=t),this.h()},h(){u(e,"id","voice-input-button"),u(e,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center"),u(e,"type","button"),u(e,"aria-label","Voice Input")},m(o,r){z(o,e,r),l||(s=ce(e,"click",n[59]),l=!0)},p:De,d(o){o&&h(e),l=!1,s()}}}function Wa(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',s,o;return{c(){e=v("div"),t=v("button"),t.innerHTML=l,this.h()},l(r){e=b(r,"DIV",{class:!0});var i=w(e);t=b(i,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(t)!=="svelte-5uu99u"&&(t.innerHTML=l),i.forEach(h),this.h()},h(){u(t,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5"),u(e,"class","flex items-center mb-1.5")},m(r,i){z(r,e,i),g(e,t),s||(o=ce(t,"click",n[61]),s=!0)},p:De,i:De,o:De,d(r){r&&h(e),s=!1,o()}}}function Za(n){let e,t,l,s;const o=[xa,qa],r=[];function i(a,c){return a[1]===""?0:1}return e=i(n),t=r[e]=o[e](n),{c(){t.c(),l=Pe()},l(a){t.l(a),l=Pe()},m(a,c){r[e].m(a,c),z(a,l,c),s=!0},p(a,c){let f=e;e=i(a),e===f?r[e].p(a,c):(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l))},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),r[e].d(a)}}}function qa(n){let e,t,l;return t=new qt({props:{content:n[21].t("Send message"),$$slots:{default:[Ja]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"class","flex items-center mb-1")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o[0]&2097152&&(r.content=s[21].t("Send message")),o[0]&2|o[2]&64&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function xa(n){let e,t,l;return t=new qt({props:{content:n[21].t("Call"),$$slots:{default:[Ga]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"class","flex items-center mb-1")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o[0]&2097152&&(r.content=s[21].t("Call")),o[0]&6291968|o[2]&64&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function Ja(n){let e,t,l,s,o;return{c(){e=v("button"),t=Ne("svg"),l=Ne("path"),this.h()},l(r){e=b(r,"BUTTON",{id:!0,class:!0,type:!0});var i=w(e);t=ze(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=w(t);l=ze(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(l).forEach(h),a.forEach(h),i.forEach(h),this.h()},h(){u(l,"fill-rule","evenodd"),u(l,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),u(l,"clip-rule","evenodd"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"viewBox","0 0 16 16"),u(t,"fill","currentColor"),u(t,"class","size-6"),u(e,"id","send-message-button"),u(e,"class",s=(n[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),u(e,"type","submit"),e.disabled=o=n[1]===""},m(r,i){z(r,e,i),g(e,t),g(t,l)},p(r,i){i[0]&2&&s!==(s=(r[1]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&u(e,"class",s),i[0]&2&&o!==(o=r[1]==="")&&(e.disabled=o)},d(r){r&&h(e)}}}function Ga(n){let e,t,l,s,o;return t=new la({props:{className:"size-6"}}),{c(){e=v("button"),ee(t.$$.fragment),this.h()},l(r){e=b(r,"BUTTON",{class:!0,type:!0,"aria-label":!0});var i=w(e);te(t.$$.fragment,i),i.forEach(h),this.h()},h(){u(e,"class","text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-2 self-center"),u(e,"type","button"),u(e,"aria-label","Call")},m(r,i){z(r,e,i),le(t,e,null),l=!0,s||(o=ce(e,"click",n[60]),s=!0)},p:De,i(r){l||(N(t.$$.fragment,r),l=!0)},o(r){O(t.$$.fragment,r),l=!1},d(r){r&&h(e),se(t),s=!1,o()}}}function Qa(n){let e,t,l,s,o,r,i,a,c,f,d,m,p,k,D,_,S,E,B,y,L,V,U=n[21].t("LLMs can make mistakes. Verify important information.")+"",M,I,C,W,R;e=new fa({props:{show:n[18]}});let A=n[2]===!1&&n[11].length>0&&en(n),j=n[0]!==void 0&&tn(n);function G(Y){n[35](Y)}function x(Y){n[36](Y)}let F={};n[1]!==void 0&&(F.prompt=n[1]),n[3]!==void 0&&(F.files=n[3]),f=new La({props:F}),n[34](f),_e.push(()=>He(f,"prompt",G)),_e.push(()=>He(f,"files",x)),f.$on("select",n[37]);const ie=[Ua,Oa],be=[];function Ie(Y,oe){return Y[14]?0:1}return B=Ie(n),y=be[B]=ie[B](n),{c(){ee(e.$$.fragment),t=Z(),l=v("div"),s=v("div"),o=v("div"),r=v("div"),A&&A.c(),i=Z(),a=v("div"),j&&j.c(),c=Z(),ee(f.$$.fragment),p=Z(),k=v("div"),D=v("div"),_=v("div"),S=v("input"),E=Z(),y.c(),L=Z(),V=v("div"),M=ge(U),this.h()},l(Y){te(e.$$.fragment,Y),t=q(Y),l=b(Y,"DIV",{class:!0});var oe=w(l);s=b(oe,"DIV",{class:!0});var lt=w(s);o=b(lt,"DIV",{class:!0});var Ue=w(o);r=b(Ue,"DIV",{class:!0});var J=w(r);A&&A.l(J),J.forEach(h),i=q(Ue),a=b(Ue,"DIV",{class:!0});var Qe=w(a);j&&j.l(Qe),c=q(Qe),te(f.$$.fragment,Qe),Qe.forEach(h),Ue.forEach(h),lt.forEach(h),p=q(oe),k=b(oe,"DIV",{class:!0});var ue=w(k);D=b(ue,"DIV",{class:!0});var X=w(D);_=b(X,"DIV",{class:!0});var $=w(_);S=b($,"INPUT",{type:!0}),E=q($),y.l($),L=q($),V=b($,"DIV",{class:!0});var ot=w(V);M=pe(ot,U),ot.forEach(h),$.forEach(h),X.forEach(h),ue.forEach(h),oe.forEach(h),this.h()},h(){u(r,"class","relative"),u(a,"class","w-full relative"),u(o,"class","flex flex-col max-w-6xl px-2.5 md:px-6 w-full"),u(s,"class","-mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center"),u(S,"type","file"),S.hidden=!0,S.multiple=!0,u(V,"class","mt-1.5 text-xs text-gray-500 text-center line-clamp-1"),u(_,"class","pb-2"),u(D,"class","max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0"),u(k,"class",I=n[6]?"bg-transparent":"bg-white dark:bg-gray-900"),u(l,"class","w-full font-primary")},m(Y,oe){le(e,Y,oe),z(Y,t,oe),z(Y,l,oe),g(l,s),g(s,o),g(o,r),A&&A.m(r,null),g(o,i),g(o,a),j&&j.m(a,null),g(a,c),le(f,a,null),g(l,p),g(l,k),g(k,D),g(D,_),g(_,S),n[38](S),g(_,E),be[B].m(_,null),g(_,L),g(_,V),g(V,M),C=!0,W||(R=[ce(S,"change",n[39]),ce(S,"change",n[40])],W=!0)},p(Y,oe){const lt={};oe[0]&262144&&(lt.show=Y[18]),e.$set(lt),Y[2]===!1&&Y[11].length>0?A?A.p(Y,oe):(A=en(Y),A.c(),A.m(r,null)):A&&(A.d(1),A=null),Y[0]!==void 0?j?(j.p(Y,oe),oe[0]&1&&N(j,1)):(j=tn(Y),j.c(),N(j,1),j.m(a,c)):j&&(Re(),O(j,1,1,()=>{j=null}),Fe());const Ue={};!d&&oe[0]&2&&(d=!0,Ue.prompt=Y[1],Me(()=>d=!1)),!m&&oe[0]&8&&(m=!0,Ue.files=Y[3],Me(()=>m=!1)),f.$set(Ue);let J=B;B=Ie(Y),B===J?be[B].p(Y,oe):(Re(),O(be[J],1,1,()=>{be[J]=null}),Fe(),y=be[B],y?y.p(Y,oe):(y=be[B]=ie[B](Y),y.c()),N(y,1),y.m(_,L)),(!C||oe[0]&2097152)&&U!==(U=Y[21].t("LLMs can make mistakes. Verify important information.")+"")&&ye(M,U),(!C||oe[0]&64&&I!==(I=Y[6]?"bg-transparent":"bg-white dark:bg-gray-900"))&&u(k,"class",I)},i(Y){C||(N(e.$$.fragment,Y),N(j),N(f.$$.fragment,Y),N(y),C=!0)},o(Y){O(e.$$.fragment,Y),O(j),O(f.$$.fragment,Y),O(y),C=!1},d(Y){Y&&(h(t),h(l)),se(e,Y),A&&A.d(),j&&j.d(),n[34](null),se(f),n[38](null),be[B].d(),W=!1,zt(R)}}}function Ka(n,e,t){let l,s,o,r,i,a,c;me(n,Tl,H=>t(22,s=H)),me(n,Ol,H=>t(13,o=H)),me(n,Xt,H=>t(23,r=H)),me(n,zn,H=>t(24,i=H)),me(n,Ul,H=>t(25,a=H)),me(n,Yn,H=>t(26,c=H));const f=el(),d=bt("i18n");me(n,d,H=>t(21,l=H));let{transparentBackground:m=!1}=e,{submitPrompt:p}=e,{stopResponse:k}=e,{autoScroll:D=!1}=e,{atSelectedModel:_}=e,{selectedModels:S}=e,E=!1,B,y,L,V,U=!1,M=null,{files:I=[]}=e,{availableToolIds:C=[]}=e,{selectedToolIds:W=[]}=e,{webSearchEnabled:R=!1}=e,{prompt:A=""}=e,{messages:j=[]}=e,G=[];const x=()=>{const H=document.getElementById("messages-container");H.scrollTo({top:H.scrollHeight,behavior:"smooth"})},F=async H=>{if(console.log(H),["audio/mpeg","audio/wav"].includes(H.type)){const de=await ns(localStorage.token,H).catch(Te=>(Ce.error(Te),null));if(de){console.log(de);const Te=new Blob([de.text],{type:"text/plain"});H=ss(Te,`${H.name}.txt`)}}const ne={type:"file",file:"",id:null,url:"",name:H.name,collection_name:"",status:"",size:H.size,error:""};t(3,I=[...I,ne]);try{const de=await pr(localStorage.token,H);de?(ne.status="uploaded",ne.file=de,ne.id=de.id,ne.url=`${Xn}/files/${de.id}`,$n.includes(H.type)||er.includes(H.name.split(".").at(-1))||Ce.error(l.t("Unknown file type '{{file_type}}'. Proceeding with the file upload anyway.",{file_type:H.type})),ie(ne)):t(3,I=I.filter(Te=>Te.status!==null))}catch(de){Ce.error(de),t(3,I=I.filter(Te=>Te.status!==null))}},ie=async H=>{try{const ne=await _r(localStorage.token,H.id);ne&&(H.status="processed",H.collection_name=ne.collection_name,t(3,I))}catch(ne){Ce.error(ne),H.status="processed",t(3,I)}},be=async H=>{H.forEach(ne=>{var de,Te,Ve;if(console.log(ne,ne.name.split(".").at(-1)),(((de=s==null?void 0:s.file)==null?void 0:de.max_size)??null)!==null&&ne.size>(((Te=s==null?void 0:s.file)==null?void 0:Te.max_size)??0)*1024*1024){Ce.error(l.t("File size should not exceed {{maxSize}} MB.",{maxSize:(Ve=s==null?void 0:s.file)==null?void 0:Ve.max_size}));return}if(["image/gif","image/webp","image/jpeg","image/png"].includes(ne.type)){if(G.length===0){Ce.error(l.t("Selected model(s) do not support image inputs"));return}let Oe=new FileReader;Oe.onload=kt=>{t(3,I=[...I,{type:"image",url:`${kt.target.result}`}])},Oe.readAsDataURL(ne)}else F(ne)})};wl(()=>{window.setTimeout(()=>B==null?void 0:B.focus(),0);const H=document.querySelector("body"),ne=Oe=>{Oe.key==="Escape"&&(console.log("Escape"),t(18,U=!1))},de=Oe=>{Oe.preventDefault(),t(18,U=!0)},Te=()=>{t(18,U=!1)},Ve=async Oe=>{var kt,Tt;if(Oe.preventDefault(),console.log(Oe),(kt=Oe.dataTransfer)!=null&&kt.files){const ll=Array.from((Tt=Oe.dataTransfer)==null?void 0:Tt.files);ll&&ll.length>0?(console.log(ll),be(ll)):Ce.error(l.t("File not found."))}t(18,U=!1)};return window.addEventListener("keydown",ne),H==null||H.addEventListener("dragover",de),H==null||H.addEventListener("drop",Ve),H==null||H.addEventListener("dragleave",Te),()=>{window.removeEventListener("keydown",ne),H==null||H.removeEventListener("dragover",de),H==null||H.removeEventListener("drop",Ve),H==null||H.removeEventListener("dragleave",Te)}});const Ie=()=>{t(2,D=!0),x()},Y=H=>H.id===_.id,oe=()=>{t(0,_=void 0)};function lt(H){_e[H?"unshift":"push"](()=>{L=H,t(16,L)})}function Ue(H){A=H,t(1,A)}function J(H){I=H,t(3,I)}const Qe=H=>{const ne=H.detail;(ne==null?void 0:ne.type)==="model"&&t(0,_=ne.data),B==null||B.focus()};function ue(H){_e[H?"unshift":"push"](()=>{y=H,t(15,y)})}function X(){V=this.files,t(17,V)}const $=async()=>{if(V&&V.length>0){const H=Array.from(V);be(H)}else Ce.error(l.t("File not found."));t(15,y.value="",y)};function ot(H){E=H,t(14,E)}const ht=async()=>{var H;t(14,E=!1),await Be(),(H=document.getElementById("chat-textarea"))==null||H.focus()},Ct=async H=>{var de;const ne=H.detail;t(1,A=`${A}${ne} `),t(14,E=!1),await Be(),(de=document.getElementById("chat-textarea"))==null||de.focus(),((r==null?void 0:r.speechAutoSend)??!1)&&p(A)},Ot=H=>!G.includes(H),ct=H=>{I.splice(H,1),t(3,I)},Ye=H=>{I.splice(H,1),t(3,I)},gt=(H,ne,de,Te)=>((C.includes(ne.id)||((a==null?void 0:a.role)??"user")==="admin")&&(H[ne.id]={name:ne.name,description:ne.meta.description,enabled:!1}),H),K=()=>{y.click()},ve=async()=>{await Be(),B==null||B.focus()};function We(H){R=H,t(5,R)}function rt(H){W=H,t(4,W)}function $e(H){_e[H?"unshift":"push"](()=>{B=H,t(12,B),t(1,A)})}function wt(){A=this.value,t(1,A)}const _t=H=>{(!c||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(H.key==="Enter"&&!H.shiftKey&&H.preventDefault(),A!==""&&H.key==="Enter"&&!H.shiftKey&&p(A))},Gt=async H=>{var Te;const ne=H.ctrlKey||H.metaKey,de=document.getElementById("commands-container");if(A===""&&ne&&H.key.toLowerCase()==="r"){H.preventDefault(),console.log("regenerate");const Ve=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Ve==null||Ve.click()}if(A===""&&H.key=="ArrowUp"){H.preventDefault();const Ve=[...document.getElementsByClassName("user-message")].at(-1),Oe=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(Ve),Ve.scrollIntoView({block:"center"}),Oe==null||Oe.click()}if(de&&H.key==="ArrowUp"&&(H.preventDefault(),L.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),de&&H.key==="ArrowDown"&&(H.preventDefault(),L.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),de&&H.key==="Enter"){H.preventDefault();const Ve=[...document.getElementsByClassName("selected-command-option-button")].at(-1);H.shiftKey?t(1,A=`${A}
`):Ve?Ve==null||Ve.click():(Te=document.getElementById("send-message-button"))==null||Te.click()}if(de&&H.key==="Tab"){H.preventDefault();const Ve=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Ve==null||Ve.click()}else if(H.key==="Tab"){const Ve=Un(A);if(Ve.length>0){const Oe=Ve.at(0),kt=A;t(1,A=A.substring(0,(Oe==null?void 0:Oe.endIndex)+1)),await Be(),H.target.scrollTop=H.target.scrollHeight,t(1,A=kt),await Be(),H.preventDefault(),H.target.setSelectionRange(Oe==null?void 0:Oe.startIndex,Oe.endIndex+1)}H.target.style.height="",H.target.style.height=Math.min(H.target.scrollHeight,200)+"px"}H.key==="Escape"&&(console.log("Escape"),t(0,_=void 0))},tl=async H=>{H.target.style.height="",H.target.style.height=Math.min(H.target.scrollHeight,200)+"px",t(19,M=null)},St=async H=>{H.target.style.height="",H.target.style.height=Math.min(H.target.scrollHeight,200)+"px"},jt=async H=>{const ne=H.clipboardData||window.clipboardData;if(ne&&ne.items){for(const de of ne.items)if(de.type.indexOf("image")!==-1){const Te=de.getAsFile(),Ve=new FileReader;Ve.onload=function(Oe){t(3,I=[...I,{type:"image",url:`${Oe.target.result}`}])},Ve.readAsDataURL(Te)}}},Q=async()=>{try{let H=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(ne){return Ce.error(l.t("Permission denied when accessing microphone: {{error}}",{error:ne})),null});H&&(t(14,E=!0),H.getTracks().forEach(de=>de.stop())),H=null}catch{Ce.error(l.t("Permission denied when accessing microphone"))}},Se=async()=>{if(S.length>1){Ce.error(l.t("Select only one model to call"));return}if(s.audio.stt.engine==="web"){Ce.error(l.t("Call feature is not supported when using Web STT engine"));return}try{let H=await navigator.mediaDevices.getUserMedia({audio:!0});H&&H.getTracks().forEach(de=>de.stop()),H=null,Cl.set(!0),f("call")}catch{Ce.error(l.t("Permission denied when accessing media devices"))}},we=()=>{k()},Ee=()=>{p(A)};return n.$$set=H=>{"transparentBackground"in H&&t(6,m=H.transparentBackground),"submitPrompt"in H&&t(7,p=H.submitPrompt),"stopResponse"in H&&t(8,k=H.stopResponse),"autoScroll"in H&&t(2,D=H.autoScroll),"atSelectedModel"in H&&t(0,_=H.atSelectedModel),"selectedModels"in H&&t(9,S=H.selectedModels),"files"in H&&t(3,I=H.files),"availableToolIds"in H&&t(10,C=H.availableToolIds),"selectedToolIds"in H&&t(4,W=H.selectedToolIds),"webSearchEnabled"in H&&t(5,R=H.webSearchEnabled),"prompt"in H&&t(1,A=H.prompt),"messages"in H&&t(11,j=H.messages)},n.$$.update=()=>{n.$$.dirty[0]&8705&&t(20,G=[..._?[_]:S].filter(H=>{var ne,de,Te,Ve;return((Ve=(Te=(de=(ne=o.find(Oe=>Oe.id===H))==null?void 0:ne.info)==null?void 0:de.meta)==null?void 0:Te.capabilities)==null?void 0:Ve.vision)??!0})),n.$$.dirty[0]&4098&&A&&B&&(t(12,B.style.height="",B),t(12,B.style.height=Math.min(B.scrollHeight,200)+"px",B))},[_,A,D,I,W,R,m,p,k,S,C,j,B,o,E,y,L,V,U,M,G,l,s,r,i,a,c,f,d,x,be,Ie,Y,oe,lt,Ue,J,Qe,ue,X,$,ot,ht,Ct,Ot,ct,Ye,gt,K,ve,We,rt,$e,wt,_t,Gt,tl,St,jt,Q,Se,we,Ee]}class Ya extends Je{constructor(e){super(),Ge(this,e,Ka,Qa,xe,{transparentBackground:6,submitPrompt:7,stopResponse:8,autoScroll:2,atSelectedModel:0,selectedModels:9,files:3,availableToolIds:10,selectedToolIds:4,webSearchEnabled:5,prompt:1,messages:11},null,[-1,-1,-1])}}function on(n,e,t){const l=n.slice();return l[13]=e[t],l[14]=e,l[15]=t,l}function Xa(n){let e,t,l;return t=new qt({props:{content:n[4].t("Remove Model"),$$slots:{default:[ei]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&16&&(r.content=s[4].t("Remove Model")),o&65539&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function $a(n){let e,t,l;return t=new qt({props:{content:n[4].t("Add Model"),$$slots:{default:[ti]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&16&&(r.content=s[4].t("Add Model")),o&65539&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function ei(n){let e,t,l,s,o;function r(){return n[11](n[15])}return{c(){e=v("button"),t=Ne("svg"),l=Ne("path"),this.h()},l(i){e=b(i,"BUTTON",{"aria-label":!0});var a=w(e);t=ze(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=w(t);l=ze(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),c.forEach(h),a.forEach(h),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"d","M19.5 12h-15"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke-width","2"),u(t,"stroke","currentColor"),u(t,"class","size-3"),e.disabled=n[1],u(e,"aria-label","Remove Model")},m(i,a){z(i,e,a),g(e,t),g(t,l),s||(o=ce(e,"click",r),s=!0)},p(i,a){n=i,a&2&&(e.disabled=n[1])},d(i){i&&h(e),s=!1,o()}}}function ti(n){let e,t,l,s,o;return{c(){e=v("button"),t=Ne("svg"),l=Ne("path"),this.h()},l(r){e=b(r,"BUTTON",{class:!0,"aria-label":!0});var i=w(e);t=ze(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=w(t);l=ze(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),a.forEach(h),i.forEach(h),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"d","M12 6v12m6-6H6"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke-width","2"),u(t,"stroke","currentColor"),u(t,"class","size-3.5"),u(e,"class",""),e.disabled=n[1],u(e,"aria-label","Add Model")},m(r,i){z(r,e,i),g(e,t),g(t,l),s||(o=ce(e,"click",n[10]),s=!0)},p(r,i){i&2&&(e.disabled=r[1])},d(r){r&&h(e),s=!1,o()}}}function an(n){var _,S,E;let e,t,l,s,o,r,i,a,c,f;function d(B){n[9](B,n[13],n[14],n[15])}let m={placeholder:n[4].t("Select a model"),items:n[3].map(fn),showTemporaryChatControl:n[5].role==="user"?((E=(S=(_=n[6])==null?void 0:_.permissions)==null?void 0:S.chat)==null?void 0:E.temporary)??!0:!0};n[13]!==void 0&&(m.value=n[13]),s=new Ur({props:m}),_e.push(()=>He(s,"value",d));const p=[$a,Xa],k=[];function D(B,y){return B[15]===0?0:1}return i=D(n),a=k[i]=p[i](n),{c(){e=v("div"),t=v("div"),l=v("div"),ee(s.$$.fragment),r=Z(),a.c(),c=Z(),this.h()},l(B){e=b(B,"DIV",{class:!0});var y=w(e);t=b(y,"DIV",{class:!0});var L=w(t);l=b(L,"DIV",{class:!0});var V=w(l);te(s.$$.fragment,V),V.forEach(h),L.forEach(h),r=q(y),a.l(y),c=q(y),y.forEach(h),this.h()},h(){u(l,"class","mr-1 max-w-full"),u(t,"class","overflow-hidden w-full"),u(e,"class","flex w-full max-w-fit")},m(B,y){z(B,e,y),g(e,t),g(t,l),le(s,l,null),g(e,r),k[i].m(e,null),g(e,c),f=!0},p(B,y){var V,U,M;n=B;const L={};y&16&&(L.placeholder=n[4].t("Select a model")),y&8&&(L.items=n[3].map(fn)),y&96&&(L.showTemporaryChatControl=n[5].role==="user"?((M=(U=(V=n[6])==null?void 0:V.permissions)==null?void 0:U.chat)==null?void 0:M.temporary)??!0:!0),!o&&y&1&&(o=!0,L.value=n[13],Me(()=>o=!1)),s.$set(L),a.p(n,y)},i(B){f||(N(s.$$.fragment,B),N(a),f=!0)},o(B){O(s.$$.fragment,B),O(a),f=!1},d(B){B&&h(e),se(s),k[i].d()}}}function cn(n){let e,t,l=n[4].t("Set as default")+"",s,o,r;return{c(){e=v("div"),t=v("button"),s=ge(l),this.h()},l(i){e=b(i,"DIV",{class:!0});var a=w(e);t=b(a,"BUTTON",{});var c=w(t);s=pe(c,l),c.forEach(h),a.forEach(h),this.h()},h(){u(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary")},m(i,a){z(i,e,a),g(e,t),g(t,s),o||(r=ce(t,"click",n[8]),o=!0)},p(i,a){a&16&&l!==(l=i[4].t("Set as default")+"")&&ye(s,l)},d(i){i&&h(e),o=!1,r()}}}function li(n){let e,t,l,s,o=it(n[0]),r=[];for(let c=0;c<o.length;c+=1)r[c]=an(on(n,o,c));const i=c=>O(r[c],1,1,()=>{r[c]=null});let a=n[2]&&cn(n);return{c(){e=v("div");for(let c=0;c<r.length;c+=1)r[c].c();t=Z(),a&&a.c(),l=Pe(),this.h()},l(c){e=b(c,"DIV",{class:!0});var f=w(e);for(let d=0;d<r.length;d+=1)r[d].l(f);f.forEach(h),t=q(c),a&&a.l(c),l=Pe(),this.h()},h(){u(e,"class","flex flex-col w-full items-start")},m(c,f){z(c,e,f);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(e,null);z(c,t,f),a&&a.m(c,f),z(c,l,f),s=!0},p(c,[f]){if(f&123){o=it(c[0]);let d;for(d=0;d<o.length;d+=1){const m=on(c,o,d);r[d]?(r[d].p(m,f),N(r[d],1)):(r[d]=an(m),r[d].c(),N(r[d],1),r[d].m(e,null))}for(Re(),d=o.length;d<r.length;d+=1)i(d);Fe()}c[2]?a?a.p(c,f):(a=cn(c),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i(c){if(!s){for(let f=0;f<o.length;f+=1)N(r[f]);s=!0}},o(c){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)O(r[f]);s=!1},d(c){c&&(h(e),h(t),h(l)),xt(r,c),a&&a.d(c)}}}const fn=n=>({value:n.id,label:n.name,model:n});function si(n,e,t){let l,s,o,r,i;me(n,Ol,_=>t(3,l=_)),me(n,Xt,_=>t(12,o=_)),me(n,Ul,_=>t(5,r=_)),me(n,Tl,_=>t(6,i=_));const a=bt("i18n");me(n,a,_=>t(4,s=_));let{selectedModels:c=[""]}=e,{disabled:f=!1}=e,{showSetDefault:d=!0}=e;const m=async()=>{if(c.filter(S=>S==="").length){Ce.error(s.t("Choose a model before saving..."));return}Xt.set({...o,models:c}),await cr(localStorage.token,{ui:o}),Ce.success(s.t("Default model updated"))};function p(_,S,E,B){E[B]=_,t(0,c),t(3,l)}const k=()=>{t(0,c=[...c,""])},D=_=>{c.splice(_,1),t(0,c),t(3,l)};return n.$$set=_=>{"selectedModels"in _&&t(0,c=_.selectedModels),"disabled"in _&&t(1,f=_.disabled),"showSetDefault"in _&&t(2,d=_.showSetDefault)},n.$$.update=()=>{n.$$.dirty&9&&c.length>0&&l.length>0&&t(0,c=c.map(_=>l.map(S=>S.id).includes(_)?_:""))},[c,f,d,l,s,r,i,a,m,p,k,D]}class ni extends Je{constructor(e){super(),Ge(this,e,si,li,xe,{selectedModels:0,disabled:1,showSetDefault:2})}}function ri(n){let e;const t=n[10].default,l=Ht(t,n,n[16],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&65536)&&Bt(l,t,s,s[16],e?Nt(t,s[16],o,null):Lt(s[16]),null)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function oi(n){let e,t,l,s,o=n[3].t("Share")+"",r;return{c(){e=Ne("svg"),t=Ne("path"),l=Z(),s=v("div"),r=ge(o),this.h()},l(i){e=ze(i,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=w(e);t=ze(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),a.forEach(h),l=q(i),s=b(i,"DIV",{class:!0});var c=w(s);r=pe(c,o),c.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),u(t,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"class","size-4"),u(s,"class","flex items-center")},m(i,a){z(i,e,a),g(e,t),z(i,l,a),z(i,s,a),g(s,r)},p(i,a){a&8&&o!==(o=i[3].t("Share")+"")&&ye(r,o)},d(i){i&&(h(e),h(l),h(s))}}}function ai(n){let e,t,l,s,o=n[3].t("Download")+"",r;return{c(){e=Ne("svg"),t=Ne("path"),l=Z(),s=v("div"),r=ge(o),this.h()},l(i){e=ze(i,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=w(e);t=ze(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),a.forEach(h),l=q(i),s=b(i,"DIV",{class:!0});var c=w(s);r=pe(c,o),c.forEach(h),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"class","size-4"),u(s,"class","flex items-center")},m(i,a){z(i,e,a),g(e,t),z(i,l,a),z(i,s,a),g(s,r)},p(i,a){a&8&&o!==(o=i[3].t("Download")+"")&&ye(r,o)},d(i){i&&(h(e),h(l),h(s))}}}function ii(n){let e,t=n[3].t("Export chat (.json)")+"",l;return{c(){e=v("div"),l=ge(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);l=pe(o,t),o.forEach(h),this.h()},h(){u(e,"class","flex items-center line-clamp-1")},m(s,o){z(s,e,o),g(e,l)},p(s,o){o&8&&t!==(t=s[3].t("Export chat (.json)")+"")&&ye(l,t)},d(s){s&&h(e)}}}function ci(n){let e,t=n[3].t("Plain text (.txt)")+"",l;return{c(){e=v("div"),l=ge(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);l=pe(o,t),o.forEach(h),this.h()},h(){u(e,"class","flex items-center line-clamp-1")},m(s,o){z(s,e,o),g(e,l)},p(s,o){o&8&&t!==(t=s[3].t("Plain text (.txt)")+"")&&ye(l,t)},d(s){s&&h(e)}}}function fi(n){let e,t=n[3].t("PDF document (.pdf)")+"",l;return{c(){e=v("div"),l=ge(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var o=w(e);l=pe(o,t),o.forEach(h),this.h()},h(){u(e,"class","flex items-center line-clamp-1")},m(s,o){z(s,e,o),g(e,l)},p(s,o){o&8&&t!==(t=s[3].t("PDF document (.pdf)")+"")&&ye(l,t)},d(s){s&&h(e)}}}function ui(n){let e,t,l,s,o,r;return e=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[ii]},$$scope:{ctx:n}}}),e.$on("click",n[12]),l=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[ci]},$$scope:{ctx:n}}}),l.$on("click",n[13]),o=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[fi]},$$scope:{ctx:n}}}),o.$on("click",n[14]),{c(){ee(e.$$.fragment),t=Z(),ee(l.$$.fragment),s=Z(),ee(o.$$.fragment)},l(i){te(e.$$.fragment,i),t=q(i),te(l.$$.fragment,i),s=q(i),te(o.$$.fragment,i)},m(i,a){le(e,i,a),z(i,t,a),le(l,i,a),z(i,s,a),le(o,i,a),r=!0},p(i,a){const c={};a&65544&&(c.$$scope={dirty:a,ctx:i}),e.$set(c);const f={};a&65544&&(f.$$scope={dirty:a,ctx:i}),l.$set(f);const d={};a&65544&&(d.$$scope={dirty:a,ctx:i}),o.$set(d)},i(i){r||(N(e.$$.fragment,i),N(l.$$.fragment,i),N(o.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),O(l.$$.fragment,i),O(o.$$.fragment,i),r=!1},d(i){i&&(h(t),h(s)),se(e,i),se(l,i),se(o,i)}}}function di(n){let e,t,l,s;return e=new Co({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[ai]},$$scope:{ctx:n}}}),l=new bo({props:{class:"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:Al,sideOffset:8,$$slots:{default:[ui]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment),t=Z(),ee(l.$$.fragment)},l(o){te(e.$$.fragment,o),t=q(o),te(l.$$.fragment,o)},m(o,r){le(e,o,r),z(o,t,r),le(l,o,r),s=!0},p(o,r){const i={};r&65544&&(i.$$scope={dirty:r,ctx:o}),e.$set(i);const a={};r&65544&&(a.$$scope={dirty:r,ctx:o}),l.$set(a)},i(o){s||(N(e.$$.fragment,o),N(l.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),O(l.$$.fragment,o),s=!1},d(o){o&&h(t),se(e,o),se(l,o)}}}function hi(n){let e,t,l,s,o,r,i,a,c;return e=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[oi]},$$scope:{ctx:n}}}),e.$on("click",n[11]),l=new so({props:{$$slots:{default:[di]},$$scope:{ctx:n}}}),a=new br({props:{chatId:n[1].id}}),{c(){ee(e.$$.fragment),t=Z(),ee(l.$$.fragment),s=Z(),o=v("hr"),r=Z(),i=v("div"),ee(a.$$.fragment),this.h()},l(f){te(e.$$.fragment,f),t=q(f),te(l.$$.fragment,f),s=q(f),o=b(f,"HR",{class:!0}),r=q(f),i=b(f,"DIV",{class:!0});var d=w(i);te(a.$$.fragment,d),d.forEach(h),this.h()},h(){u(o,"class","border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5"),u(i,"class","flex p-1")},m(f,d){le(e,f,d),z(f,t,d),le(l,f,d),z(f,s,d),z(f,o,d),z(f,r,d),z(f,i,d),le(a,i,null),c=!0},p(f,d){const m={};d&65544&&(m.$$scope={dirty:d,ctx:f}),e.$set(m);const p={};d&65544&&(p.$$scope={dirty:d,ctx:f}),l.$set(p);const k={};d&2&&(k.chatId=f[1].id),a.$set(k)},i(f){c||(N(e.$$.fragment,f),N(l.$$.fragment,f),N(a.$$.fragment,f),c=!0)},o(f){O(e.$$.fragment,f),O(l.$$.fragment,f),O(a.$$.fragment,f),c=!1},d(f){f&&(h(t),h(s),h(o),h(r),h(i)),se(e,f),se(l,f),se(a)}}}function mi(n){let e,t,l;return t=new $l({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:Al,$$slots:{default:[hi]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{slot:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"slot","content")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&65547&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function gi(n){let e,t;return e=new Xl({props:{$$slots:{content:[mi],default:[ri]},$$scope:{ctx:n}}}),e.$on("change",n[15]),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,[s]){const o={};s&65547&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function pi(n,e,t){let l,{$$slots:s={},$$scope:o}=e;const{saveAs:r}=jr,i=bt("i18n");me(n,i,L=>t(3,l=L));let{shareEnabled:a=!1}=e,{shareHandler:c}=e,{downloadHandler:f}=e,{chat:d}=e,{onClose:m=()=>{}}=e;const p=async()=>{const L=d.chat;console.log("download",d);const V=L.messages.reduce((M,I,C,W)=>`${M}### ${I.role.toUpperCase()}
${I.content}

`,"");let U=new Blob([V],{type:"text/plain"});r(U,`chat-${L.title}.txt`)},k=async()=>{const L=d.chat;console.log("download",d);const V=await Rr(L),U=window.URL.createObjectURL(V),M=document.createElement("a");M.href=U,M.download=`chat-${L.title}.pdf`,document.body.appendChild(M),M.click(),document.body.removeChild(M),window.URL.revokeObjectURL(U)},D=async()=>{let L=new Blob([JSON.stringify([d])],{type:"application/json"});r(L,`chat-export-${Date.now()}.json`)},_=()=>{c()},S=()=>{D()},E=()=>{p()},B=()=>{k()},y=L=>{L.detail===!1&&m()};return n.$$set=L=>{"shareEnabled"in L&&t(8,a=L.shareEnabled),"shareHandler"in L&&t(0,c=L.shareHandler),"downloadHandler"in L&&t(9,f=L.downloadHandler),"chat"in L&&t(1,d=L.chat),"onClose"in L&&t(2,m=L.onClose),"$$scope"in L&&t(16,o=L.$$scope)},[c,d,m,l,i,p,k,D,a,f,s,_,S,E,B,y,o]}class _i extends Je{constructor(e){super(),Ge(this,e,pi,gi,xe,{shareEnabled:8,shareHandler:0,downloadHandler:9,chat:1,onClose:2})}}function vi(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var s=w(e);t=ze(s,"path",{d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 0 24 24"),u(e,"stroke","currentColor"),u(e,"fill","currentColor"),u(e,"class",n[0]),u(e,"stroke-width",n[1])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&1&&u(e,"class",l[0]),s&2&&u(e,"stroke-width",l[1])},i:De,o:De,d(l){l&&h(e)}}}function bi(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=o=>{"className"in o&&t(0,l=o.className),"strokeWidth"in o&&t(1,s=o.strokeWidth)},[l,s]}class wi extends Je{constructor(e){super(),Ge(this,e,bi,vi,xe,{className:0,strokeWidth:1})}}function un(n){let e,t,l;function s(r){n[16](r)}let o={showSetDefault:!n[3]};return n[0]!==void 0&&(o.selectedModels=n[0]),e=new ni({props:o}),_e.push(()=>He(e,"selectedModels",s)),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};i&8&&(a.showSetDefault=!r[3]),!t&&i&1&&(t=!0,a.selectedModels=r[0],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function dn(n){let e,t;return e=new _i({props:{chat:n[4],shareEnabled:n[3],shareHandler:n[17],downloadHandler:n[18],$$slots:{default:[ki]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s&16&&(o.chat=l[4]),s&8&&(o.shareEnabled=l[3]),s&64&&(o.shareHandler=l[17]),s&128&&(o.downloadHandler=l[18]),s&8388608&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function ki(n){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=v("button"),e.innerHTML=t,this.h()},l(l){e=b(l,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),qe(e)!=="svelte-1st1t1k"&&(e.innerHTML=t),this.h()},h(){u(e,"class","hidden md:flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),u(e,"id","chat-context-menu-button")},m(l,s){z(l,e,s)},p:De,d(l){l&&h(e)}}}function yi(n){let e,t,l,s,o,r;return l=new wi({props:{className:" size-5",strokeWidth:"0.5"}}),{c(){e=v("button"),t=v("div"),ee(l.$$.fragment),this.h()},l(i){e=b(i,"BUTTON",{class:!0,"aria-label":!0});var a=w(e);t=b(a,"DIV",{class:!0});var c=w(t);te(l.$$.fragment,c),c.forEach(h),a.forEach(h),this.h()},h(){u(t,"class","m-auto self-center"),u(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),u(e,"aria-label","Controls")},m(i,a){z(i,e,a),g(e,t),le(l,t,null),s=!0,o||(r=ce(e,"click",n[19]),o=!0)},p:De,i(i){s||(N(l.$$.fragment,i),s=!0)},o(i){O(l.$$.fragment,i),s=!1},d(i){i&&h(e),se(l),o=!1,r()}}}function Ei(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"></path><path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"></path></svg>',s,o,r;return{c(){e=v("button"),t=v("div"),t.innerHTML=l,this.h()},l(i){e=b(i,"BUTTON",{id:!0,class:!0,"aria-label":!0});var a=w(e);t=b(a,"DIV",{class:!0,"data-svelte-h":!0}),qe(t)!=="svelte-1fcii9y"&&(t.innerHTML=l),a.forEach(h),this.h()},h(){u(t,"class","m-auto self-center"),u(e,"id","new-chat-button"),u(e,"class",s="flex "+(n[9]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),u(e,"aria-label","New Chat")},m(i,a){z(i,e,a),g(e,t),o||(r=ce(e,"click",n[20]),o=!0)},p(i,a){a&512&&s!==(s="flex "+(i[9]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition")&&u(e,"class",s)},d(i){i&&h(e),o=!1,r()}}}function hn(n){let e,t;return e=new kr({props:{className:"max-w-[200px]",role:n[11].role,$$slots:{default:[Ii]},$$scope:{ctx:n}}}),e.$on("show",n[21]),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s&2048&&(o.role=l[11].role),s&8390656&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Ii(n){let e,t,l,s;return{c(){e=v("button"),t=v("div"),l=v("img"),this.h()},l(o){e=b(o,"BUTTON",{class:!0,"aria-label":!0});var r=w(e);t=b(r,"DIV",{class:!0});var i=w(t);l=b(i,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),i.forEach(h),r.forEach(h),this.h()},h(){nl(l.src,s=n[11].profile_image_url)||u(l,"src",s),u(l,"class","size-6 object-cover rounded-full"),u(l,"alt","User profile"),u(l,"draggable","false"),u(t,"class","self-center"),u(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition"),u(e,"aria-label","User Menu")},m(o,r){z(o,e,r),g(e,t),g(t,l)},p(o,r){r&2048&&!nl(l.src,s=o[11].profile_image_url)&&u(l,"src",s)},d(o){o&&h(e)}}}function Di(n){let e,t,l,s,o,r,i,a,c,f,d,m,p,k,D,_,S,E,B,y,L,V,U;function M(A){n[14](A)}let I={chatId:n[8]};n[6]!==void 0&&(I.show=n[6]),e=new wr({props:I}),_e.push(()=>He(e,"show",M)),f=new Fr({});let C=n[5]&&un(n),W=n[3]&&n[4]&&n[4].id&&dn(n);S=new qt({props:{content:n[10].t("Controls"),$$slots:{default:[yi]},$$scope:{ctx:n}}}),B=new qt({props:{content:n[10].t("New Chat"),$$slots:{default:[Ei]},$$scope:{ctx:n}}});let R=n[11]!==void 0&&hn(n);return{c(){ee(e.$$.fragment),l=Z(),s=v("nav"),o=v("div"),r=v("div"),i=v("div"),a=v("button"),c=v("div"),ee(f.$$.fragment),m=Z(),p=v("div"),C&&C.c(),k=Z(),D=v("div"),W&&W.c(),_=Z(),ee(S.$$.fragment),E=Z(),ee(B.$$.fragment),y=Z(),R&&R.c(),this.h()},l(A){te(e.$$.fragment,A),l=q(A),s=b(A,"NAV",{id:!0,class:!0});var j=w(s);o=b(j,"DIV",{class:!0});var G=w(o);r=b(G,"DIV",{class:!0});var x=w(r);i=b(x,"DIV",{class:!0});var F=w(i);a=b(F,"BUTTON",{id:!0,class:!0,"aria-label":!0});var ie=w(a);c=b(ie,"DIV",{class:!0});var be=w(c);te(f.$$.fragment,be),be.forEach(h),ie.forEach(h),F.forEach(h),m=q(x),p=b(x,"DIV",{class:!0});var Ie=w(p);C&&C.l(Ie),Ie.forEach(h),k=q(x),D=b(x,"DIV",{class:!0});var Y=w(D);W&&W.l(Y),_=q(Y),te(S.$$.fragment,Y),E=q(Y),te(B.$$.fragment,Y),y=q(Y),R&&R.l(Y),Y.forEach(h),x.forEach(h),G.forEach(h),j.forEach(h),this.h()},h(){u(c,"class","m-auto self-center"),u(a,"id","sidebar-toggle-button"),u(a,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),u(a,"aria-label","Toggle Sidebar"),u(i,"class",d=(n[9]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),u(p,"class","flex-1 overflow-hidden max-w-full"),u(D,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),u(r,"class","flex items-center w-full max-w-full"),u(o,"class","flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]"),u(s,"id","nav"),u(s,"class","sticky py-2.5 top-0 flex flex-row justify-center z-10")},m(A,j){le(e,A,j),z(A,l,j),z(A,s,j),g(s,o),g(o,r),g(r,i),g(i,a),g(a,c),le(f,c,null),g(r,m),g(r,p),C&&C.m(p,null),g(r,k),g(r,D),W&&W.m(D,null),g(D,_),le(S,D,null),g(D,E),le(B,D,null),g(D,y),R&&R.m(D,null),L=!0,V||(U=ce(a,"click",n[15]),V=!0)},p(A,[j]){const G={};j&256&&(G.chatId=A[8]),!t&&j&64&&(t=!0,G.show=A[6],Me(()=>t=!1)),e.$set(G),(!L||j&512&&d!==(d=(A[9]?"md:hidden":"")+" mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&u(i,"class",d),A[5]?C?(C.p(A,j),j&32&&N(C,1)):(C=un(A),C.c(),N(C,1),C.m(p,null)):C&&(Re(),O(C,1,1,()=>{C=null}),Fe()),A[3]&&A[4]&&A[4].id?W?(W.p(A,j),j&24&&N(W,1)):(W=dn(A),W.c(),N(W,1),W.m(D,_)):W&&(Re(),O(W,1,1,()=>{W=null}),Fe());const x={};j&1024&&(x.content=A[10].t("Controls")),j&8388610&&(x.$$scope={dirty:j,ctx:A}),S.$set(x);const F={};j&1024&&(F.content=A[10].t("New Chat")),j&8389124&&(F.$$scope={dirty:j,ctx:A}),B.$set(F),A[11]!==void 0?R?(R.p(A,j),j&2048&&N(R,1)):(R=hn(A),R.c(),N(R,1),R.m(D,null)):R&&(Re(),O(R,1,1,()=>{R=null}),Fe())},i(A){L||(N(e.$$.fragment,A),N(f.$$.fragment,A),N(C),N(W),N(S.$$.fragment,A),N(B.$$.fragment,A),N(R),L=!0)},o(A){O(e.$$.fragment,A),O(f.$$.fragment,A),O(C),O(W),O(S.$$.fragment,A),O(B.$$.fragment,A),O(R),L=!1},d(A){A&&(h(l),h(s)),se(e,A),se(f),C&&C.d(),W&&W.d(),se(S),se(B),R&&R.d(),V=!1,U()}}}function Ci(n,e,t){let l,s,o,r,i;me(n,On,C=>t(22,l=C)),me(n,bl,C=>t(8,s=C)),me(n,Kl,C=>t(9,o=C)),me(n,Ul,C=>t(11,i=C));const a=bt("i18n");me(n,a,C=>t(10,r=C));let{initNewChat:c}=e,{title:f=l}=e,{shareEnabled:d=!1}=e,{chat:m}=e,{selectedModels:p}=e,{showModelSelector:k=!0}=e,{showControls:D=!1}=e,_=!1,S=!1;function E(C){_=C,t(6,_)}const B=()=>{Kl.set(!o)};function y(C){p=C,t(0,p)}const L=()=>{t(6,_=!_)},V=()=>{t(7,S=!S)},U=()=>{t(1,D=!D)},M=()=>{c()},I=C=>{C.detail==="archived-chat"&&tr.set(!0)};return n.$$set=C=>{"initNewChat"in C&&t(2,c=C.initNewChat),"title"in C&&t(13,f=C.title),"shareEnabled"in C&&t(3,d=C.shareEnabled),"chat"in C&&t(4,m=C.chat),"selectedModels"in C&&t(0,p=C.selectedModels),"showModelSelector"in C&&t(5,k=C.showModelSelector),"showControls"in C&&t(1,D=C.showControls)},[p,D,c,d,m,k,_,S,s,o,r,i,a,f,E,B,y,L,V,U,M,I]}class Si extends Je{constructor(e){super(),Ge(this,e,Ci,Di,xe,{initNewChat:2,title:13,shareEnabled:3,chat:4,selectedModels:0,showModelSelector:5,showControls:1})}}function mn(n,e,t){const l=n.slice();return l[23]=e[t],l[25]=t,l}function gn(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function Ti(n){let e,t=n[5].t("Select a function")+"",l,s,o=it(n[7]),r=[];for(let i=0;i<o.length;i+=1)r[i]=pn(mn(n,o,i));return{c(){e=v("option"),l=ge(t);for(let i=0;i<r.length;i+=1)r[i].c();s=Pe(),this.h()},l(i){e=b(i,"OPTION",{class:!0});var a=w(e);l=pe(a,t),a.forEach(h);for(let c=0;c<r.length;c+=1)r[c].l(i);s=Pe(),this.h()},h(){e.__value="",Zt(e,e.__value),e.selected=!0,e.disabled=!0,u(e,"class","bg-gray-100 dark:bg-gray-800")},m(i,a){z(i,e,a),g(e,l);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(i,a);z(i,s,a)},p(i,a){if(a&32&&t!==(t=i[5].t("Select a function")+"")&&ye(l,t),a&128){o=it(i[7]);let c;for(c=0;c<o.length;c+=1){const f=mn(i,o,c);r[c]?r[c].p(f,a):(r[c]=pn(f),r[c].c(),r[c].m(s.parentNode,s))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(i){i&&(h(e),h(s)),xt(r,i)}}}function Vi(n){let e,t=n[5].t("Select a tool")+"",l,s,o=it(n[6]),r=[];for(let i=0;i<o.length;i+=1)r[i]=_n(gn(n,o,i));return{c(){e=v("option"),l=ge(t);for(let i=0;i<r.length;i+=1)r[i].c();s=Pe(),this.h()},l(i){e=b(i,"OPTION",{class:!0});var a=w(e);l=pe(a,t),a.forEach(h);for(let c=0;c<r.length;c+=1)r[c].l(i);s=Pe(),this.h()},h(){e.__value="",Zt(e,e.__value),e.selected=!0,e.disabled=!0,u(e,"class","bg-gray-100 dark:bg-gray-800")},m(i,a){z(i,e,a),g(e,l);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(i,a);z(i,s,a)},p(i,a){if(a&32&&t!==(t=i[5].t("Select a tool")+"")&&ye(l,t),a&64){o=it(i[6]);let c;for(c=0;c<o.length;c+=1){const f=gn(i,o,c);r[c]?r[c].p(f,a):(r[c]=_n(f),r[c].c(),r[c].m(s.parentNode,s))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(i){i&&(h(e),h(s)),xt(r,i)}}}function pn(n){let e,t=n[23].name+"",l,s;return{c(){e=v("option"),l=ge(t),this.h()},l(o){e=b(o,"OPTION",{class:!0});var r=w(e);l=pe(r,t),r.forEach(h),this.h()},h(){e.__value=s=n[23].id,Zt(e,e.__value),u(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,r){z(o,e,r),g(e,l)},p(o,r){r&128&&t!==(t=o[23].name+"")&&ye(l,t),r&128&&s!==(s=o[23].id)&&(e.__value=s,Zt(e,e.__value))},d(o){o&&h(e)}}}function _n(n){let e,t=n[20].name+"",l,s;return{c(){e=v("option"),l=ge(t),this.h()},l(o){e=b(o,"OPTION",{class:!0});var r=w(e);l=pe(r,t),r.forEach(h),this.h()},h(){e.__value=s=n[20].id,Zt(e,e.__value),u(e,"class","bg-gray-100 dark:bg-gray-800")},m(o,r){z(o,e,r),g(e,l)},p(o,r){r&64&&t!==(t=o[20].name+"")&&ye(l,t),r&64&&s!==(s=o[20].id)&&(e.__value=s,Zt(e,e.__value))},d(o){o&&h(e)}}}function vn(n){let e,t,l,s,o,r;const i=[Hi,Mi],a=[];function c(f,d){return f[2]?1:0}return s=c(n),o=a[s]=i[s](n),{c(){e=v("hr"),t=Z(),l=v("div"),o.c(),this.h()},l(f){e=b(f,"HR",{class:!0}),t=q(f),l=b(f,"DIV",{class:!0});var d=w(l);o.l(d),d.forEach(h),this.h()},h(){u(e,"class","dark:border-gray-800 my-1 w-full"),u(l,"class","my-2 text-xs")},m(f,d){z(f,e,d),z(f,t,d),z(f,l,d),a[s].m(l,null),r=!0},p(f,d){let m=s;s=c(f),s===m?a[s].p(f,d):(Re(),O(a[m],1,1,()=>{a[m]=null}),Fe(),o=a[s],o?o.p(f,d):(o=a[s]=i[s](f),o.c()),N(o,1),o.m(l,null))},i(f){r||(N(o),r=!0)},o(f){O(o),r=!1},d(f){f&&(h(e),h(t),h(l)),a[s].d()}}}function Mi(n){let e,t;return e=new Yr({props:{className:"size-5"}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p:De,i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Hi(n){let e,t,l;function s(r){n[15](r)}let o={valvesSpec:n[3]};return n[4]!==void 0&&(o.valves=n[4]),e=new Xr({props:o}),_e.push(()=>He(e,"valves",s)),e.$on("change",n[16]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};i&8&&(a.valvesSpec=r[3]),!t&&i&16&&(t=!0,a.valves=r[4],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function Bi(n){let e,t,l,s,o,r,i,a=n[5].t("Tools")+"",c,f,d=n[5].t("Functions")+"",m,p,k,D,_,S,E,B;function y(M,I){if(M[0]==="tools")return Vi;if(M[0]==="functions")return Ti}let L=y(n),V=L&&L(n),U=n[1]&&vn(n);return{c(){e=v("form"),t=v("div"),l=v("div"),s=v("div"),o=v("div"),r=v("select"),i=v("option"),c=ge(a),f=v("option"),m=ge(d),p=Z(),k=v("div"),D=v("select"),V&&V.c(),_=Z(),U&&U.c(),this.h()},l(M){e=b(M,"FORM",{class:!0});var I=w(e);t=b(I,"DIV",{class:!0});var C=w(t);l=b(C,"DIV",{class:!0});var W=w(l);s=b(W,"DIV",{class:!0});var R=w(s);o=b(R,"DIV",{class:!0});var A=w(o);r=b(A,"SELECT",{class:!0,placeholder:!0});var j=w(r);i=b(j,"OPTION",{class:!0});var G=w(i);c=pe(G,a),G.forEach(h),f=b(j,"OPTION",{class:!0});var x=w(f);m=pe(x,d),x.forEach(h),j.forEach(h),A.forEach(h),p=q(R),k=b(R,"DIV",{class:!0});var F=w(k);D=b(F,"SELECT",{class:!0});var ie=w(D);V&&V.l(ie),ie.forEach(h),F.forEach(h),R.forEach(h),W.forEach(h),_=q(C),U&&U.l(C),C.forEach(h),I.forEach(h),this.h()},h(){i.__value="tools",Zt(i,i.__value),u(i,"class","bg-gray-100 dark:bg-gray-800"),f.__value="functions",Zt(f,f.__value),u(f,"class","bg-gray-100 dark:bg-gray-800"),u(r,"class","w-full rounded text-xs py-2 px-1 bg-transparent outline-none"),u(r,"placeholder","Select"),n[0]===void 0&&dl(()=>n[12].call(r)),u(o,"class","flex-1"),u(D,"class","w-full rounded py-2 px-1 text-xs bg-transparent outline-none"),n[1]===void 0&&dl(()=>n[13].call(D)),u(k,"class","flex-1"),u(s,"class","flex gap-2"),u(l,"class","space-y-1"),u(t,"class","flex flex-col"),u(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(M,I){z(M,e,I),g(e,t),g(t,l),g(l,s),g(s,o),g(o,r),g(r,i),g(i,c),g(r,f),g(f,m),Wl(r,n[0],!0),g(s,p),g(s,k),g(k,D),V&&V.m(D,null),Wl(D,n[1],!0),g(t,_),U&&U.m(t,null),S=!0,E||(B=[ce(r,"change",n[12]),ce(D,"change",n[13]),ce(D,"change",n[14]),ce(e,"submit",Bn(n[17]))],E=!0)},p(M,[I]){(!S||I&32)&&a!==(a=M[5].t("Tools")+"")&&ye(c,a),(!S||I&32)&&d!==(d=M[5].t("Functions")+"")&&ye(m,d),I&1&&Wl(r,M[0]),L===(L=y(M))&&V?V.p(M,I):(V&&V.d(1),V=L&&L(M),V&&(V.c(),V.m(D,null))),I&194&&Wl(D,M[1]),M[1]?U?(U.p(M,I),I&2&&N(U,1)):(U=vn(M),U.c(),N(U,1),U.m(t,null)):U&&(Re(),O(U,1,1,()=>{U=null}),Fe())},i(M){S||(N(U),S=!0)},o(M){O(U),S=!1},d(M){M&&h(e),V&&V.d(),U&&U.d(),E=!1,zt(B)}}}function Li(n,e,t){let l,s,o;me(n,zn,U=>t(6,s=U)),me(n,lr,U=>t(7,o=U));const r=el(),i=bt("i18n");me(n,i,U=>t(5,l=U));let a="tools",c="",f=!1,d=null,m={},p;const k=async()=>{p&&clearTimeout(p),p=setTimeout(()=>{_()},500)},D=async()=>{var U;if(t(2,f=!0),a==="tools"?(t(4,m=await qr(localStorage.token,c)),t(3,d=await xr(localStorage.token,c))):a==="functions"&&(t(4,m=await Gr(localStorage.token,c)),t(3,d=await Qr(localStorage.token,c))),d)for(const M in d.properties)((U=d.properties[M])==null?void 0:U.type)==="array"&&t(4,m[M]=(m[M]??[]).join(","),m);t(2,f=!1)},_=async()=>{var U;if(d){for(const M in d.properties)((U=d.properties[M])==null?void 0:U.type)==="array"&&t(4,m[M]=(m[M]??"").split(",").map(I=>I.trim()),m);if(a==="tools"){const M=await Jr(localStorage.token,c,m).catch(I=>(Ce.error(I),null));M&&(Ce.success(l.t("Valves updated")),t(4,m=M))}else if(a==="functions"){const M=await Kr(localStorage.token,c,m).catch(I=>(Ce.error(I),null));M&&(Ce.success(l.t("Valves updated")),t(4,m=M))}}};function S(){a=ds(this),t(0,a)}function E(){c=ds(this),t(1,c),t(0,a)}const B=async()=>{await Be()};function y(U){m=U,t(4,m)}const L=()=>{k()},V=()=>{_(),r("save")};return n.$$.update=()=>{n.$$.dirty&1&&a&&t(1,c=""),n.$$.dirty&2&&c&&D()},[a,c,f,d,m,l,s,o,r,i,k,_,S,E,B,y,L,V]}class Ni extends Je{constructor(e){super(),Ge(this,e,Li,Bi,xe,{})}}function bn(n,e,t){const l=n.slice();return l[11]=e[t],l[13]=t,l}function wn(n){let e,t,l,s;return e=new xl({props:{title:n[2].t("Files"),open:!0,$$slots:{content:[zi]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment),t=Z(),l=v("hr"),this.h()},l(o){te(e.$$.fragment,o),t=q(o),l=b(o,"HR",{class:!0}),this.h()},h(){u(l,"class","my-2 border-gray-100 dark:border-gray-800")},m(o,r){le(e,o,r),z(o,t,r),z(o,l,r),s=!0},p(o,r){const i={};r&4&&(i.title=o[2].t("Files")),r&16385&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){s||(N(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(h(t),h(l)),se(e,o)}}}function kn(n){var s,o;let e,t;function l(){return n[8](n[13])}return e=new Nn({props:{className:"w-full",url:`${(s=n[11])==null?void 0:s.url}`,name:n[11].name,type:n[11].type,size:(o=n[11])==null?void 0:o.size,dismissible:!0}}),e.$on("dismiss",l),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),t=!0},p(r,i){var c,f;n=r;const a={};i&1&&(a.url=`${(c=n[11])==null?void 0:c.url}`),i&1&&(a.name=n[11].name),i&1&&(a.type=n[11].type),i&1&&(a.size=(f=n[11])==null?void 0:f.size),e.$set(a)},i(r){t||(N(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){se(e,r)}}}function zi(n){let e,t,l=it(n[0]),s=[];for(let r=0;r<l.length;r+=1)s[r]=kn(bn(n,l,r));const o=r=>O(s[r],1,1,()=>{s[r]=null});return{c(){e=v("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0,slot:!0});var i=w(e);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(h),this.h()},h(){u(e,"class","flex flex-col gap-1 mt-1.5"),u(e,"slot","content")},m(r,i){z(r,e,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,i){if(i&1){l=it(r[0]);let a;for(a=0;a<l.length;a+=1){const c=bn(r,l,a);s[a]?(s[a].p(c,i),N(s[a],1)):(s[a]=kn(c),s[a].c(),N(s[a],1),s[a].m(e,null))}for(Re(),a=l.length;a<s.length;a+=1)o(a);Fe()}},i(r){if(!t){for(let i=0;i<l.length;i+=1)N(s[i]);t=!0}},o(r){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)O(s[i]);t=!1},d(r){r&&h(e),xt(s,r)}}}function Oi(n){let e,t,l;return t=new Ni({}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{class:!0,slot:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"class","text-sm mt-1.5"),u(e,"slot","content")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p:De,i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function Ui(n){let e,t,l,s,o;return{c(){e=v("div"),t=v("textarea"),this.h()},l(r){e=b(r,"DIV",{class:!0,slot:!0});var i=w(e);t=b(i,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),w(t).forEach(h),i.forEach(h),this.h()},h(){u(t,"class","w-full rounded-lg px-3.5 py-2.5 text-sm dark:text-gray-300 dark:bg-gray-850 border border-gray-100 dark:border-gray-800 outline-none resize-none"),u(t,"rows","4"),u(t,"placeholder",l=n[2].t("Enter system prompt")),u(e,"class","mt-1.5"),u(e,"slot","content")},m(r,i){z(r,e,i),g(e,t),Zt(t,n[1].system),s||(o=ce(t,"input",n[9]),s=!0)},p(r,i){i&4&&l!==(l=r[2].t("Enter system prompt"))&&u(t,"placeholder",l),i&2&&Zt(t,r[1].system)},d(r){r&&h(e),s=!1,o()}}}function Ai(n){var a;let e,t,l,s,o;function r(c){n[10](c)}let i={admin:((a=n[3])==null?void 0:a.role)==="admin"};return n[1]!==void 0&&(i.params=n[1]),l=new Zr({props:i}),_e.push(()=>He(l,"params",r)),{c(){e=v("div"),t=v("div"),ee(l.$$.fragment),this.h()},l(c){e=b(c,"DIV",{class:!0,slot:!0});var f=w(e);t=b(f,"DIV",{});var d=w(t);te(l.$$.fragment,d),d.forEach(h),f.forEach(h),this.h()},h(){u(e,"class","text-sm mt-1.5"),u(e,"slot","content")},m(c,f){z(c,e,f),g(e,t),le(l,t,null),o=!0},p(c,f){var m;const d={};f&8&&(d.admin=((m=c[3])==null?void 0:m.role)==="admin"),!s&&f&2&&(s=!0,d.params=c[1],Me(()=>s=!1)),l.$set(d)},i(c){o||(N(l.$$.fragment,c),o=!0)},o(c){O(l.$$.fragment,c),o=!1},d(c){c&&h(e),se(l)}}}function Pi(n){let e,t,l,s=n[2].t("Chat Controls")+"",o,r,i,a,c,f,d,m,p,k,D,_,S,E,B,y,L,V,U;a=new Rn({props:{className:"size-4"}});let M=n[0].length>0&&wn(n);return m=new xl({props:{title:n[2].t("Valves"),$$slots:{content:[Oi]},$$scope:{ctx:n}}}),_=new xl({props:{title:n[2].t("System Prompt"),open:!0,$$slots:{content:[Ui]},$$scope:{ctx:n}}}),y=new xl({props:{title:n[2].t("Advanced Params"),open:!0,$$slots:{content:[Ai]},$$scope:{ctx:n}}}),{c(){e=v("div"),t=v("div"),l=v("div"),o=ge(s),r=Z(),i=v("button"),ee(a.$$.fragment),c=Z(),f=v("div"),M&&M.c(),d=Z(),ee(m.$$.fragment),p=Z(),k=v("hr"),D=Z(),ee(_.$$.fragment),S=Z(),E=v("hr"),B=Z(),ee(y.$$.fragment),this.h()},l(I){e=b(I,"DIV",{class:!0});var C=w(e);t=b(C,"DIV",{class:!0});var W=w(t);l=b(W,"DIV",{class:!0});var R=w(l);o=pe(R,s),R.forEach(h),r=q(W),i=b(W,"BUTTON",{class:!0});var A=w(i);te(a.$$.fragment,A),A.forEach(h),W.forEach(h),c=q(C),f=b(C,"DIV",{class:!0});var j=w(f);M&&M.l(j),d=q(j),te(m.$$.fragment,j),p=q(j),k=b(j,"HR",{class:!0}),D=q(j),te(_.$$.fragment,j),S=q(j),E=b(j,"HR",{class:!0}),B=q(j),te(y.$$.fragment,j),j.forEach(h),C.forEach(h),this.h()},h(){u(l,"class","text-lg font-medium self-center font-primary"),u(i,"class","self-center"),u(t,"class","flex justify-between dark:text-gray-100 mb-2"),u(k,"class","my-2 border-gray-100 dark:border-gray-800"),u(E,"class","my-2 border-gray-100 dark:border-gray-800"),u(f,"class","dark:text-gray-200 text-sm font-primary py-0.5"),u(e,"class","dark:text-white")},m(I,C){z(I,e,C),g(e,t),g(t,l),g(l,o),g(t,r),g(t,i),le(a,i,null),g(e,c),g(e,f),M&&M.m(f,null),g(f,d),le(m,f,null),g(f,p),g(f,k),g(f,D),le(_,f,null),g(f,S),g(f,E),g(f,B),le(y,f,null),L=!0,V||(U=ce(i,"click",n[7]),V=!0)},p(I,[C]){(!L||C&4)&&s!==(s=I[2].t("Chat Controls")+"")&&ye(o,s),I[0].length>0?M?(M.p(I,C),C&1&&N(M,1)):(M=wn(I),M.c(),N(M,1),M.m(f,d)):M&&(Re(),O(M,1,1,()=>{M=null}),Fe());const W={};C&4&&(W.title=I[2].t("Valves")),C&16384&&(W.$$scope={dirty:C,ctx:I}),m.$set(W);const R={};C&4&&(R.title=I[2].t("System Prompt")),C&16390&&(R.$$scope={dirty:C,ctx:I}),_.$set(R);const A={};C&4&&(A.title=I[2].t("Advanced Params")),C&16394&&(A.$$scope={dirty:C,ctx:I}),y.$set(A)},i(I){L||(N(a.$$.fragment,I),N(M),N(m.$$.fragment,I),N(_.$$.fragment,I),N(y.$$.fragment,I),L=!0)},o(I){O(a.$$.fragment,I),O(M),O(m.$$.fragment,I),O(_.$$.fragment,I),O(y.$$.fragment,I),L=!1},d(I){I&&h(e),se(a),M&&M.d(),se(m),se(_),se(y),V=!1,U()}}}function ji(n,e,t){let l,s;me(n,Ul,k=>t(3,s=k));const o=el(),r=bt("i18n");me(n,r,k=>t(2,l=k));let{models:i=[]}=e,{chatFiles:a=[]}=e,{params:c={}}=e;const f=()=>{o("close")},d=k=>{a.splice(k,1),t(0,a)};function m(){c.system=this.value,t(1,c)}function p(k){c=k,t(1,c)}return n.$$set=k=>{"models"in k&&t(6,i=k.models),"chatFiles"in k&&t(0,a=k.chatFiles),"params"in k&&t(1,c=k.params)},[a,c,l,s,o,r,i,f,d,m,p]}class Fn extends Je{constructor(e){super(),Ge(this,e,ji,Pi,xe,{models:6,chatFiles:0,params:1})}}function yn(n,e,t){const l=n.slice();return l[10]=e[t],l}function Ri(n){let e;const t=n[4].default,l=Ht(t,n,n[8],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&256)&&Bt(l,t,s,s[8],e?Nt(t,s[8],o,null):Lt(s[8]),null)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function Fi(n){var r;let e,t,l=(((r=n[10])==null?void 0:r.label)??"Camera")+"",s,o;return{c(){e=v("div"),t=v("div"),s=ge(l),o=Z(),this.h()},l(i){e=b(i,"DIV",{class:!0});var a=w(e);t=b(a,"DIV",{class:!0});var c=w(t);s=pe(c,l),c.forEach(h),a.forEach(h),o=q(i),this.h()},h(){u(t,"class","line-clamp-1"),u(e,"class","flex items-center")},m(i,a){z(i,e,a),g(e,t),g(t,s),z(i,o,a)},p(i,a){var c;a&2&&l!==(l=(((c=i[10])==null?void 0:c.label)??"Camera")+"")&&ye(s,l)},d(i){i&&(h(e),h(o))}}}function En(n){let e,t;function l(){return n[5](n[10])}return e=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[Fi]},$$scope:{ctx:n}}}),e.$on("click",l),{c(){ee(e.$$.fragment)},l(s){te(e.$$.fragment,s)},m(s,o){le(e,s,o),t=!0},p(s,o){n=s;const r={};o&258&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(s){t||(N(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){se(e,s)}}}function Wi(n){let e,t,l=it(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=En(yn(n,l,r));const o=r=>O(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=Pe()},l(r){for(let i=0;i<s.length;i+=1)s[i].l(r);e=Pe()},m(r,i){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(r,i);z(r,e,i),t=!0},p(r,i){if(i&10){l=it(r[1]);let a;for(a=0;a<l.length;a+=1){const c=yn(r,l,a);s[a]?(s[a].p(c,i),N(s[a],1)):(s[a]=En(c),s[a].c(),N(s[a],1),s[a].m(e.parentNode,e))}for(Re(),a=l.length;a<s.length;a+=1)o(a);Fe()}},i(r){if(!t){for(let i=0;i<l.length;i+=1)N(s[i]);t=!0}},o(r){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)O(s[i]);t=!1},d(r){r&&h(e),xt(s,r)}}}function Zi(n){let e,t,l;return t=new $l({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-[9999] bg-white dark:bg-gray-900 dark:text-white shadow-sm",sideOffset:6,side:"top",align:"start",transition:Al,$$slots:{default:[Wi]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{slot:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"slot","content")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&258&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function qi(n){let e,t,l;function s(r){n[6](r)}let o={$$slots:{content:[Zi],default:[Ri]},$$scope:{ctx:n}};return n[2]!==void 0&&(o.show=n[2]),e=new Xl({props:o}),_e.push(()=>He(e,"show",s)),e.$on("change",n[7]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,[i]){const a={};i&258&&(a.$$scope={dirty:i,ctx:r}),!t&&i&4&&(t=!0,a.show=r[2],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function xi(n,e,t){let{$$slots:l={},$$scope:s}=e;bt("i18n");const o=el();let{onClose:r=()=>{}}=e,{devices:i}=e,a=!1;const c=m=>{o("change",m.deviceId)};function f(m){a=m,t(2,a)}const d=m=>{m.detail===!1&&r()};return n.$$set=m=>{"onClose"in m&&t(0,r=m.onClose),"devices"in m&&t(1,i=m.devices),"$$scope"in m&&t(8,s=m.$$scope)},[r,i,a,o,l,c,f,d,s]}class Ji extends Je{constructor(e){super(),Ge(this,e,xi,qi,xe,{onClose:0,devices:1})}}function In(n){let e,t,l,s,o,r,i,a,c,f,d,m,p,k,D,_='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',S,E,B,y=n[4]&&Dn(n);function L(j,G){return j[4]?Yi:Xi}let V=L(n),U=V(n);const M=[sc,lc],I=[];function C(j,G){return j[4]?0:1}i=C(n),a=I[i]=M[i](n);function W(j,G){return j[1]?ic:j[2]?ac:oc}let R=W(n),A=R(n);return{c(){e=v("div"),y&&y.c(),t=Z(),l=v("div"),U.c(),s=Z(),o=v("div"),r=v("div"),a.c(),c=Z(),f=v("div"),d=v("button"),m=v("div"),A.c(),p=Z(),k=v("div"),D=v("button"),D.innerHTML=_,this.h()},l(j){e=b(j,"DIV",{class:!0});var G=w(e);y&&y.l(G),t=q(G),l=b(G,"DIV",{class:!0});var x=w(l);U.l(x),x.forEach(h),s=q(G),o=b(G,"DIV",{class:!0});var F=w(o);r=b(F,"DIV",{});var ie=w(r);a.l(ie),ie.forEach(h),c=q(F),f=b(F,"DIV",{});var be=w(f);d=b(be,"BUTTON",{type:!0});var Ie=w(d);m=b(Ie,"DIV",{class:!0});var Y=w(m);A.l(Y),Y.forEach(h),Ie.forEach(h),be.forEach(h),p=q(F),k=b(F,"DIV",{});var oe=w(k);D=b(oe,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),qe(D)!=="svelte-3xomy"&&(D.innerHTML=_),oe.forEach(h),F.forEach(h),G.forEach(h),this.h()},h(){u(l,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),u(m,"class","line-clamp-1 text-sm font-medium"),u(d,"type","button"),u(D,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),u(D,"type","button"),u(o,"class","flex justify-between items-center pb-2 w-full"),u(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(j,G){z(j,e,G),y&&y.m(e,null),g(e,t),g(e,l),U.m(l,null),g(e,s),g(e,o),g(o,r),I[i].m(r,null),g(o,c),g(o,f),g(f,d),g(d,m),A.m(m,null),g(o,p),g(o,k),g(k,D),S=!0,E||(B=[ce(d,"click",n[29]),ce(D,"click",n[30])],E=!0)},p(j,G){j[4]?y?y.p(j,G):(y=Dn(j),y.c(),y.m(e,t)):y&&(y.d(1),y=null),V===(V=L(j))&&U?U.p(j,G):(U.d(1),U=V(j),U&&(U.c(),U.m(l,null)));let x=i;i=C(j),i===x?I[i].p(j,G):(Re(),O(I[x],1,1,()=>{I[x]=null}),Fe(),a=I[i],a?a.p(j,G):(a=I[i]=M[i](j),a.c()),N(a,1),a.m(r,null)),R===(R=W(j))&&A?A.p(j,G):(A.d(1),A=R(j),A&&(A.c(),A.m(m,null)))},i(j){S||(N(a),S=!0)},o(j){O(a),S=!1},d(j){j&&h(e),y&&y.d(),U.d(),I[i].d(),A.d(),E=!1,zt(B)}}}function Dn(n){let e,t,l;function s(i,a){return i[3]?Ki:i[1]||i[2]?Qi:Gi}let o=s(n),r=o(n);return{c(){e=v("button"),r.c(),this.h()},l(i){e=b(i,"BUTTON",{type:!0,class:!0});var a=w(e);r.l(a),a.forEach(h),this.h()},h(){u(e,"type","button"),u(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(i,a){z(i,e,a),r.m(e,null),t||(l=ce(e,"click",n[24]),t=!0)},p(i,a){o===(o=s(i))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(e,null)))},d(i){i&&h(e),r.d(),t=!1,l()}}}function Gi(n){let e,t,l;return{c(){e=v("div"),this.h()},l(s){e=b(s,"DIV",{class:!0,style:!0}),w(e).forEach(h),this.h()},h(){var s,o,r,i,a,c,f,d,m;u(e,"class",t=(n[5]*100>4?" size-[4.5rem]":n[5]*100>2?" size-16":n[5]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((r=(o=(s=n[0])==null?void 0:s.info)==null?void 0:o.meta)==null?void 0:r.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),u(e,"style",l=(((c=(a=(i=n[0])==null?void 0:i.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?`background-image: url('${(m=(d=(f=n[0])==null?void 0:f.info)==null?void 0:d.meta)==null?void 0:m.profile_image_url}');`:"")},m(s,o){z(s,e,o)},p(s,o){var r,i,a,c,f,d,m,p,k;o[0]&33&&t!==(t=(s[5]*100>4?" size-[4.5rem]":s[5]*100>2?" size-16":s[5]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(i=(r=s[0])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&u(e,"class",t),o[0]&1&&l!==(l=(((d=(f=(c=s[0])==null?void 0:c.info)==null?void 0:f.meta)==null?void 0:d.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?`background-image: url('${(k=(p=(m=s[0])==null?void 0:m.info)==null?void 0:p.meta)==null?void 0:k.profile_image_url}');`:"")&&u(e,"style",l)},d(s){s&&h(e)}}}function Qi(n){let e,t,l,s,o,r;return{c(){e=Ne("svg"),t=Ne("style"),l=ge(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),s=Ne("circle"),o=Ne("circle"),r=Ne("circle"),this.h()},l(i){e=ze(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=w(e);t=ze(a,"style",{});var c=w(t);l=pe(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(h),s=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(h),o=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(o).forEach(h),r=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(h),a.forEach(h),this.h()},h(){u(s,"class","spinner_qM83"),u(s,"cx","4"),u(s,"cy","12"),u(s,"r","3"),u(o,"class","spinner_qM83 spinner_oXPr"),u(o,"cx","12"),u(o,"cy","12"),u(o,"r","3"),u(r,"class","spinner_qM83 spinner_ZTLf"),u(r,"cx","20"),u(r,"cy","12"),u(r,"r","3"),u(e,"class","size-12 text-gray-900 dark:text-gray-400"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"xmlns","http://www.w3.org/2000/svg")},m(i,a){z(i,e,a),g(e,t),g(t,l),g(e,s),g(e,o),g(e,r)},p:De,d(i){i&&h(e)}}}function Ki(n){let e,t;return{c(){e=v("div"),t=ge(n[3]),this.h()},l(l){e=b(l,"DIV",{class:!0,style:!0});var s=w(e);t=pe(s,n[3]),s.forEach(h),this.h()},h(){u(e,"class","transition-all rounded-full"),Mt(e,"font-size",(n[5]*100>4?"4.5":n[5]*100>2?"4.25":n[5]*100>1?"3.75":"3.5")+"rem"),Mt(e,"width","100%"),Mt(e,"text-align","center")},m(l,s){z(l,e,s),g(e,t)},p(l,s){s[0]&8&&ye(t,l[3]),s[0]&32&&Mt(e,"font-size",(l[5]*100>4?"4.5":l[5]*100>2?"4.25":l[5]*100>1?"3.75":"3.5")+"rem")},d(l){l&&h(e)}}}function Yi(n){let e,t,l,s,o,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,f;return{c(){e=v("div"),t=v("video"),l=Z(),s=v("canvas"),o=Z(),r=v("div"),i=v("button"),i.innerHTML=a,this.h()},l(d){e=b(d,"DIV",{class:!0});var m=w(e);t=b(m,"VIDEO",{id:!0,class:!0}),w(t).forEach(h),l=q(m),s=b(m,"CANVAS",{id:!0,style:!0}),w(s).forEach(h),o=q(m),r=b(m,"DIV",{class:!0});var p=w(r);i=b(p,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),qe(i)!=="svelte-16ul42n"&&(i.innerHTML=a),p.forEach(h),m.forEach(h),this.h()},h(){u(t,"id","camera-feed"),t.autoplay=!0,u(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,u(s,"id","camera-canvas"),Mt(s,"display","none"),u(i,"type","button"),u(i,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),u(r,"class","absolute top-4 md:top-8 left-4"),u(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(d,m){z(d,e,m),g(e,t),g(e,l),g(e,s),g(e,o),g(e,r),g(r,i),c||(f=ce(i,"click",n[26]),c=!0)},p:De,d(d){d&&h(e),c=!1,f()}}}function Xi(n){let e,t,l;function s(i,a){return i[3]?tc:i[1]||i[2]?ec:$i}let o=s(n),r=o(n);return{c(){e=v("button"),r.c(),this.h()},l(i){e=b(i,"BUTTON",{type:!0});var a=w(e);r.l(a),a.forEach(h),this.h()},h(){u(e,"type","button")},m(i,a){z(i,e,a),r.m(e,null),t||(l=ce(e,"click",n[25]),t=!0)},p(i,a){o===(o=s(i))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(e,null)))},d(i){i&&h(e),r.d(),t=!1,l()}}}function $i(n){let e,t,l;return{c(){e=v("div"),this.h()},l(s){e=b(s,"DIV",{class:!0,style:!0}),w(e).forEach(h),this.h()},h(){var s,o,r,i,a,c,f,d,m;u(e,"class",t=(n[5]*100>4?" size-52":n[5]*100>2?"size-48":n[5]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((r=(o=(s=n[0])==null?void 0:s.info)==null?void 0:o.meta)==null?void 0:r.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),u(e,"style",l=(((c=(a=(i=n[0])==null?void 0:i.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?`background-image: url('${(m=(d=(f=n[0])==null?void 0:f.info)==null?void 0:d.meta)==null?void 0:m.profile_image_url}');`:"")},m(s,o){z(s,e,o)},p(s,o){var r,i,a,c,f,d,m,p,k;o[0]&33&&t!==(t=(s[5]*100>4?" size-52":s[5]*100>2?"size-48":s[5]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(i=(r=s[0])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:a.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&u(e,"class",t),o[0]&1&&l!==(l=(((d=(f=(c=s[0])==null?void 0:c.info)==null?void 0:f.meta)==null?void 0:d.profile_image_url)??"/static/13-Copy.png")!=="/static/13-Copy.png"?`background-image: url('${(k=(p=(m=s[0])==null?void 0:m.info)==null?void 0:p.meta)==null?void 0:k.profile_image_url}');`:"")&&u(e,"style",l)},d(s){s&&h(e)}}}function ec(n){let e,t,l,s,o,r;return{c(){e=Ne("svg"),t=Ne("style"),l=ge(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),s=Ne("circle"),o=Ne("circle"),r=Ne("circle"),this.h()},l(i){e=ze(i,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=w(e);t=ze(a,"style",{});var c=w(t);l=pe(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(h),s=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(h),o=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(o).forEach(h),r=ze(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(h),a.forEach(h),this.h()},h(){u(s,"class","spinner_qM83"),u(s,"cx","4"),u(s,"cy","12"),u(s,"r","3"),u(o,"class","spinner_qM83 spinner_oXPr"),u(o,"cx","12"),u(o,"cy","12"),u(o,"r","3"),u(r,"class","spinner_qM83 spinner_ZTLf"),u(r,"cx","20"),u(r,"cy","12"),u(r,"r","3"),u(e,"class","size-44 text-gray-900 dark:text-gray-400"),u(e,"viewBox","0 0 24 24"),u(e,"fill","currentColor"),u(e,"xmlns","http://www.w3.org/2000/svg")},m(i,a){z(i,e,a),g(e,t),g(t,l),g(e,s),g(e,o),g(e,r)},p:De,d(i){i&&h(e)}}}function tc(n){let e,t;return{c(){e=v("div"),t=ge(n[3]),this.h()},l(l){e=b(l,"DIV",{class:!0,style:!0});var s=w(e);t=pe(s,n[3]),s.forEach(h),this.h()},h(){u(e,"class","transition-all rounded-full"),Mt(e,"font-size",(n[5]*100>4?"13":n[5]*100>2?"12":n[5]*100>1?"11.5":"11")+"rem"),Mt(e,"width","100%"),Mt(e,"text-align","center")},m(l,s){z(l,e,s),g(e,t)},p(l,s){s[0]&8&&ye(t,l[3]),s[0]&32&&Mt(e,"font-size",(l[5]*100>4?"13":l[5]*100>2?"12":l[5]*100>1?"11.5":"11")+"rem")},d(l){l&&h(e)}}}function lc(n){let e,t;return e=new qt({props:{content:n[9].t("Camera"),$$slots:{default:[nc]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s[0]&512&&(o.content=l[9].t("Camera")),s[2]&1&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function sc(n){let e,t;return e=new Ji({props:{devices:n[6],$$slots:{default:[rc]},$$scope:{ctx:n}}}),e.$on("change",n[27]),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s[0]&64&&(o.devices=l[6]),s[2]&1&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function nc(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',l,s;return{c(){e=v("button"),e.innerHTML=t,this.h()},l(o){e=b(o,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),qe(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){u(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),u(e,"type","button")},m(o,r){z(o,e,r),l||(s=ce(e,"click",n[28]),l=!0)},p:De,d(o){o&&h(e),l=!1,s()}}}function rc(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=v("button"),e.innerHTML=t,this.h()},l(l){e=b(l,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),qe(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){u(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),u(e,"type","button")},m(l,s){z(l,e,s)},p:De,d(l){l&&h(e)}}}function oc(n){let e=n[9].t("Listening...")+"",t;return{c(){t=ge(e)},l(l){t=pe(l,e)},m(l,s){z(l,t,s)},p(l,s){s[0]&512&&e!==(e=l[9].t("Listening...")+"")&&ye(t,e)},d(l){l&&h(t)}}}function ac(n){let e=n[9].t("Tap to interrupt")+"",t;return{c(){t=ge(e)},l(l){t=pe(l,e)},m(l,s){z(l,t,s)},p(l,s){s[0]&512&&e!==(e=l[9].t("Tap to interrupt")+"")&&ye(t,e)},d(l){l&&h(t)}}}function ic(n){let e=n[9].t("Thinking...")+"",t;return{c(){t=ge(e)},l(l){t=pe(l,e)},m(l,s){z(l,t,s)},p(l,s){s[0]&512&&e!==(e=l[9].t("Thinking...")+"")&&ye(t,e)},d(l){l&&h(t)}}}function cc(n){let e,t,l=n[8]&&In(n);return{c(){l&&l.c(),e=Pe()},l(s){l&&l.l(s),e=Pe()},m(s,o){l&&l.m(s,o),z(s,e,o),t=!0},p(s,o){s[8]?l?(l.p(s,o),o[0]&256&&N(l,1)):(l=In(s),l.c(),N(l,1),l.m(e.parentNode,e)):l&&(Re(),O(l,1,1,()=>{l=null}),Fe())},i(s){t||(N(l),t=!0)},o(s){O(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function fc(n,e,t){let l,s,o,r,i;me(n,Ol,Q=>t(45,l=Q)),me(n,Tl,Q=>t(46,s=Q)),me(n,Xt,Q=>t(47,o=Q)),me(n,Cl,Q=>t(8,r=Q));const a=el(),c=bt("i18n");me(n,c,Q=>t(9,i=Q));let{eventTarget:f}=e,{submitPrompt:d}=e,{stopResponse:m}=e,{files:p}=e,{chatId:k}=e,{modelId:D}=e,_=null,S=null,E=!1,B=!1,y=!1,L=null,V=!1,U=null,M=!1,I=0,C=!1,W,R=null,A=[],j=[],G=null;const x=async()=>{const Q=await navigator.mediaDevices.enumerateDevices();t(6,j=Q.filter(Se=>Se.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(6,j=[...j,{deviceId:"screen",label:"Screen Share"}]),console.log(j),G===null&&j.length>0&&t(7,G=j[0].deviceId)},F=async()=>{if(await x(),U===null){t(4,V=!0),await Be();try{await ie()}catch(Q){console.error("Error accessing webcam: ",Q)}}},ie=async()=>{const Q=document.getElementById("camera-feed");Q&&(G==="screen"?U=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1}):U=await navigator.mediaDevices.getUserMedia({video:{deviceId:G?{exact:G}:void 0}}),U&&(await x(),Q.srcObject=U,await Q.play()))},be=async()=>{U&&U.getTracks().forEach(Se=>Se.stop()),U=null},Ie=()=>{const Q=document.getElementById("camera-feed"),Se=document.getElementById("camera-canvas");if(!Se)return;const we=Se.getContext("2d");Se.width=Q.videoWidth,Se.height=Q.videoHeight,we.drawImage(Q,0,0,Q.videoWidth,Q.videoHeight);const Ee=Se.toDataURL("image/png");return console.log(Ee),Ee},Y=async()=>{await be(),t(4,V=!1)},oe=-55,lt=async Q=>{await Be();const Se=ss(Q,"recording.wav"),we=await ns(localStorage.token,Se).catch(Ee=>(Ce.error(Ee),null));if(we&&(console.log(we.text),we.text!=="")){const Ee=await d(we.text,{_raw:!0});console.log(Ee)}},Ue=async(Q=!0)=>{if(r){console.log("%c%s","color: red; font-size: 20px;","ðŸš¨ stopRecordingCallback ðŸš¨");const Se=A.slice(0);if(A=[],W=!1,Q&&J(),B){if(t(1,E=!0),t(3,L=null),U){const Ee=Ie();t(18,p=[{type:"image",url:Ee}])}const we=new Blob(Se,{type:"audio/wav"});await lt(we),B=!1,t(1,E=!1)}}else A=[],W=!1,R&&R.getTracks().forEach(we=>we.stop()),R=null},J=async()=>{R=await navigator.mediaDevices.getUserMedia({audio:!0}),W=new MediaRecorder(R),W.onstart=()=>{console.log("Recording started"),A=[],X(R)},W.ondataavailable=Q=>{C&&A.push(Q.data)},W.onstop=Q=>{console.log("Recording stopped",Q),Ue()},W.start()},Qe=async()=>{R&&R.getTracks().forEach(Se=>Se.stop()),R=null},ue=Q=>{let Se=0;for(let we=0;we<Q.length;we++){const Ee=(Q[we]-128)/128;Se+=Ee*Ee}return Math.sqrt(Se/Q.length)},X=Q=>{const Se=new AudioContext,we=Se.createMediaStreamSource(Q),Ee=Se.createAnalyser();Ee.minDecibels=oe,we.connect(Ee);const H=Ee.frequencyBinCount,ne=new Uint8Array(H),de=new Uint8Array(Ee.fftSize);let Te=Date.now();C=!1,console.log("ðŸ”Š Sound detection started",Te,C),(()=>{const Oe=()=>{if(!W||!r)return;if(y&&!((o==null?void 0:o.voiceInterruption)??!1)?(Ee.maxDecibels=0,Ee.minDecibels=-1):(Ee.minDecibels=oe,Ee.maxDecibels=-30),Ee.getByteTimeDomainData(de),Ee.getByteFrequencyData(ne),t(5,I=ue(de)),ne.some(Tt=>Tt>0)&&(console.log("%c%s","color: red; font-size: 20px;","ðŸ”Š Sound detected"),C||(C=!0,ct()),Te=Date.now()),C&&Date.now()-Te>2e3&&(B=!0,W)){console.log("%c%s","color: red; font-size: 20px;","ðŸ”‡ Silence detected"),W.stop();return}window.requestAnimationFrame(Oe)};window.requestAnimationFrame(Oe)})()};let $={},ot=null,ht=null;const Ct=Q=>r?new Promise(Se=>{let we=[];const Ee=setInterval(async()=>{var H;if(we=await speechSynthesis.getVoices(),we.length>0){clearInterval(Ee);const ne=((H=we==null?void 0:we.filter(de=>{var Te,Ve,Oe,kt;return de.voiceURI===(((Ve=(Te=o==null?void 0:o.audio)==null?void 0:Te.tts)==null?void 0:Ve.voice)??((kt=(Oe=s==null?void 0:s.audio)==null?void 0:Oe.tts)==null?void 0:kt.voice))}))==null?void 0:H.at(0))??void 0;ht=new SpeechSynthesisUtterance(Q),ne&&(ht.voice=ne),speechSynthesis.speak(ht),ht.onend=async de=>{await new Promise(Te=>setTimeout(Te,200)),Se(de)}}},100)}):Promise.resolve(),Ot=Q=>r?new Promise(Se=>{const we=document.getElementById("audioElement");we&&(we.src=Q.src,we.muted=!0,we.play().then(()=>{we.muted=!1}).catch(Ee=>{console.error(Ee)}),we.onended=async Ee=>{await new Promise(H=>setTimeout(H,100)),Se(Ee)})}):Promise.resolve(),ct=async()=>{t(2,y=!1),M&&m(),ht&&(speechSynthesis.cancel(),ht=null);const Q=document.getElementById("audioElement");Q&&(Q.muted=!0,Q.pause(),Q.currentTime=0)};let Ye=new AbortController;const gt=new Map,K=new Map,ve=async Q=>{var Se,we,Ee,H;if(!gt.has(Q))try{if((o==null?void 0:o.showEmojiInCall)??!1){const ne=await Er(localStorage.token,D,Q,k);ne&&K.set(Q,ne)}if(s.audio.tts.engine!==""){const ne=await Hr(localStorage.token,((we=(Se=o==null?void 0:o.audio)==null?void 0:Se.tts)==null?void 0:we.voice)??((H=(Ee=s==null?void 0:s.audio)==null?void 0:Ee.tts)==null?void 0:H.voice),Q).catch(de=>(console.error(de),null));if(ne){const de=await ne.blob(),Te=URL.createObjectURL(de);gt.set(Q,new Audio(Te))}}else gt.set(Q,!0)}catch(ne){console.error("Error synthesizing speech:",ne)}return gt.get(Q)};let We={};const rt=async(Q,Se)=>{for(;!Se.aborted;)if(We[Q]&&We[Q].length>0){const we=We[Q].shift();if(gt.has(we))if(((o==null?void 0:o.showEmojiInCall)??!1)&&K.has(we)?t(3,L=K.get(we)):t(3,L=null),s.audio.tts.engine!=="")try{console.log("%c%s","color: red; font-size: 20px;",`Playing audio for content: ${we}`);const Ee=gt.get(we);await Ot(Ee),console.log(`Played audio for content: ${we}`),await new Promise(H=>setTimeout(H,200))}catch(Ee){console.error("Error playing audio:",Ee)}else await Ct(we);else We[Q].unshift(we),console.log(`Audio for "${we}" not yet available in the cache, re-queued...`),await new Promise(Ee=>setTimeout(Ee,200))}else if($[Q]&&We[Q]&&We[Q].length===0){t(2,y=!1);break}else await new Promise(we=>setTimeout(we,200));console.log(`Audio monitoring and playing stopped for message ID ${Q}`)};wl(async()=>{const Q=async()=>{try{_=await navigator.wakeLock.request("screen")}catch(H){console.log(H)}_&&_.addEventListener("release",()=>{console.log("Wake Lock released")})};"wakeLock"in navigator&&(await Q(),document.addEventListener("visibilitychange",async()=>{_!==null&&document.visibilityState==="visible"&&await Q()})),t(0,S=l.find(H=>H.id===D)),J();const Se=async H=>{const{id:ne}=H.detail;M=!0,ot!==ne&&(console.log(`Received chat start event for message ID ${ne}`),ot=ne,Ye&&Ye.abort(),Ye=new AbortController,t(2,y=!0),rt(ne,Ye.signal))},we=async H=>{const{id:ne,content:de}=H.detail;if(ot===ne){console.log(`Received chat event for message ID ${ne}: ${de}`);try{We[ne]===void 0?We[ne]=[de]:We[ne].push(de),console.log(de),ve(de)}catch(Te){console.error("Failed to fetch or play audio:",Te)}}},Ee=async H=>{const{id:ne,content:de}=H.detail;$[ne]=!0,M=!1};return f.addEventListener("chat:start",Se),f.addEventListener("chat",we),f.addEventListener("chat:finish",Ee),async()=>{f.removeEventListener("chat:start",Se),f.removeEventListener("chat",we),f.removeEventListener("chat:finish",Ee),Ye.abort(),await Be(),await ct(),await Ue(!1),await Y()}}),ls(async()=>{await ct(),await Ue(!1),await Y()});const $e=()=>{y&&ct()},wt=()=>{y&&ct()},_t=()=>{Y()},Gt=async Q=>{console.log(Q.detail),t(7,G=Q.detail),await be(),await ie()},tl=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),F()},St=()=>{y&&ct()},jt=async()=>{await Qe(),await be(),Cl.set(!1),a("close")};return n.$$set=Q=>{"eventTarget"in Q&&t(19,f=Q.eventTarget),"submitPrompt"in Q&&t(20,d=Q.submitPrompt),"stopResponse"in Q&&t(21,m=Q.stopResponse),"files"in Q&&t(18,p=Q.files),"chatId"in Q&&t(22,k=Q.chatId),"modelId"in Q&&t(23,D=Q.modelId)},[S,E,y,L,V,I,j,G,r,i,a,c,F,ie,be,Y,Qe,ct,p,f,d,m,k,D,$e,wt,_t,Gt,tl,St,jt]}class Wn extends Je{constructor(e){super(),Ge(this,e,fc,cc,xe,{eventTarget:19,submitPrompt:20,stopResponse:21,files:18,chatId:22,modelId:23},null,[-1,-1,-1])}}function uc(n){let e,t,l,s,o,r;const i=n[4].default,a=Ht(i,n,n[3],null);return{c(){e=v("div"),t=v("div"),a&&a.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var f=w(e);t=b(f,"DIV",{class:!0});var d=w(t);a&&a.l(d),d.forEach(h),f.forEach(h),this.h()},h(){u(t,"class","mt-auto max-w-full w-full bg-gray-50 dark:bg-gray-900 max-h-[100dvh] overflow-y-auto scrollbar-hidden"),u(e,"class","modal fixed right-0 left-0 bottom-0 bg-black/60 w-full h-screen max-h-[100dvh] flex justify-center z-[9999] overflow-hidden overscroll-contain")},m(c,f){z(c,e,f),g(e,t),a&&a.m(t,null),n[5](e),s=!0,o||(r=[ce(t,"mousedown",dc),ce(e,"mousedown",n[6])],o=!0)},p(c,[f]){a&&a.p&&(!s||f&8)&&Bt(a,i,c,c[3],s?Nt(i,c[3],f,null):Lt(c[3]),null)},i(c){s||(N(a,c),c&&(l||dl(()=>{l=Yl(e,Vr,{y:100,duration:100}),l.start()})),s=!0)},o(c){O(a,c),s=!1},d(c){c&&h(e),a&&a.d(c),n[5](null),o=!1,zt(r)}}}const dc=n=>{n.stopPropagation()};function hc(n,e,t){let{$$slots:l={},$$scope:s}=e,{show:o=!1}=e,{size:r="md"}=e,i=null;const a=m=>{m.key==="Escape"&&c()&&(console.log("Escape"),t(0,o=!1))},c=()=>{const m=document.getElementsByClassName("modal");return m.length&&m[m.length-1]===i};wl(()=>{}),ls(()=>{t(0,o=!1),i&&document.body.removeChild(i)});function f(m){_e[m?"unshift":"push"](()=>{i=m,t(1,i)})}const d=()=>{t(0,o=!1)};return n.$$set=m=>{"show"in m&&t(0,o=m.show),"size"in m&&t(2,r=m.size),"$$scope"in m&&t(3,s=m.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&(o&&i?(document.body.appendChild(i),window.addEventListener("keydown",a),document.body.style.overflow="hidden"):i&&(window.removeEventListener("keydown",a),document.body.removeChild(i),document.body.style.overflow="unset"))},[o,i,r,s,l,f,d]}class mc extends Je{constructor(e){super(),Ge(this,e,hc,uc,xe,{show:0,size:2})}}function gc(n){let e,t,l,s,o,r,i;const a=[vc,_c],c=[];function f(d,m){return d[11]?0:1}return s=f(n),o=c[s]=a[s](n),{c(){e=v("div"),t=v("div"),l=v("div"),o.c(),this.h()},l(d){e=b(d,"DIV",{class:!0});var m=w(e);t=b(m,"DIV",{class:!0});var p=w(t);l=b(p,"DIV",{class:!0});var k=w(l);o.l(k),k.forEach(h),p.forEach(h),m.forEach(h),this.h()},h(){u(l,"class","w-full h-full px-5 py-4 bg-white dark:shadow-lg dark:bg-gray-850 border border-gray-50 dark:border-gray-800 rounded-xl z-50 pointer-events-auto overflow-y-auto scrollbar-hidden"),u(t,"class","pr-4 pt-14 pb-8 w-[24rem] h-full"),u(e,"class","absolute bottom-0 right-0 z-20 h-full pointer-events-none")},m(d,m){z(d,e,m),g(e,t),g(t,l),c[s].m(l,null),i=!0},p(d,m){let p=s;s=f(d),s===p?c[s].p(d,m):(Re(),O(c[p],1,1,()=>{c[p]=null}),Fe(),o=c[s],o?o.p(d,m):(o=c[s]=a[s](d),o.c()),N(o,1),o.m(l,null))},i(d){i||(N(o),d&&(r||dl(()=>{r=Yl(t,Mr,{duration:200,axis:"x"}),r.start()})),i=!0)},o(d){O(o),i=!1},d(d){d&&h(e),c[s].d()}}}function pc(n){let e,t,l,s;const o=[wc,bc],r=[];function i(a,c){return a[11]?0:a[0]?1:-1}return~(e=i(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),l=Pe()},l(a){t&&t.l(a),l=Pe()},m(a,c){~e&&r[e].m(a,c),z(a,l,c),s=!0},p(a,c){let f=e;e=i(a),e===f?~e&&r[e].p(a,c):(t&&(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe()),~e?(t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l)):t=null)},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),~e&&r[e].d(a)}}}function _c(n){let e,t,l,s;function o(a){n[20](a)}function r(a){n[21](a)}let i={models:n[4]};return n[1]!==void 0&&(i.chatFiles=n[1]),n[2]!==void 0&&(i.params=n[2]),e=new Fn({props:i}),_e.push(()=>He(e,"chatFiles",o)),_e.push(()=>He(e,"params",r)),e.$on("close",n[22]),{c(){ee(e.$$.fragment)},l(a){te(e.$$.fragment,a)},m(a,c){le(e,a,c),s=!0},p(a,c){const f={};c&16&&(f.models=a[4]),!t&&c&2&&(t=!0,f.chatFiles=a[1],Me(()=>t=!1)),!l&&c&4&&(l=!0,f.params=a[2],Me(()=>l=!1)),e.$set(f)},i(a){s||(N(e.$$.fragment,a),s=!0)},o(a){O(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function vc(n){let e,t,l;function s(r){n[18](r)}let o={submitPrompt:n[7],stopResponse:n[8],modelId:n[9],chatId:n[5],eventTarget:n[6]};return n[3]!==void 0&&(o.files=n[3]),e=new Wn({props:o}),_e.push(()=>He(e,"files",s)),e.$on("close",n[19]),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};i&128&&(a.submitPrompt=r[7]),i&256&&(a.stopResponse=r[8]),i&512&&(a.modelId=r[9]),i&32&&(a.chatId=r[5]),i&64&&(a.eventTarget=r[6]),!t&&i&8&&(t=!0,a.files=r[3],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function bc(n){let e,t,l;function s(r){n[17](r)}let o={$$slots:{default:[kc]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.show=n[0]),e=new mc({props:o}),_e.push(()=>He(e,"show",s)),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,i){const a={};i&8388631&&(a.$$scope={dirty:i,ctx:r}),!t&&i&1&&(t=!0,a.show=r[0],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function wc(n){let e,t,l,s,o;function r(a){n[12](a)}let i={submitPrompt:n[7],stopResponse:n[8],modelId:n[9],chatId:n[5],eventTarget:n[6]};return n[3]!==void 0&&(i.files=n[3]),l=new Wn({props:i}),_e.push(()=>He(l,"files",r)),l.$on("close",n[13]),{c(){e=v("div"),t=v("div"),ee(l.$$.fragment),this.h()},l(a){e=b(a,"DIV",{class:!0});var c=w(e);t=b(c,"DIV",{class:!0});var f=w(t);te(l.$$.fragment,f),f.forEach(h),c.forEach(h),this.h()},h(){u(t,"class","absolute w-full h-screen max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center"),u(e,"class","absolute w-full h-screen max-h-[100dvh] flex z-[999] overflow-hidden")},m(a,c){z(a,e,c),g(e,t),le(l,t,null),o=!0},p(a,c){const f={};c&128&&(f.submitPrompt=a[7]),c&256&&(f.stopResponse=a[8]),c&512&&(f.modelId=a[9]),c&32&&(f.chatId=a[5]),c&64&&(f.eventTarget=a[6]),!s&&c&8&&(s=!0,f.files=a[3],Me(()=>s=!1)),l.$set(f)},i(a){o||(N(l.$$.fragment,a),o=!0)},o(a){O(l.$$.fragment,a),o=!1},d(a){a&&h(e),se(l)}}}function kc(n){let e,t,l,s,o;function r(c){n[14](c)}function i(c){n[15](c)}let a={models:n[4]};return n[1]!==void 0&&(a.chatFiles=n[1]),n[2]!==void 0&&(a.params=n[2]),t=new Fn({props:a}),_e.push(()=>He(t,"chatFiles",r)),_e.push(()=>He(t,"params",i)),t.$on("close",n[16]),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(c){e=b(c,"DIV",{class:!0});var f=w(e);te(t.$$.fragment,f),f.forEach(h),this.h()},h(){u(e,"class","px-6 py-4 h-full")},m(c,f){z(c,e,f),le(t,e,null),o=!0},p(c,f){const d={};f&16&&(d.models=c[4]),!l&&f&2&&(l=!0,d.chatFiles=c[1],Me(()=>l=!1)),!s&&f&4&&(s=!0,d.params=c[2],Me(()=>s=!1)),t.$set(d)},i(c){o||(N(t.$$.fragment,c),o=!0)},o(c){O(t.$$.fragment,c),o=!1},d(c){c&&h(e),se(t)}}}function yc(n){let e,t,l,s;const o=[pc,gc],r=[];function i(a,c){return a[10]?a[0]?1:-1:0}return~(e=i(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),l=Pe()},l(a){t&&t.l(a),l=Pe()},m(a,c){~e&&r[e].m(a,c),z(a,l,c),s=!0},p(a,[c]){let f=e;e=i(a),e===f?~e&&r[e].p(a,c):(t&&(Re(),O(r[f],1,1,()=>{r[f]=null}),Fe()),~e?(t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),N(t,1),t.m(l.parentNode,l)):t=null)},i(a){s||(N(t),s=!0)},o(a){O(t),s=!1},d(a){a&&h(l),~e&&r[e].d(a)}}}function Ec(n,e,t){let l;me(n,Cl,C=>t(11,l=C));let{show:s=!1}=e,{models:o=[]}=e,{chatId:r=null}=e,{chatFiles:i=[]}=e,{params:a={}}=e,{eventTarget:c}=e,{submitPrompt:f}=e,{stopResponse:d}=e,{files:m}=e,{modelId:p}=e,k=!1;wl(()=>{const C=window.matchMedia("(min-width: 1024px)"),W=R=>{R.matches?t(10,k=!0):t(10,k=!1)};return C.addEventListener("change",W),W(C),()=>{C.removeEventListener("change",W)}});function D(C){m=C,t(3,m)}const _=()=>{t(0,s=!1)};function S(C){i=C,t(1,i)}function E(C){a=C,t(2,a)}const B=()=>{t(0,s=!1)};function y(C){s=C,t(0,s)}function L(C){m=C,t(3,m)}const V=()=>{t(0,s=!1)};function U(C){i=C,t(1,i)}function M(C){a=C,t(2,a)}const I=()=>{t(0,s=!1)};return n.$$set=C=>{"show"in C&&t(0,s=C.show),"models"in C&&t(4,o=C.models),"chatId"in C&&t(5,r=C.chatId),"chatFiles"in C&&t(1,i=C.chatFiles),"params"in C&&t(2,a=C.params),"eventTarget"in C&&t(6,c=C.eventTarget),"submitPrompt"in C&&t(7,f=C.submitPrompt),"stopResponse"in C&&t(8,d=C.stopResponse),"files"in C&&t(3,m=C.files),"modelId"in C&&t(9,p=C.modelId)},[s,i,a,m,o,r,c,f,d,p,k,l,D,_,S,E,B,y,L,V,U,M,I]}class Ic extends Je{constructor(e){super(),Ge(this,e,Ec,yc,xe,{show:0,models:4,chatId:5,chatFiles:1,params:2,eventTarget:6,submitPrompt:7,stopResponse:8,files:3,modelId:9})}}const{document:ts}=qn;function Cn(n,e,t){const l=n.slice();return l[95]=e[t],l}function Sn(n){var Ye,gt;let e,t,l,s,o,r,i,a,c,f,d,m,p,k,D,_,S,E,B,y,L,V,U,M,I,C,W,R,A,j,G,x,F=(((Ye=n[26])==null?void 0:Ye.backgroundImageUrl)??null)&&Tn(n);function ie(K){n[45](K)}function be(K){n[46](K)}function Ie(K){n[47](K)}let Y={title:n[20],shareEnabled:n[24].length>0,chat:n[19],initNewChat:n[34]};n[1]!==void 0&&(Y.selectedModels=n[1]),n[15]!==void 0&&(Y.showModelSelector=n[15]),n[5]!==void 0&&(Y.showControls=n[5]),l=new Si({props:Y}),_e.push(()=>He(l,"selectedModels",ie)),_e.push(()=>He(l,"showModelSelector",be)),_e.push(()=>He(l,"showControls",Ie));let oe=n[31].length>0&&n[24].length===0&&!n[27]&&n[1].length<=1&&Vn(n);function lt(K){n[50](K)}function Ue(K){n[51](K)}function J(K){n[52](K)}function Qe(K){n[53](K)}let ue={chatId:n[27],selectedModels:n[1],processing:Cc,bottomPadding:n[23].length>0,sendPrompt:n[37],continueGeneration:n[40],regenerateResponse:n[39],mergeResponses:n[41],chatActionHandler:n[35]};n[3]!==void 0&&(ue.history=n[3]),n[24]!==void 0&&(ue.messages=n[24]),n[6]!==void 0&&(ue.autoScroll=n[6]),n[21]!==void 0&&(ue.prompt=n[21]),m=new xn({props:ue}),_e.push(()=>He(m,"history",lt)),_e.push(()=>He(m,"messages",Ue)),_e.push(()=>He(m,"autoScroll",J)),_e.push(()=>He(m,"prompt",Qe));function X(K){n[57](K)}function $(K){n[58](K)}function ot(K){n[59](K)}function ht(K){n[60](K)}function Ct(K){n[61](K)}function Ot(K){n[62](K)}let ct={availableToolIds:n[16].reduce(n[56],[]),transparentBackground:((gt=n[26])==null?void 0:gt.backgroundImageUrl)??!1,selectedModels:n[1],messages:n[24],submitPrompt:n[36],stopResponse:n[38]};return n[23]!==void 0&&(ct.files=n[23]),n[21]!==void 0&&(ct.prompt=n[21]),n[6]!==void 0&&(ct.autoScroll=n[6]),n[17]!==void 0&&(ct.selectedToolIds=n[17]),n[18]!==void 0&&(ct.webSearchEnabled=n[18]),n[2]!==void 0&&(ct.atSelectedModel=n[2]),L=new Ya({props:ct}),_e.push(()=>He(L,"files",X)),_e.push(()=>He(L,"prompt",$)),_e.push(()=>He(L,"autoScroll",ot)),_e.push(()=>He(L,"selectedToolIds",ht)),_e.push(()=>He(L,"webSearchEnabled",Ct)),_e.push(()=>He(L,"atSelectedModel",Ot)),L.$on("call",n[63]),{c(){e=v("div"),F&&F.c(),t=Z(),ee(l.$$.fragment),i=Z(),oe&&oe.c(),a=Z(),c=v("div"),f=v("div"),d=v("div"),ee(m.$$.fragment),B=Z(),y=v("div"),ee(L.$$.fragment),this.h()},l(K){e=b(K,"DIV",{class:!0});var ve=w(e);F&&F.l(ve),t=q(ve),te(l.$$.fragment,ve),i=q(ve),oe&&oe.l(ve),a=q(ve),c=b(ve,"DIV",{class:!0});var We=w(c);f=b(We,"DIV",{class:!0,id:!0});var rt=w(f);d=b(rt,"DIV",{class:!0});var $e=w(d);te(m.$$.fragment,$e),$e.forEach(h),rt.forEach(h),B=q(We),y=b(We,"DIV",{class:!0});var wt=w(y);te(L.$$.fragment,wt),wt.forEach(h),We.forEach(h),ve.forEach(h),this.h()},h(){u(d,"class",S="h-full w-full flex flex-col "+(n[0]?"py-4":"pt-2 pb-4")),u(f,"class",E="pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden "+(n[5]?"lg:pr-[24rem]":"")),u(f,"id","messages-container"),u(y,"class",R=n[5]?"lg:pr-[24rem]":""),u(c,"class","flex flex-col flex-auto z-10"),u(e,"class",A="h-screen max-h-[100dvh] "+(n[30]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col")},m(K,ve){z(K,e,ve),F&&F.m(e,null),g(e,t),le(l,e,null),g(e,i),oe&&oe.m(e,null),g(e,a),g(e,c),g(c,f),g(f,d),le(m,d,null),n[54](f),g(c,B),g(c,y),le(L,y,null),j=!0,G||(x=ce(f,"scroll",n[55]),G=!0)},p(K,ve){var wt,_t;((wt=K[26])==null?void 0:wt.backgroundImageUrl)??null?F?F.p(K,ve):(F=Tn(K),F.c(),F.m(e,t)):F&&(F.d(1),F=null);const We={};ve[0]&1048576&&(We.title=K[20]),ve[0]&16777216&&(We.shareEnabled=K[24].length>0),ve[0]&524288&&(We.chat=K[19]),!s&&ve[0]&2&&(s=!0,We.selectedModels=K[1],Me(()=>s=!1)),!o&&ve[0]&32768&&(o=!0,We.showModelSelector=K[15],Me(()=>o=!1)),!r&&ve[0]&32&&(r=!0,We.showControls=K[5],Me(()=>r=!1)),l.$set(We),K[31].length>0&&K[24].length===0&&!K[27]&&K[1].length<=1?oe?(oe.p(K,ve),ve[0]&150994946|ve[1]&1&&N(oe,1)):(oe=Vn(K),oe.c(),N(oe,1),oe.m(e,a)):oe&&(Re(),O(oe,1,1,()=>{oe=null}),Fe());const rt={};ve[0]&134217728&&(rt.chatId=K[27]),ve[0]&2&&(rt.selectedModels=K[1]),ve[0]&8388608&&(rt.bottomPadding=K[23].length>0),!p&&ve[0]&8&&(p=!0,rt.history=K[3],Me(()=>p=!1)),!k&&ve[0]&16777216&&(k=!0,rt.messages=K[24],Me(()=>k=!1)),!D&&ve[0]&64&&(D=!0,rt.autoScroll=K[6],Me(()=>D=!1)),!_&&ve[0]&2097152&&(_=!0,rt.prompt=K[21],Me(()=>_=!1)),m.$set(rt),(!j||ve[0]&1&&S!==(S="h-full w-full flex flex-col "+(K[0]?"py-4":"pt-2 pb-4")))&&u(d,"class",S),(!j||ve[0]&32&&E!==(E="pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden "+(K[5]?"lg:pr-[24rem]":"")))&&u(f,"class",E);const $e={};ve[0]&268500992&&($e.availableToolIds=K[16].reduce(K[56],[])),ve[0]&67108864&&($e.transparentBackground=((_t=K[26])==null?void 0:_t.backgroundImageUrl)??!1),ve[0]&2&&($e.selectedModels=K[1]),ve[0]&16777216&&($e.messages=K[24]),!V&&ve[0]&8388608&&(V=!0,$e.files=K[23],Me(()=>V=!1)),!U&&ve[0]&2097152&&(U=!0,$e.prompt=K[21],Me(()=>U=!1)),!M&&ve[0]&64&&(M=!0,$e.autoScroll=K[6],Me(()=>M=!1)),!I&&ve[0]&131072&&(I=!0,$e.selectedToolIds=K[17],Me(()=>I=!1)),!C&&ve[0]&262144&&(C=!0,$e.webSearchEnabled=K[18],Me(()=>C=!1)),!W&&ve[0]&4&&(W=!0,$e.atSelectedModel=K[2],Me(()=>W=!1)),L.$set($e),(!j||ve[0]&32&&R!==(R=K[5]?"lg:pr-[24rem]":""))&&u(y,"class",R),(!j||ve[0]&1073741824&&A!==(A="h-screen max-h-[100dvh] "+(K[30]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&u(e,"class",A)},i(K){j||(N(l.$$.fragment,K),N(oe),N(m.$$.fragment,K),N(L.$$.fragment,K),j=!0)},o(K){O(l.$$.fragment,K),O(oe),O(m.$$.fragment,K),O(L.$$.fragment,K),j=!1},d(K){K&&h(e),F&&F.d(),se(l),oe&&oe.d(),se(m),n[54](null),se(L),G=!1,x()}}}function Tn(n){let e,t,l,s;return{c(){e=v("div"),l=Z(),s=v("div"),this.h()},l(o){e=b(o,"DIV",{class:!0,style:!0}),w(e).forEach(h),l=q(o),s=b(o,"DIV",{class:!0}),w(s).forEach(h),this.h()},h(){u(e,"class",t="absolute "+(n[30]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),Mt(e,"background-image","url("+n[26].backgroundImageUrl+")"),u(s,"class","absolute top-0 left-0 w-full h-full bg-gradient-to-t from-white to-white/85 dark:from-gray-900 dark:to-[#171717]/90 z-0")},m(o,r){z(o,e,r),z(o,l,r),z(o,s,r)},p(o,r){r[0]&1073741824&&t!==(t="absolute "+(o[30]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&u(e,"class",t),r[0]&67108864&&Mt(e,"background-image","url("+o[26].backgroundImageUrl+")")},d(o){o&&(h(e),h(l),h(s))}}}function Vn(n){let e,t,l,s,o=it(n[31].filter(n[48])),r=[];for(let a=0;a<o.length;a+=1)r[a]=Mn(Cn(n,o,a));const i=a=>O(r[a],1,1,()=>{r[a]=null});return{c(){e=v("div"),t=v("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=b(a,"DIV",{class:!0});var c=w(e);t=b(c,"DIV",{class:!0});var f=w(t);for(let d=0;d<r.length;d+=1)r[d].l(f);f.forEach(h),c.forEach(h),this.h()},h(){u(t,"class","flex flex-col gap-1 w-full"),u(e,"class",l="absolute top-[4.25rem] w-full "+(n[30]?"md:max-w-[calc(100%-260px)]":"")+" "+(n[5]?"lg:pr-[24rem]":"")+" z-20")},m(a,c){z(a,e,c),g(e,t);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(t,null);s=!0},p(a,c){if(c[1]&1){o=it(a[31].filter(a[48]));let f;for(f=0;f<o.length;f+=1){const d=Cn(a,o,f);r[f]?(r[f].p(d,c),N(r[f],1)):(r[f]=Mn(d),r[f].c(),N(r[f],1),r[f].m(t,null))}for(Re(),f=o.length;f<r.length;f+=1)i(f);Fe()}(!s||c[0]&1073741856&&l!==(l="absolute top-[4.25rem] w-full "+(a[30]?"md:max-w-[calc(100%-260px)]":"")+" "+(a[5]?"lg:pr-[24rem]":"")+" z-20"))&&u(e,"class",l)},i(a){if(!s){for(let c=0;c<o.length;c+=1)N(r[c]);s=!0}},o(a){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)O(r[c]);s=!1},d(a){a&&h(e),xt(r,a)}}}function Mn(n){let e,t;return e=new zo({props:{banner:n[95]}}),e.$on("dismiss",n[49]),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s[1]&1&&(o.banner=l[95]),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Dc(n){var M;let e,t,l,s,o,r,i,a,c,f,d,m,p,k,D;ts.title=e=`
		`+(n[20]?`${n[20].length>30?`${n[20].slice(0,30)}...`:n[20]} | ${n[29]}`:`${n[29]}`)+`
	`;function _(I){n[42](I)}let S={title:n[9],message:n[10],input:n[11],inputPlaceholder:n[12],inputValue:n[13]};n[8]!==void 0&&(S.show=n[8]),r=new $r({props:S}),_e.push(()=>He(r,"show",_)),r.$on("confirm",n[43]),r.$on("cancel",n[44]);let E=(!n[0]||n[4]&&n[0])&&Sn(n);function B(I){n[65](I)}function y(I){n[66](I)}function L(I){n[67](I)}function V(I){n[68](I)}let U={models:n[16].reduce(n[64],[]),submitPrompt:n[36],stopResponse:n[38],modelId:((M=n[16])==null?void 0:M.at(0))??null,chatId:n[27],eventTarget:n[33]};return n[5]!==void 0&&(U.show=n[5]),n[22]!==void 0&&(U.chatFiles=n[22]),n[25]!==void 0&&(U.params=n[25]),n[23]!==void 0&&(U.files=n[23]),f=new Ic({props:U}),_e.push(()=>He(f,"show",B)),_e.push(()=>He(f,"chatFiles",y)),_e.push(()=>He(f,"params",L)),_e.push(()=>He(f,"files",V)),{c(){t=Z(),l=v("audio"),o=Z(),ee(r.$$.fragment),a=Z(),E&&E.c(),c=Z(),ee(f.$$.fragment),this.h()},l(I){Zn("svelte-1123lr8",ts.head).forEach(h),t=q(I),l=b(I,"AUDIO",{id:!0,src:!0,style:!0}),w(l).forEach(h),o=q(I),te(r.$$.fragment,I),a=q(I),E&&E.l(I),c=q(I),te(f.$$.fragment,I),this.h()},h(){u(l,"id","audioElement"),nl(l.src,s="")||u(l,"src",s),Mt(l,"display","none")},m(I,C){z(I,t,C),z(I,l,C),z(I,o,C),le(r,I,C),z(I,a,C),E&&E.m(I,C),z(I,c,C),le(f,I,C),D=!0},p(I,C){var A;(!D||C[0]&537919488)&&e!==(e=`
		`+(I[20]?`${I[20].length>30?`${I[20].slice(0,30)}...`:I[20]} | ${I[29]}`:`${I[29]}`)+`
	`)&&(ts.title=e);const W={};C[0]&512&&(W.title=I[9]),C[0]&1024&&(W.message=I[10]),C[0]&2048&&(W.input=I[11]),C[0]&4096&&(W.inputPlaceholder=I[12]),C[0]&8192&&(W.inputValue=I[13]),!i&&C[0]&256&&(i=!0,W.show=I[8],Me(()=>i=!1)),r.$set(W),!I[0]||I[4]&&I[0]?E?(E.p(I,C),C[0]&17&&N(E,1)):(E=Sn(I),E.c(),N(E,1),E.m(c.parentNode,c)):E&&(Re(),O(E,1,1,()=>{E=null}),Fe());const R={};C[0]&268500992&&(R.models=I[16].reduce(I[64],[])),C[0]&65536&&(R.modelId=((A=I[16])==null?void 0:A.at(0))??null),C[0]&134217728&&(R.chatId=I[27]),!d&&C[0]&32&&(d=!0,R.show=I[5],Me(()=>d=!1)),!m&&C[0]&4194304&&(m=!0,R.chatFiles=I[22],Me(()=>m=!1)),!p&&C[0]&33554432&&(p=!0,R.params=I[25],Me(()=>p=!1)),!k&&C[0]&8388608&&(k=!0,R.files=I[23],Me(()=>k=!1)),f.$set(R)},i(I){D||(N(r.$$.fragment,I),N(E),N(f.$$.fragment,I),D=!0)},o(I){O(r.$$.fragment,I),O(E),O(f.$$.fragment,I),D=!1},d(I){I&&(h(t),h(l),h(o),h(a),h(c)),se(r,I),E&&E.d(I),se(f,I)}}}let Cc="";function Sc(n,e,t){let l,s,o,r,i,a,c,f,d,m,p,k,D,_;me(n,Xt,T=>t(26,l=T)),me(n,vl,T=>t(72,s=T)),me(n,sr,T=>t(73,o=T)),me(n,bl,T=>t(27,r=T)),me(n,Ol,T=>t(28,a=T)),me(n,Tl,T=>t(75,c=T)),me(n,Cl,T=>t(76,f=T)),me(n,nr,T=>t(77,d=T)),me(n,Ul,T=>t(78,m=T)),me(n,Gn,T=>t(79,p=T)),me(n,On,T=>t(29,k=T)),me(n,Kl,T=>t(30,D=T)),me(n,rr,T=>t(31,_=T));const S=bt("i18n");me(n,S,T=>t(74,i=T));let{chatIdProp:E=""}=e,B=!1;const y=new EventTarget;let L=!1,V=!1,U=!0,M,I=!1,C="",W="",R=!1,A="",j="",G=null,x=!0,F=[""],ie,be=[],Ie=[],Y=!1,oe=null,lt="",Ue="",J=[],Qe=[],ue=[],X={messages:{},currentId:null},$={},ot;const ht=async(T,re)=>{var he,fe;if(T.chat_id===r){await Be(),console.log(T);let ke=X.messages[T.message_id];const P=((he=T==null?void 0:T.data)==null?void 0:he.type)??null,ae=((fe=T==null?void 0:T.data)==null?void 0:fe.data)??null;if(P==="status")ke!=null&&ke.statusHistory?ke.statusHistory.push(ae):ke.statusHistory=[ae];else if(P==="citation")ke!=null&&ke.citations?ke.citations.push(ae):ke.citations=[ae];else if(P==="message")ke.content+=ae.content;else if(P==="replace")ke.content=ae.content;else if(P==="action"){if(ae.action==="continue"){const je=document.getElementById("continue-response-button");je&&je.click()}}else P==="confirmation"?(t(14,G=re),t(11,R=!1),t(8,I=!0),t(9,C=ae.title),t(10,W=ae.message)):P==="input"?(t(14,G=re),t(11,R=!0),t(8,I=!0),t(9,C=ae.title),t(10,W=ae.message),t(12,A=ae.placeholder),t(13,j=(ae==null?void 0:ae.value)??"")):console.log("Unknown message type",ae);t(24,ue),t(3,X)}},Ct=async T=>{if(T.origin===window.origin){if(T.data.type==="input:prompt"){console.debug(T.data.text);const re=document.getElementById("chat-textarea");re&&(t(21,Ue=T.data.text),re.focus())}T.data.type==="action:submit"&&(console.debug(T.data.text),Ue!==""&&(await Be(),rt(Ue))),T.data.type==="input:prompt:submit"&&(console.debug(T.data.text),Ue!==""&&(await Be(),rt(T.data.text)))}};wl(async()=>{window.addEventListener("message",Ct),d==null||d.on("chat-events",ht),r?o&&await es("/"):ot=bl.subscribe(async T=>{T||await Ot()})}),ls(()=>{ot==null||ot(),window.removeEventListener("message",Ct),d==null||d.off("chat-events")});const Ot=async()=>{var he;p.url.pathname.includes("/c/")&&window.history.replaceState(X.state,"","/"),await bl.set(""),t(6,U=!0),t(20,lt=""),t(24,ue=[]),t(3,X={messages:{},currentId:null}),t(22,J=[]),t(25,$={}),p.url.searchParams.get("models")?t(1,F=(he=p.url.searchParams.get("models"))==null?void 0:he.split(",")):l!=null&&l.models?t(1,F=l==null?void 0:l.models):c!=null&&c.default_models?(console.log((c==null?void 0:c.default_models.split(","))??""),t(1,F=c==null?void 0:c.default_models.split(","))):t(1,F=[""]),p.url.searchParams.get("web-search")==="true"&&t(18,Y=!0),p.url.searchParams.get("q")&&(t(21,Ue=p.url.searchParams.get("q")??""),t(17,Ie=(p.url.searchParams.get("tool_ids")??"").split(",").map(fe=>fe.trim()).filter(fe=>fe)),Ue&&(await Be(),rt(Ue))),p.url.searchParams.get("call")==="true"&&Cl.set(!0),t(1,F=F.map(fe=>a.map(ke=>ke.id).includes(fe)?fe:""));const T=await _s(localStorage.token);T?Xt.set(T.ui):Xt.set(JSON.parse(localStorage.getItem("settings")??"{}"));const re=document.getElementById("chat-textarea");setTimeout(()=>re==null?void 0:re.focus(),0)},ct=async()=>{if(bl.set(E),t(19,oe=await ur(localStorage.token,r).catch(async T=>(await es("/"),null))),oe){await Ee();const T=oe.chat;if(T){console.log(T),t(1,F=((T==null?void 0:T.models)??void 0)!==void 0?T.models:[T.models??""]),t(3,X=((T==null?void 0:T.history)??void 0)!==void 0?T.history:ar(T.messages)),t(20,lt=T.title);const re=await _s(localStorage.token);return re?await Xt.set(re.ui):await Xt.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(25,$=(T==null?void 0:T.params)??{}),t(22,J=(T==null?void 0:T.files)??[]),t(6,U=!0),await Be(),ue.length>0&&t(3,X.messages[ue.at(-1).id].done=!0,X),await Be(),!0}else return null}},Ye=async()=>{await Be(),M&&t(7,M.scrollTop=M.scrollHeight,M)},gt=T=>{const re=X.messages[T];return re.parentId?[...gt(re.parentId),re]:[re]},K=async(T,re,he,fe)=>{await Jn.run({querySelector:".mermaid"});const ke=await Cr(localStorage.token,{model:re,messages:fe.map(P=>({id:P.id,role:P.role,content:P.content,info:P.info?P.info:void 0,timestamp:P.timestamp})),chat_id:T,session_id:d==null?void 0:d.id,id:he}).catch(P=>(Ce.error(P),fe.at(-1).error={content:P},null));if(ke!==null)for(const P of ke.messages)t(3,X.messages[P.id]={...X.messages[P.id],...X.messages[P.id].content!==P.content?{originalContent:X.messages[P.id].content}:{},...P},X);r==T&&(o||(t(19,oe=await ql(localStorage.token,T,{models:F,messages:fe,history:X,params:$,files:J})),vl.set(1),await Il.set(await Dl(localStorage.token,s))))},ve=async(T,re,he,fe,ke=null)=>{const P=await Sr(localStorage.token,re,{model:he,messages:ue.map(ae=>({id:ae.id,role:ae.role,content:ae.content,info:ae.info?ae.info:void 0,timestamp:ae.timestamp})),...ke?{event:ke}:{},chat_id:T,session_id:d==null?void 0:d.id,id:fe}).catch(ae=>(Ce.error(ae),ue.at(-1).error={content:ae},null));if(P!==null)for(const ae of P.messages)t(3,X.messages[ae.id]={...X.messages[ae.id],...X.messages[ae.id].content!==ae.content?{originalContent:X.messages[ae.id].content}:{},...ae},X);r==T&&(o||(t(19,oe=await ql(localStorage.token,T,{models:F,messages:ue,history:X,params:$,files:J})),vl.set(1),await Il.set(await Dl(localStorage.token,s))))},We=async(T,re="")=>setInterval(()=>{d==null||d.emit("usage",{action:"chat",model:T,chat_id:re})},1e3),rt=async(T,{_raw:re=!1}={})=>{var fe,ke,P;let he=[];if(console.log("submitPrompt",r),t(1,F=F.map(ae=>a.map(je=>je.id).includes(ae)?ae:"")),F.includes(""))Ce.error(i.t("Model not selected"));else if(ue.length!=0&&ue.at(-1).done!=!0)console.log("wait");else if(ue.length!=0&&ue.at(-1).error)Ce.error(i.t("Oops! There was an error in the previous response. Please try again or contact admin."));else if(Qe.length>0&&Qe.filter(ae=>ae.type!=="image"&&ae.status!=="processed").length>0)Ce.error(i.t("Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready."));else if((((fe=c==null?void 0:c.file)==null?void 0:fe.max_count)??null)!==null&&Qe.length+J.length>((ke=c==null?void 0:c.file)==null?void 0:ke.max_count))console.log(J.length,Qe.length),Ce.error(i.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(P=c==null?void 0:c.file)==null?void 0:P.max_count}));else{const ae=document.getElementById("chat-textarea");ae&&(ae.value="",ae.style.height="");const je=JSON.parse(JSON.stringify(Qe));J.push(...je.filter(nt=>["doc","file","collection"].includes(nt.type))),t(22,J=J.filter((nt,Xe,at)=>at.findIndex(yt=>JSON.stringify(yt)===JSON.stringify(nt))===Xe)),t(23,Qe=[]),t(21,Ue="");let Ke=ms(),st={id:Ke,parentId:ue.length!==0?ue.at(-1).id:null,childrenIds:[],role:"user",content:T,files:je.length>0?je:void 0,timestamp:Math.floor(Date.now()/1e3),models:F};t(3,X.messages[Ke]=st,X),t(3,X.currentId=Ke,X),ue.length!==0&&X.messages[ue.at(-1).id].childrenIds.push(Ke),await Be(),he=await $e(T,Ke,{newChat:!0})}return he},$e=async(T,re,{modelId:he=null,modelIdx:fe=null,newChat:ke=!1}={})=>{let P=[],ae=he?[he]:ie!==void 0?[ie.id]:F;const je={};for(const[st,nt]of ae.entries()){const Xe=a.filter(at=>at.id===nt).at(0);if(Xe){let at=ms(),yt={parentId:re,id:at,childrenIds:[],role:"assistant",content:"",model:Xe.id,modelName:Xe.name??Xe.id,modelIdx:fe||st,userContext:null,timestamp:Math.floor(Date.now()/1e3)};t(3,X.messages[at]=yt,X),t(3,X.currentId=at,X),re!==null&&t(3,X.messages[re].childrenIds=[...X.messages[re].childrenIds,at],X),je[`${nt}-${fe||st}`]=at}}await Be(),ke&&ue.length==2&&(o?await bl.set("local"):(t(19,oe=await fr(localStorage.token,{id:r,title:i.t("New Chat"),models:F,system:l.system??void 0,params:$,messages:ue,history:X,tags:[],timestamp:Date.now()})),vl.set(1),await Il.set(await Dl(localStorage.token,s)),await bl.set(oe.id)),await Be());const Ke=JSON.parse(JSON.stringify(r));return await Promise.all(ae.map(async(st,nt)=>{var at,yt,et;console.log("modelId",st);const Xe=a.filter(Ze=>Ze.id===st).at(0);if(Xe){ue.some(vt=>{var It;return(It=vt.files)==null?void 0:It.some(Vt=>Vt.type==="image")})&&!(((et=(yt=(at=Xe.info)==null?void 0:at.meta)==null?void 0:yt.capabilities)==null?void 0:et.vision)??!0)&&Ce.error(i.t("Model {{modelName}} is not vision capable",{modelName:Xe.name??Xe.id}));let Et=je[`${st}-${fe||nt}`],Yt=X.messages[Et],Ut=null;if(((l==null?void 0:l.memory)??!1)&&Ut===null){const vt=await yr(localStorage.token,T).catch(It=>(Ce.error(It),null));vt&&(vt.documents[0].length>0&&(Ut=vt.documents[0].reduce((It,Vt,Jt)=>{const Ft=vt.metadatas[0][Jt].created_at,Le=new Date(Ft*1e3).toISOString().split("T")[0];return`${It}${Jt+1}. [${Le}]. ${Vt}
`},"")),console.log(Ut))}Yt.userContext=Ut;const At=await We(Xe.id,Ke);Ye(),Y&&await we(Xe.id,re,Et);let pt=null;(Xe==null?void 0:Xe.owned_by)==="openai"?pt=await _t(Xe,T,Et,Ke):Xe&&(pt=await wt(Xe,T,Et,Ke)),P.push(pt),At&&clearInterval(At)}else Ce.error(i.t("Model {{modelId}} not found",{modelId:st}))})),vl.set(1),Il.set(await Dl(localStorage.token,s)),P},wt=async(T,re,he,fe)=>{var yt,et,Ze,Et,Yt,Ut,At,pt,vt,It,Vt,Jt,Ft;let ke=null;const P=X.messages[he],ae=X.messages[P.parentId];await Be(),Ye();const je=[$!=null&&$.system||l.system||((P==null?void 0:P.userContext)??null)?{role:"system",content:`${gs(($==null?void 0:$.system)??(l==null?void 0:l.system)??"",m.name,l!=null&&l.userLocation?await vs(localStorage.token):void 0)}${(P==null?void 0:P.userContext)??null?`

User Context:
${(P==null?void 0:P.userContext)??""}`:""}`}:void 0,...ue].filter(Le=>{var mt;return(mt=Le==null?void 0:Le.content)==null?void 0:mt.trim()}).map(Le=>{var dt;const mt={role:Le.role,content:Le.content},ft=(dt=Le.files)==null?void 0:dt.filter(Ae=>Ae.type==="image").map(Ae=>Ae.url.slice(Ae.url.indexOf(",")+1));return ft&&ft.length>0&&Le.role==="user"&&(mt.images=ft),mt});let Ke=-1;je.forEach((Le,mt)=>{Le.images&&(Ke=mt)}),je.forEach((Le,mt)=>{mt!==Ke&&delete Le.images});let st=JSON.parse(JSON.stringify(J));(((et=(yt=T==null?void 0:T.info)==null?void 0:yt.meta)==null?void 0:et.knowledge)??!1)&&(P.statusHistory=[{action:"knowledge_search",description:i.t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:ae.content}),done:!1}],st.push(...T.info.meta.knowledge),t(24,ue),t(3,X)),st.push(...((ae==null?void 0:ae.files)??[]).filter(Le=>["doc","file","collection"].includes(Le.type)),...((P==null?void 0:P.files)??[]).filter(Le=>["web_search_results"].includes(Le.type))),Ye(),y.dispatchEvent(new CustomEvent("chat:start",{detail:{id:he}})),await Be();const[nt,Xe]=await ir(localStorage.token,{stream:!0,model:T.id,messages:je,options:{...(l==null?void 0:l.params)??{},...$,stop:($==null?void 0:$.stop)??((Ze=l==null?void 0:l.params)==null?void 0:Ze.stop)??void 0?(($==null?void 0:$.stop.split(",").map(Le=>Le.trim()))??l.params.stop).map(Le=>decodeURIComponent(JSON.parse('"'+Le.replace(/\"/g,'\\"')+'"'))):void 0,num_predict:($==null?void 0:$.max_tokens)??((Et=l==null?void 0:l.params)==null?void 0:Et.max_tokens)??void 0,repeat_penalty:($==null?void 0:$.frequency_penalty)??((Yt=l==null?void 0:l.params)==null?void 0:Yt.frequency_penalty)??void 0},format:l.requestFormat??void 0,keep_alive:l.keepAlive??void 0,tool_ids:Ie.length>0?Ie:void 0,files:st.length>0?st:void 0,session_id:d==null?void 0:d.id,chat_id:r,id:he});if(nt&&nt.ok){console.log("controller",Xe);const Le=nt.body.pipeThrough(new TextDecoderStream).pipeThrough(or(`
`)).getReader();for(;;){const{value:mt,done:ft}=await Le.read();if(ft||V||fe!==r){if(P.done=!0,t(24,ue),t(3,X),V)Xe.abort("User: Stop Response");else{const dt=gt(he);await K(fe,T.id,he,dt)}ke=P.content;break}try{let dt=mt.split(`
`);for(const Ae of dt)if(Ae!==""){console.log(Ae);let tt=JSON.parse(Ae);if("citations"in tt){P.citations=tt.citations,(((At=(Ut=T==null?void 0:T.info)==null?void 0:Ut.meta)==null?void 0:At.knowledge)??!1)&&(P.statusHistory=P.statusHistory.filter(ut=>ut.action!=="knowledge_search"));continue}if("detail"in tt)throw tt;if(tt.done==!1){if(P.content==""&&tt.message.content==`
`)continue;{P.content+=tt.message.content,navigator.vibrate&&((l==null?void 0:l.hapticFeedback)??!1)&&navigator.vibrate(5);const ut=Zl(P.content,((vt=(pt=c==null?void 0:c.audio)==null?void 0:pt.tts)==null?void 0:vt.split_on)??"punctuation");ut.pop(),ut.length>0&&ut[ut.length-1]!==P.lastSentence&&(P.lastSentence=ut[ut.length-1],y.dispatchEvent(new CustomEvent("chat",{detail:{id:he,content:ut[ut.length-1]}}))),t(24,ue),t(3,X)}}else{if(P.done=!0,P.content==""&&(P.error={code:400,content:"Oops! No text generated from Ollama, Please try again."}),P.context=tt.context??null,P.info={total_duration:tt.total_duration,load_duration:tt.load_duration,sample_count:tt.sample_count,sample_duration:tt.sample_duration,prompt_eval_count:tt.prompt_eval_count,prompt_eval_duration:tt.prompt_eval_duration,eval_count:tt.eval_count,eval_duration:tt.eval_duration},t(24,ue),t(3,X),l.notificationEnabled&&!document.hasFocus()){const ut=new Notification(`${T.id}`,{body:P.content,icon:`${zl}/static/13-Copy.png`})}((l==null?void 0:l.responseAutoCopy)??!1)&&ps(P.content),l.responseAutoPlayback&&!f&&(await Be(),(It=document.getElementById(`speak-button-${P.id}`))==null||It.click())}}}catch(dt){console.log(dt),"detail"in dt&&Ce.error(dt.detail);break}U&&Ye()}}else{if(nt!==null){const Le=await nt.json();console.log(Le),"detail"in Le?(Ce.error(Le.detail),P.error={content:Le.detail}):(Ce.error(Le.error),P.error={content:Le.error})}else Ce.error(i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})),P.error={content:i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:"Ollama"})};P.done=!0,P.statusHistory&&(P.statusHistory=P.statusHistory.filter(Le=>Le.action!=="knowledge_search")),t(24,ue),t(3,X)}await H(fe),V=!1,await Be();let at=((Ft=Zl(P.content,((Jt=(Vt=c==null?void 0:c.audio)==null?void 0:Vt.tts)==null?void 0:Jt.split_on)??"punctuation"))==null?void 0:Ft.at(-1))??"";if(at&&y.dispatchEvent(new CustomEvent("chat",{detail:{id:he,content:at}})),y.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:he,content:P.content}})),U&&Ye(),ue.length==2&&ue.at(1).content!==""&&F[0]===T.id){window.history.replaceState(X.state,"",`/c/${fe}`);const Le=await Q(re);await Se(fe,Le)}return ke},_t=async(T,re,he,fe)=>{var st,nt,Xe,at,yt,et,Ze,Et,Yt,Ut,At,pt,vt,It,Vt,Jt,Ft,Le,mt;let ke=null;const P=X.messages[he],ae=X.messages[P.parentId];let je=JSON.parse(JSON.stringify(J));(((nt=(st=T==null?void 0:T.info)==null?void 0:st.meta)==null?void 0:nt.knowledge)??!1)&&(P.statusHistory=[{action:"knowledge_search",description:i.t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:ae.content}),done:!1}],je.push(...T.info.meta.knowledge),t(24,ue),t(3,X)),je.push(...((ae==null?void 0:ae.files)??[]).filter(ft=>["doc","file","collection"].includes(ft.type)),...((P==null?void 0:P.files)??[]).filter(ft=>["web_search_results"].includes(ft.type))),Ye(),y.dispatchEvent(new CustomEvent("chat:start",{detail:{id:he}})),await Be();try{const[ft,dt]=await hr(localStorage.token,{stream:!0,model:T.id,stream_options:((yt=(at=(Xe=T.info)==null?void 0:Xe.meta)==null?void 0:at.capabilities)==null?void 0:yt.usage)??!1?{include_usage:!0}:void 0,messages:[$!=null&&$.system||l.system||((P==null?void 0:P.userContext)??null)?{role:"system",content:`${gs(($==null?void 0:$.system)??(l==null?void 0:l.system)??"",m.name,l!=null&&l.userLocation?await vs(localStorage.token):void 0)}${(P==null?void 0:P.userContext)??null?`

User Context:
${(P==null?void 0:P.userContext)??""}`:""}`}:void 0,...ue].filter(Ae=>{var tt;return(tt=Ae==null?void 0:Ae.content)==null?void 0:tt.trim()}).map((Ae,tt,ut)=>{var pl;return{role:Ae.role,...((pl=Ae.files)==null?void 0:pl.filter(Pt=>Pt.type==="image").length)>0&&Ae.role==="user"?{content:[{type:"text",text:ut.length-1!==tt?Ae.content:(Ae==null?void 0:Ae.raContent)??Ae.content},...Ae.files.filter(Pt=>Pt.type==="image").map(Pt=>({type:"image_url",image_url:{url:Pt.url}}))]}:{content:ut.length-1!==tt?Ae.content:(Ae==null?void 0:Ae.raContent)??Ae.content}}}),seed:($==null?void 0:$.seed)??((et=l==null?void 0:l.params)==null?void 0:et.seed)??void 0,stop:($==null?void 0:$.stop)??((Ze=l==null?void 0:l.params)==null?void 0:Ze.stop)??void 0?(($==null?void 0:$.stop.split(",").map(Ae=>Ae.trim()))??l.params.stop).map(Ae=>decodeURIComponent(JSON.parse('"'+Ae.replace(/\"/g,'\\"')+'"'))):void 0,temperature:($==null?void 0:$.temperature)??((Et=l==null?void 0:l.params)==null?void 0:Et.temperature)??void 0,top_p:($==null?void 0:$.top_p)??((Yt=l==null?void 0:l.params)==null?void 0:Yt.top_p)??void 0,frequency_penalty:($==null?void 0:$.frequency_penalty)??((Ut=l==null?void 0:l.params)==null?void 0:Ut.frequency_penalty)??void 0,max_tokens:($==null?void 0:$.max_tokens)??((At=l==null?void 0:l.params)==null?void 0:At.max_tokens)??void 0,tool_ids:Ie.length>0?Ie:void 0,files:je.length>0?je:void 0,session_id:d==null?void 0:d.id,chat_id:r,id:he},`${zl}/api`);if(await Be(),Ye(),ft&&ft.ok&&ft.body){const Ae=await Vs(ft.body,l.splitLargeChunks);for await(const tt of Ae){const{value:ut,done:pl,citations:Pt,error:Nl,usage:_l}=tt;if(Nl){await Gt(Nl,null,T,P);break}if(pl||V||fe!==r){if(P.done=!0,t(24,ue),t(3,X),V)dt.abort("User: Stop Response");else{const Dt=gt(he);await K(fe,T.id,he,Dt)}ke=P.content;break}if(_l&&(P.info={..._l,openai:!0}),Pt){P.citations=Pt,(((vt=(pt=T==null?void 0:T.info)==null?void 0:pt.meta)==null?void 0:vt.knowledge)??!1)&&(P.statusHistory=P.statusHistory.filter(Dt=>Dt.action!=="knowledge_search"));continue}if(!(P.content==""&&ut==`
`)){{P.content+=ut,navigator.vibrate&&((l==null?void 0:l.hapticFeedback)??!1)&&navigator.vibrate(5);const Dt=Zl(P.content,((Vt=(It=c==null?void 0:c.audio)==null?void 0:It.tts)==null?void 0:Vt.split_on)??"punctuation");Dt.pop(),Dt.length>0&&Dt[Dt.length-1]!==P.lastSentence&&(P.lastSentence=Dt[Dt.length-1],y.dispatchEvent(new CustomEvent("chat",{detail:{id:he,content:Dt[Dt.length-1]}}))),t(24,ue),t(3,X)}U&&Ye()}}if(l.notificationEnabled&&!document.hasFocus()){const tt=new Notification(`${T.id}`,{body:P.content,icon:`${zl}/static/13-Copy.png`})}l.responseAutoCopy&&ps(P.content),l.responseAutoPlayback&&!f&&(await Be(),(Jt=document.getElementById(`speak-button-${P.id}`))==null||Jt.click())}else await Gt(null,ft,T,P)}catch(ft){await Gt(ft,null,T,P)}await H(fe),t(24,ue),t(3,X),V=!1,await Be();let Ke=((mt=Zl(P.content,((Le=(Ft=c==null?void 0:c.audio)==null?void 0:Ft.tts)==null?void 0:Le.split_on)??"punctuation"))==null?void 0:mt.at(-1))??"";if(Ke&&y.dispatchEvent(new CustomEvent("chat",{detail:{id:he,content:Ke}})),y.dispatchEvent(new CustomEvent("chat:finish",{detail:{id:he,content:P.content}})),U&&Ye(),ue.length==2&&F[0]===T.id){window.history.replaceState(X.state,"",`/c/${fe}`);const ft=await Q(re);await Se(fe,ft)}return ke},Gt=async(T,re,he,fe)=>{let ke="",P;T?P=T:re!==null&&(P=await re.json()),console.error(P),"detail"in P?(Ce.error(P.detail),ke=P.detail):"error"in P?"message"in P.error?(Ce.error(P.error.message),ke=P.error.message):(Ce.error(P.error),ke=P.error):"message"in P&&(Ce.error(P.message),ke=P.message),fe.error={content:i.t("Uh-oh! There was an issue connecting to {{provider}}.",{provider:he.name??he.id})+`
`+ke},fe.done=!0,fe.statusHistory&&(fe.statusHistory=fe.statusHistory.filter(ae=>ae.action!=="knowledge_search")),t(24,ue),t(3,X)},tl=()=>{V=!0,console.log("stopResponse")},St=async T=>{if(console.log("regenerateResponse"),ue.length!=0){let re=X.messages[T.parentId],he=re.content;((re==null?void 0:re.models)??[...F]).length==1?await $e(he,re.id):await $e(he,re.id,{modelId:T.model,modelIdx:T.modelIdx})}},jt=async()=>{console.log("continueGeneration");const T=JSON.parse(JSON.stringify(r));if(ue.length!=0&&ue.at(-1).done==!0){const re=X.messages[X.currentId];re.done=!1,await Be();const he=a.filter(fe=>fe.id===re.model).at(0);he&&((he==null?void 0:he.owned_by)==="openai"?await _t(he,X.messages[re.parentId].content,re.id,T):await wt(he,X.messages[re.parentId].content,re.id,T))}else Ce.error(i.t("Model {{modelId}} not found",{modelId}))},Q=async T=>{var re;return((re=l==null?void 0:l.title)==null?void 0:re.auto)??!0?await Ir(localStorage.token,F[0],T,r).catch(fe=>(console.error(fe),"New Chat")):`${T}`},Se=async(T,re)=>{T===r&&t(20,lt=re),o||(t(19,oe=await ql(localStorage.token,T,{title:re})),vl.set(1),await Il.set(await Dl(localStorage.token,s)))},we=async(T,re,he)=>{const fe=X.messages[he],ke=X.messages[re];fe.statusHistory=[{done:!1,action:"web_search",description:i.t("Generating search query")}],t(24,ue),t(3,X);const P=ke.content;let ae=await Dr(localStorage.token,T,ue.filter(Ke=>{var st;return(st=Ke==null?void 0:Ke.content)==null?void 0:st.trim()}),P).catch(Ke=>(console.log(Ke),P));if(!ae||ae==""){fe.statusHistory.push({done:!0,error:!0,action:"web_search",description:i.t("No search query generated")}),t(24,ue),t(3,X);return}fe.statusHistory.push({done:!1,action:"web_search",description:i.t('Searching "{{searchQuery}}"',{searchQuery:ae})}),t(24,ue),t(3,X);const je=await vr(localStorage.token,ae).catch(Ke=>(console.log(Ke),Ce.error(Ke),null));je?(fe.statusHistory.push({done:!0,action:"web_search",description:i.t("Searched {{count}} sites",{count:je.filenames.length}),query:ae,urls:je.filenames}),((fe==null?void 0:fe.files)??!0)&&(fe.files=[]),fe.files.push({collection_name:je.collection_name,name:ae,type:"web_search_results",urls:je.filenames}),t(24,ue),t(3,X)):(fe.statusHistory.push({done:!0,error:!0,action:"web_search",description:"No search results found"}),t(24,ue),t(3,X))},Ee=async()=>await dr(localStorage.token,r).catch(async T=>[]),H=async T=>{r==T&&(o||(t(19,oe=await ql(localStorage.token,T,{messages:ue,history:X,models:F,params:$,files:J})),vl.set(1),await Il.set(await Dl(localStorage.token,s))))},ne=async(T,re,he)=>{console.log("mergeResponses",T,re);const fe=X.messages[T],ke={status:!0,content:""};fe.merged=ke,t(24,ue),t(3,X);try{const[P,ae]=await Tr(localStorage.token,fe.model,X.messages[fe.parentId].content,re);if(P&&P.ok&&P.body){const je=await Vs(P.body,l.splitLargeChunks);for await(const Ke of je){const{value:st,done:nt,citations:Xe,error:at,usage:yt}=Ke;if(at||nt)break;ke.content==""&&st==`
`||(ke.content+=st,t(24,ue),t(3,X),U&&Ye())}await H(he)}else console.error(P)}catch(P){console.error(P)}};function de(T){I=T,t(8,I)}const Te=T=>{T.detail?G(T.detail):G(!0)},Ve=()=>{G(!1)};function Oe(T){F=T,t(1,F)}function kt(T){x=T,t(15,x)}function Tt(T){L=T,t(5,L)}const ll=T=>T.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(T.id):!0,Ml=T=>{const re=T.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([re,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(he=>_.find(fe=>fe.id===he))))};function rl(T){X=T,t(3,X)}function ol(T){ue=T,t(24,ue),t(3,X)}function hl(T){U=T,t(6,U)}function kl(T){Ue=T,t(21,Ue)}function Hl(T){_e[T?"unshift":"push"](()=>{M=T,t(7,M)})}const al=T=>{t(6,U=M.scrollHeight-M.scrollTop<=M.clientHeight+5)},il=(T,re,he,fe)=>{var P,ae;const ke=a.find(je=>je.id===re);return((ae=(P=ke==null?void 0:ke.info)==null?void 0:P.meta)==null?void 0:ae.toolIds)??!1?[...new Set([...T,...ke.info.meta.toolIds])]:T};function Rt(T){Qe=T,t(23,Qe)}function Qt(T){Ue=T,t(21,Ue)}function cl(T){U=T,t(6,U)}function ml(T){Ie=T,t(17,Ie)}function yl(T){Y=T,t(18,Y)}function Bl(T){ie=T,t(2,ie)}const sl=()=>{t(5,L=!0)},Pl=(T,re,he,fe)=>{const ke=a.find(P=>P.id===re);return ke?[...T,ke]:T};function Ll(T){L=T,t(5,L)}function Kt(T){J=T,t(22,J)}function fl(T){$=T,t(25,$)}function gl(T){Qe=T,t(23,Qe)}return n.$$set=T=>{"chatIdProp"in T&&t(0,E=T.chatIdProp)},n.$$.update=()=>{if(n.$$.dirty[0]&6&&t(16,be=ie!==void 0?[ie.id]:F),n.$$.dirty[0]&8)if(X.currentId!==null){let T=[],re=X.messages[X.currentId];for(;re!==null;)T.unshift({...re}),re=re.parentId!==null?X.messages[re.parentId]:null;t(24,ue=T)}else t(24,ue=[]);n.$$.dirty[0]&1&&E&&(async()=>{if(console.log(E),E&&await ct()){await Be(),t(4,B=!0),window.setTimeout(()=>Ye(),0);const T=document.getElementById("chat-textarea");T==null||T.focus()}else await es("/")})()},[E,F,ie,X,B,L,U,M,I,C,W,R,A,j,G,x,be,Ie,Y,oe,lt,Ue,J,Qe,ue,$,l,r,a,k,D,_,S,y,Ot,ve,rt,$e,tl,St,jt,ne,de,Te,Ve,Oe,kt,Tt,ll,Ml,rl,ol,hl,kl,Hl,al,il,Rt,Qt,cl,ml,yl,Bl,sl,Pl,Ll,Kt,fl,gl]}class Of extends Je{constructor(e){super(),Ge(this,e,Sc,Dc,xe,{chatIdProp:0},null,[-1,-1,-1,-1])}}function Tc(n){let e,t,l,s=n[1].t("Keyboard shortcuts")+"",o,r,i,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,f,d,m,p,k,D=n[1].t("Open new chat")+"",_,S,E,B='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">O</div>',y,L,V,U=n[1].t("Focus chat input")+"",M,I,C,W='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Esc</div>',R,A,j,G=n[1].t("Copy last code block")+"",x,F,ie,be='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">;</div>',Ie,Y,oe,lt=n[1].t("Copy last response")+"",Ue,J,Qe,ue='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">C</div>',X,$,ot,ht,Ct=n[1].t("Toggle settings")+"",Ot,ct,Ye,gt='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">.</div>',K,ve,We,rt=n[1].t("Toggle sidebar")+"",$e,wt,_t,Gt='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">S</div>',tl,St,jt,Q=n[1].t("Delete chat")+"",Se,we,Ee,H='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">âŒ«</div>',ne,de,Te,Ve=n[1].t("Show shortcuts")+"",Oe,kt,Tt,ll='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',Ml,rl,ol,hl=n[1].t("Input commands")+"",kl,Hl,al,il,Rt,Qt,cl,ml=n[1].t("Attach file")+"",yl,Bl,sl,Pl='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">#</div>',Ll,Kt,fl,gl=n[1].t("Add custom prompt")+"",T,re,he,fe='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',ke,P,ae,je=n[1].t("Select model")+"",Ke,st,nt,Xe='<div class="h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">@</div>',at,yt;return{c(){e=v("div"),t=v("div"),l=v("div"),o=ge(s),r=Z(),i=v("button"),i.innerHTML=a,c=Z(),f=v("div"),d=v("div"),m=v("div"),p=v("div"),k=v("div"),_=ge(D),S=Z(),E=v("div"),E.innerHTML=B,y=Z(),L=v("div"),V=v("div"),M=ge(U),I=Z(),C=v("div"),C.innerHTML=W,R=Z(),A=v("div"),j=v("div"),x=ge(G),F=Z(),ie=v("div"),ie.innerHTML=be,Ie=Z(),Y=v("div"),oe=v("div"),Ue=ge(lt),J=Z(),Qe=v("div"),Qe.innerHTML=ue,X=Z(),$=v("div"),ot=v("div"),ht=v("div"),Ot=ge(Ct),ct=Z(),Ye=v("div"),Ye.innerHTML=gt,K=Z(),ve=v("div"),We=v("div"),$e=ge(rt),wt=Z(),_t=v("div"),_t.innerHTML=Gt,tl=Z(),St=v("div"),jt=v("div"),Se=ge(Q),we=Z(),Ee=v("div"),Ee.innerHTML=H,ne=Z(),de=v("div"),Te=v("div"),Oe=ge(Ve),kt=Z(),Tt=v("div"),Tt.innerHTML=ll,Ml=Z(),rl=v("div"),ol=v("div"),kl=ge(hl),Hl=Z(),al=v("div"),il=v("div"),Rt=v("div"),Qt=v("div"),cl=v("div"),yl=ge(ml),Bl=Z(),sl=v("div"),sl.innerHTML=Pl,Ll=Z(),Kt=v("div"),fl=v("div"),T=ge(gl),re=Z(),he=v("div"),he.innerHTML=fe,ke=Z(),P=v("div"),ae=v("div"),Ke=ge(je),st=Z(),nt=v("div"),nt.innerHTML=Xe,this.h()},l(et){e=b(et,"DIV",{class:!0});var Ze=w(e);t=b(Ze,"DIV",{class:!0});var Et=w(t);l=b(Et,"DIV",{class:!0});var Yt=w(l);o=pe(Yt,s),Yt.forEach(h),r=q(Et),i=b(Et,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(i)!=="svelte-745w2y"&&(i.innerHTML=a),Et.forEach(h),c=q(Ze),f=b(Ze,"DIV",{class:!0});var Ut=w(f);d=b(Ut,"DIV",{class:!0});var At=w(d);m=b(At,"DIV",{class:!0});var pt=w(m);p=b(pt,"DIV",{class:!0});var vt=w(p);k=b(vt,"DIV",{class:!0});var It=w(k);_=pe(It,D),It.forEach(h),S=q(vt),E=b(vt,"DIV",{class:!0,"data-svelte-h":!0}),qe(E)!=="svelte-lcmjz9"&&(E.innerHTML=B),vt.forEach(h),y=q(pt),L=b(pt,"DIV",{class:!0});var Vt=w(L);V=b(Vt,"DIV",{class:!0});var Jt=w(V);M=pe(Jt,U),Jt.forEach(h),I=q(Vt),C=b(Vt,"DIV",{class:!0,"data-svelte-h":!0}),qe(C)!=="svelte-1c7wvdz"&&(C.innerHTML=W),Vt.forEach(h),R=q(pt),A=b(pt,"DIV",{class:!0});var Ft=w(A);j=b(Ft,"DIV",{class:!0});var Le=w(j);x=pe(Le,G),Le.forEach(h),F=q(Ft),ie=b(Ft,"DIV",{class:!0,"data-svelte-h":!0}),qe(ie)!=="svelte-1vgtrzt"&&(ie.innerHTML=be),Ft.forEach(h),Ie=q(pt),Y=b(pt,"DIV",{class:!0});var mt=w(Y);oe=b(mt,"DIV",{class:!0});var ft=w(oe);Ue=pe(ft,lt),ft.forEach(h),J=q(mt),Qe=b(mt,"DIV",{class:!0,"data-svelte-h":!0}),qe(Qe)!=="svelte-m149u9"&&(Qe.innerHTML=ue),mt.forEach(h),pt.forEach(h),X=q(At),$=b(At,"DIV",{class:!0});var dt=w($);ot=b(dt,"DIV",{class:!0});var Ae=w(ot);ht=b(Ae,"DIV",{class:!0});var tt=w(ht);Ot=pe(tt,Ct),tt.forEach(h),ct=q(Ae),Ye=b(Ae,"DIV",{class:!0,"data-svelte-h":!0}),qe(Ye)!=="svelte-1lfzi34"&&(Ye.innerHTML=gt),Ae.forEach(h),K=q(dt),ve=b(dt,"DIV",{class:!0});var ut=w(ve);We=b(ut,"DIV",{class:!0});var pl=w(We);$e=pe(pl,rt),pl.forEach(h),wt=q(ut),_t=b(ut,"DIV",{class:!0,"data-svelte-h":!0}),qe(_t)!=="svelte-1egz3pd"&&(_t.innerHTML=Gt),ut.forEach(h),tl=q(dt),St=b(dt,"DIV",{class:!0});var Pt=w(St);jt=b(Pt,"DIV",{class:!0});var Nl=w(jt);Se=pe(Nl,Q),Nl.forEach(h),we=q(Pt),Ee=b(Pt,"DIV",{class:!0,"data-svelte-h":!0}),qe(Ee)!=="svelte-1b065vn"&&(Ee.innerHTML=H),Pt.forEach(h),ne=q(dt),de=b(dt,"DIV",{class:!0});var _l=w(de);Te=b(_l,"DIV",{class:!0});var Dt=w(Te);Oe=pe(Dt,Ve),Dt.forEach(h),kt=q(_l),Tt=b(_l,"DIV",{class:!0,"data-svelte-h":!0}),qe(Tt)!=="svelte-714lzr"&&(Tt.innerHTML=ll),_l.forEach(h),dt.forEach(h),At.forEach(h),Ut.forEach(h),Ml=q(Ze),rl=b(Ze,"DIV",{class:!0});var rs=w(rl);ol=b(rs,"DIV",{class:!0});var os=w(ol);kl=pe(os,hl),os.forEach(h),rs.forEach(h),Hl=q(Ze),al=b(Ze,"DIV",{class:!0});var as=w(al);il=b(as,"DIV",{class:!0});var is=w(il);Rt=b(is,"DIV",{class:!0});var El=w(Rt);Qt=b(El,"DIV",{class:!0});var jl=w(Qt);cl=b(jl,"DIV",{class:!0});var cs=w(cl);yl=pe(cs,ml),cs.forEach(h),Bl=q(jl),sl=b(jl,"DIV",{class:!0,"data-svelte-h":!0}),qe(sl)!=="svelte-11t0lmd"&&(sl.innerHTML=Pl),jl.forEach(h),Ll=q(El),Kt=b(El,"DIV",{class:!0});var Rl=w(Kt);fl=b(Rl,"DIV",{class:!0});var fs=w(fl);T=pe(fs,gl),fs.forEach(h),re=q(Rl),he=b(Rl,"DIV",{class:!0,"data-svelte-h":!0}),qe(he)!=="svelte-1s9pky1"&&(he.innerHTML=fe),Rl.forEach(h),ke=q(El),P=b(El,"DIV",{class:!0});var Fl=w(P);ae=b(Fl,"DIV",{class:!0});var us=w(ae);Ke=pe(us,je),us.forEach(h),st=q(Fl),nt=b(Fl,"DIV",{class:!0,"data-svelte-h":!0}),qe(nt)!=="svelte-oivy56"&&(nt.innerHTML=Xe),Fl.forEach(h),El.forEach(h),is.forEach(h),as.forEach(h),Ze.forEach(h),this.h()},h(){u(l,"class","text-lg font-medium self-center"),u(i,"class","self-center"),u(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4"),u(k,"class","text-sm"),u(E,"class","flex space-x-1 text-xs"),u(p,"class","w-full flex justify-between items-center"),u(V,"class","text-sm"),u(C,"class","flex space-x-1 text-xs"),u(L,"class","w-full flex justify-between items-center"),u(j,"class","text-sm"),u(ie,"class","flex space-x-1 text-xs"),u(A,"class","w-full flex justify-between items-center"),u(oe,"class","text-sm"),u(Qe,"class","flex space-x-1 text-xs"),u(Y,"class","w-full flex justify-between items-center"),u(m,"class","flex flex-col space-y-3 w-full self-start"),u(ht,"class","text-sm"),u(Ye,"class","flex space-x-1 text-xs"),u(ot,"class","w-full flex justify-between items-center"),u(We,"class","text-sm"),u(_t,"class","flex space-x-1 text-xs"),u(ve,"class","w-full flex justify-between items-center"),u(jt,"class","text-sm"),u(Ee,"class","flex space-x-1 text-xs"),u(St,"class","w-full flex justify-between items-center"),u(Te,"class","text-sm"),u(Tt,"class","flex space-x-1 text-xs"),u(de,"class","w-full flex justify-between items-center"),u($,"class","flex flex-col space-y-3 w-full self-start"),u(d,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),u(f,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),u(ol,"class","text-lg font-medium self-center"),u(rl,"class","flex justify-between dark:text-gray-300 px-5"),u(cl,"class","text-sm"),u(sl,"class","flex space-x-1 text-xs"),u(Qt,"class","w-full flex justify-between items-center"),u(fl,"class","text-sm"),u(he,"class","flex space-x-1 text-xs"),u(Kt,"class","w-full flex justify-between items-center"),u(ae,"class","text-sm"),u(nt,"class","flex space-x-1 text-xs"),u(P,"class","w-full flex justify-between items-center"),u(Rt,"class","flex flex-col space-y-3 w-full self-start"),u(il,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),u(al,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),u(e,"class","text-gray-700 dark:text-gray-100")},m(et,Ze){z(et,e,Ze),g(e,t),g(t,l),g(l,o),g(t,r),g(t,i),g(e,c),g(e,f),g(f,d),g(d,m),g(m,p),g(p,k),g(k,_),g(p,S),g(p,E),g(m,y),g(m,L),g(L,V),g(V,M),g(L,I),g(L,C),g(m,R),g(m,A),g(A,j),g(j,x),g(A,F),g(A,ie),g(m,Ie),g(m,Y),g(Y,oe),g(oe,Ue),g(Y,J),g(Y,Qe),g(d,X),g(d,$),g($,ot),g(ot,ht),g(ht,Ot),g(ot,ct),g(ot,Ye),g($,K),g($,ve),g(ve,We),g(We,$e),g(ve,wt),g(ve,_t),g($,tl),g($,St),g(St,jt),g(jt,Se),g(St,we),g(St,Ee),g($,ne),g($,de),g(de,Te),g(Te,Oe),g(de,kt),g(de,Tt),g(e,Ml),g(e,rl),g(rl,ol),g(ol,kl),g(e,Hl),g(e,al),g(al,il),g(il,Rt),g(Rt,Qt),g(Qt,cl),g(cl,yl),g(Qt,Bl),g(Qt,sl),g(Rt,Ll),g(Rt,Kt),g(Kt,fl),g(fl,T),g(Kt,re),g(Kt,he),g(Rt,ke),g(Rt,P),g(P,ae),g(ae,Ke),g(P,st),g(P,nt),at||(yt=ce(i,"click",n[3]),at=!0)},p(et,Ze){Ze&2&&s!==(s=et[1].t("Keyboard shortcuts")+"")&&ye(o,s),Ze&2&&D!==(D=et[1].t("Open new chat")+"")&&ye(_,D),Ze&2&&U!==(U=et[1].t("Focus chat input")+"")&&ye(M,U),Ze&2&&G!==(G=et[1].t("Copy last code block")+"")&&ye(x,G),Ze&2&&lt!==(lt=et[1].t("Copy last response")+"")&&ye(Ue,lt),Ze&2&&Ct!==(Ct=et[1].t("Toggle settings")+"")&&ye(Ot,Ct),Ze&2&&rt!==(rt=et[1].t("Toggle sidebar")+"")&&ye($e,rt),Ze&2&&Q!==(Q=et[1].t("Delete chat")+"")&&ye(Se,Q),Ze&2&&Ve!==(Ve=et[1].t("Show shortcuts")+"")&&ye(Oe,Ve),Ze&2&&hl!==(hl=et[1].t("Input commands")+"")&&ye(kl,hl),Ze&2&&ml!==(ml=et[1].t("Attach file")+"")&&ye(yl,ml),Ze&2&&gl!==(gl=et[1].t("Add custom prompt")+"")&&ye(T,gl),Ze&2&&je!==(je=et[1].t("Select model")+"")&&ye(Ke,je)},d(et){et&&h(e),at=!1,yt()}}}function Vc(n){let e,t,l;function s(r){n[4](r)}let o={$$slots:{default:[Tc]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.show=n[0]),e=new Wr({props:o}),_e.push(()=>He(e,"show",s)),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),l=!0},p(r,[i]){const a={};i&35&&(a.$$scope={dirty:i,ctx:r}),!t&&i&1&&(t=!0,a.show=r[0],Me(()=>t=!1)),e.$set(a)},i(r){l||(N(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){se(e,r)}}}function Mc(n,e,t){let l;const s=bt("i18n");me(n,s,a=>t(1,l=a));let{show:o=!1}=e;const r=()=>{t(0,o=!1)};function i(a){o=a,t(0,o)}return n.$$set=a=>{"show"in a&&t(0,o=a.show)},[o,l,s,r,i]}class Hc extends Je{constructor(e){super(),Ge(this,e,Mc,Vc,xe,{show:0})}}function Bc(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=ze(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"stroke-linecap","round"),u(t,"stroke-linejoin","round"),u(t,"d","M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width",n[1]),u(e,"stroke","currentColor"),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&2&&u(e,"stroke-width",l[1]),s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function Lc(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="2"}=e;return n.$$set=o=>{"className"in o&&t(0,l=o.className),"strokeWidth"in o&&t(1,s=o.strokeWidth)},[l,s]}class Nc extends Je{constructor(e){super(),Ge(this,e,Lc,Bc,xe,{className:0,strokeWidth:1})}}function zc(n){let e,t;return{c(){e=Ne("svg"),t=Ne("path"),this.h()},l(l){e=ze(l,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,class:!0});var s=w(e);t=ze(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z"),u(t,"clip-rule","evenodd"),u(e,"aria-hidden","true"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","currentColor"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width",n[1]),u(e,"class",n[0])},m(l,s){z(l,e,s),g(e,t)},p(l,[s]){s&2&&u(e,"stroke-width",l[1]),s&1&&u(e,"class",l[0])},i:De,o:De,d(l){l&&h(e)}}}function Oc(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="2"}=e;return n.$$set=o=>{"className"in o&&t(0,l=o.className),"strokeWidth"in o&&t(1,s=o.strokeWidth)},[l,s]}class Uc extends Je{constructor(e){super(),Ge(this,e,Oc,zc,xe,{className:0,strokeWidth:1})}}function Ac(n){let e;const t=n[5].default,l=Ht(t,n,n[9],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&512)&&Bt(l,t,s,s[9],e?Nt(t,s[9],o,null):Lt(s[9]),null)},i(s){e||(N(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function Pc(n){let e,t,l,s=n[2].t("Documentation")+"",o,r;return e=new Nc({props:{className:"size-5"}}),{c(){ee(e.$$.fragment),t=Z(),l=v("div"),o=ge(s),this.h()},l(i){te(e.$$.fragment,i),t=q(i),l=b(i,"DIV",{class:!0});var a=w(l);o=pe(a,s),a.forEach(h),this.h()},h(){u(l,"class","flex items-center")},m(i,a){le(e,i,a),z(i,t,a),z(i,l,a),g(l,o),r=!0},p(i,a){(!r||a&4)&&s!==(s=i[2].t("Documentation")+"")&&ye(o,s)},i(i){r||(N(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){i&&(h(t),h(l)),se(e,i)}}}function jc(n){let e,t,l,s=n[2].t("Keyboard shortcuts")+"",o,r;return e=new Uc({props:{className:"size-5"}}),{c(){ee(e.$$.fragment),t=Z(),l=v("div"),o=ge(s),this.h()},l(i){te(e.$$.fragment,i),t=q(i),l=b(i,"DIV",{class:!0});var a=w(l);o=pe(a,s),a.forEach(h),this.h()},h(){u(l,"class","flex items-center")},m(i,a){le(e,i,a),z(i,t,a),z(i,l,a),g(l,o),r=!0},p(i,a){(!r||a&4)&&s!==(s=i[2].t("Keyboard shortcuts")+"")&&ye(o,s)},i(i){r||(N(e.$$.fragment,i),r=!0)},o(i){O(e.$$.fragment,i),r=!1},d(i){i&&(h(t),h(l)),se(e,i)}}}function Rc(n){let e,t,l,s;return e=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[Pc]},$$scope:{ctx:n}}}),e.$on("click",n[6]),l=new ul({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[jc]},$$scope:{ctx:n}}}),l.$on("click",n[7]),{c(){ee(e.$$.fragment),t=Z(),ee(l.$$.fragment)},l(o){te(e.$$.fragment,o),t=q(o),te(l.$$.fragment,o)},m(o,r){le(e,o,r),z(o,t,r),le(l,o,r),s=!0},p(o,r){const i={};r&516&&(i.$$scope={dirty:r,ctx:o}),e.$set(i);const a={};r&516&&(a.$$scope={dirty:r,ctx:o}),l.$set(a)},i(o){s||(N(e.$$.fragment,o),N(l.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),O(l.$$.fragment,o),s=!1},d(o){o&&h(t),se(e,o),se(l,o)}}}function Fc(n){let e,t,l;return t=new $l({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:4,side:"top",align:"end",transition:Al,$$slots:{default:[Rc]},$$scope:{ctx:n}}}),{c(){e=v("div"),ee(t.$$.fragment),this.h()},l(s){e=b(s,"DIV",{slot:!0});var o=w(e);te(t.$$.fragment,o),o.forEach(h),this.h()},h(){u(e,"slot","content")},m(s,o){z(s,e,o),le(t,e,null),l=!0},p(s,o){const r={};o&517&&(r.$$scope={dirty:o,ctx:s}),t.$set(r)},i(s){l||(N(t.$$.fragment,s),l=!0)},o(s){O(t.$$.fragment,s),l=!1},d(s){s&&h(e),se(t)}}}function Wc(n){let e,t;return e=new Xl({props:{$$slots:{content:[Fc],default:[Ac]},$$scope:{ctx:n}}}),e.$on("change",n[8]),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,[s]){const o={};s&517&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Zc(n,e,t){let l,{$$slots:s={},$$scope:o}=e;const r=bt("i18n");me(n,r,p=>t(2,l=p));let{showDocsHandler:i}=e,{showShortcutsHandler:a}=e,{onClose:c=()=>{}}=e;const f=()=>{window.open("https://docs.openwebui.com","_blank")},d=()=>{a()},m=p=>{p.detail===!1&&c()};return n.$$set=p=>{"showDocsHandler"in p&&t(4,i=p.showDocsHandler),"showShortcutsHandler"in p&&t(0,a=p.showShortcutsHandler),"onClose"in p&&t(1,c=p.onClose),"$$scope"in p&&t(9,o=p.$$scope)},[a,c,l,r,i,s,f,d,m,o]}class qc extends Je{constructor(e){super(),Ge(this,e,Zc,Wc,xe,{showDocsHandler:4,showShortcutsHandler:0,onClose:1})}}function xc(n){let e,t="?";return{c(){e=v("button"),e.textContent=t,this.h()},l(l){e=b(l,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-oq3opr"&&(e.textContent=t),this.h()},h(){u(e,"class","text-gray-600 dark:text-gray-300 bg-gray-300/20 size-5 flex items-center justify-center text-[0.7rem] rounded-full")},m(l,s){z(l,e,s)},p:De,d(l){l&&h(e)}}}function Jc(n){let e,t;return e=new qt({props:{content:n[1].t("Help"),placement:"left",$$slots:{default:[xc]},$$scope:{ctx:n}}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,s){le(e,l,s),t=!0},p(l,s){const o={};s&2&&(o.content=l[1].t("Help")),s&128&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){se(e,l)}}}function Gc(n){let e,t,l,s,o,r,i,a,c,f;s=new qc({props:{showDocsHandler:n[4],showShortcutsHandler:n[5],$$slots:{default:[Jc]},$$scope:{ctx:n}}});function d(p){n[6](p)}let m={};return n[0]!==void 0&&(m.show=n[0]),r=new Hc({props:m}),_e.push(()=>He(r,"show",d)),{c(){e=v("div"),t=v("button"),l=Z(),ee(s.$$.fragment),o=Z(),ee(r.$$.fragment),this.h()},l(p){e=b(p,"DIV",{class:!0});var k=w(e);t=b(k,"BUTTON",{id:!0,class:!0}),w(t).forEach(h),l=q(k),te(s.$$.fragment,k),k.forEach(h),o=q(p),te(r.$$.fragment,p),this.h()},h(){u(t,"id","show-shortcuts-button"),u(t,"class","hidden"),u(e,"class","hidden lg:flex fixed bottom-0 right-0 px-2 py-2 z-20")},m(p,k){z(p,e,k),g(e,t),g(e,l),le(s,e,null),z(p,o,k),le(r,p,k),a=!0,c||(f=ce(t,"click",n[3]),c=!0)},p(p,[k]){const D={};k&1&&(D.showDocsHandler=p[4]),k&1&&(D.showShortcutsHandler=p[5]),k&130&&(D.$$scope={dirty:k,ctx:p}),s.$set(D);const _={};!i&&k&1&&(i=!0,_.show=p[0],Me(()=>i=!1)),r.$set(_)},i(p){a||(N(s.$$.fragment,p),N(r.$$.fragment,p),a=!0)},o(p){O(s.$$.fragment,p),O(r.$$.fragment,p),a=!1},d(p){p&&(h(e),h(o)),se(s),se(r,p),c=!1,f()}}}function Qc(n,e,t){let l;const s=bt("i18n");me(n,s,f=>t(1,l=f));let o=!1;const r=()=>{t(0,o=!o)},i=()=>{t(0,o=!o)},a=()=>{t(0,o=!o)};function c(f){o=f,t(0,o)}return[o,l,s,r,i,a,c]}class Uf extends Je{constructor(e){super(),Ge(this,e,Qc,Gc,xe,{})}}export{Of as C,Uf as H};
//# sourceMappingURL=Help.9FwSwDTf.js.map
